<html><head></head><body><div hidden="" by-polymer-bundler=""><dom-module id="hass-error-screen" assetpath="../../src/layouts/"><template><style include="iron-flex ha-style">.placeholder{height:100%;}.layout{height:calc(100% - 64px);}paper-button{font-weight:bold;color:var(--primary-color);}</style><div class="placeholder"><app-toolbar><div main-title="">[[title]]</div></app-toolbar><div class="layout vertical center-center"><h3>[[error]]</h3><paper-button on-click="backTapped">go back</paper-button></div></div></template></dom-module><script>class HassErrorScreen extends Polymer.Element{static get is(){return"hass-error-screen"}static get properties(){return{title:{type:String,value:"Home Assistant"},error:{type:String,value:"Oops! It looks like something went wrong."}}}backTapped(){history.back()}}customElements.define(HassErrorScreen.is,HassErrorScreen);</script><dom-module id="ha-config-section"><template><style include="iron-flex ha-style">.content{padding:28px 20px 0;max-width:1040px;margin:0 auto;}.header{@apply --paper-font-display1;opacity:var(--dark-primary-opacity);}.together{margin-top:32px;}.intro{@apply --paper-font-subhead;width:100%;max-width:400px;margin-right:40px;opacity:var(--dark-primary-opacity);}.panel{margin-top:-24px;}.panel ::slotted(*){margin-top:24px;display:block;}.narrow.content{max-width:640px;}.narrow .together{margin-top:20px;}.narrow .header{@apply --paper-font-headline;}.narrow .intro{font-size:14px;padding-bottom:20px;margin-right:0;max-width:500px;}</style><div class$="[[computeContentClasses(isWide)]]"><div class="header"><slot name="header"></slot></div><div class$="[[computeClasses(isWide)]]"><div class="intro"><slot name="introduction"></slot></div><div class="flex panel"><slot></slot></div></div></div></template></dom-module><script>class HaConfigSection extends Polymer.Element{static get is(){return"ha-config-section"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},isWide:{type:Boolean,value:!1}}}computeContentClasses(e){return e?"content ":"content narrow"}computeClasses(e){return"together layout "+(e?"horizontal":"vertical narrow")}}customElements.define(HaConfigSection.is,HaConfigSection);</script><dom-module id="ha-config-navigation" assetpath="dashboard/"><template><style include="iron-flex">paper-card{display:block;}paper-item{cursor:pointer;}</style><paper-card><template is="dom-repeat" items="[[pages]]"><template is="dom-if" if="[[_computeLoaded(hass, item)]]"><paper-item on-click="_navigate"><paper-item-body two-line="">[[_computeCaption(item, localize)]]<div secondary="">[[_computeDescription(item, localize)]]</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></template></template></paper-card></template></dom-module><script>{const e=["core","customize"];class i extends(window.hassMixins.LocalizeMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-config-navigation"}static get properties(){return{hass:{type:Object},pages:{type:Array,value:["core","customize","automation","script","zwave"]}}}_computeLoaded(i,t){return e.includes(t)||window.hassUtil.isComponentLoaded(i,t)}_computeCaption(e,i){return i(`ui.panel.config.${e}.caption`)}_computeDescription(e,i){return i(`ui.panel.config.${e}.description`)}_navigate(e){history.pushState(null,null,"/config/"+e.model.item),this.fire("location-changed")}}customElements.define(i.is,i)}</script><dom-module id="ha-config-cloud-menu" assetpath="dashboard/"><template><style include="iron-flex">paper-card{display:block;}paper-item{cursor:pointer;}</style><paper-card><paper-item on-click="_navigate"><paper-item-body two-line="">Home Assistant Cloud<template is="dom-if" if="[[account]]"><div secondary="">Logged in as [[account.email]]</div></template><template is="dom-if" if="[[!account]]"><div secondary="">Not logged in</div></template></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></paper-card></template></dom-module><script>class HaConfigCloudMenu extends(window.hassMixins.NavigateMixin(Polymer.Element)){static get is(){return"ha-config-cloud-menu"}static get properties(){return{hass:Object,isWide:Boolean,account:Object}}_navigate(){this.navigate("/config/cloud")}}customElements.define(HaConfigCloudMenu.is,HaConfigCloudMenu);</script><dom-module id="ha-config-entries-menu" assetpath="dashboard/"><template><style include="iron-flex">paper-card{display:block;}paper-item{cursor:pointer;}</style><paper-card><paper-item on-click="_navigate"><paper-item-body two-line="">Integrations<div secondary="">EXPERIMENTAL â€“ Manage connected devices and services</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></paper-card></template></dom-module><script>class HaConfigEntriesMenu extends(window.hassMixins.NavigateMixin(Polymer.Element)){static get is(){return"ha-config-entries-menu"}static get properties(){return{hass:Object,isWide:Boolean,account:Object}}_navigate(){this.navigate("/config/integrations")}}customElements.define(HaConfigEntriesMenu.is,HaConfigEntriesMenu);</script><dom-module id="ha-config-dashboard" assetpath="dashboard/"><template><style include="iron-flex ha-style">.content{padding-bottom:32px;}</style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><ha-menu-button narrow="[[narrow]]" show-menu="[[showMenu]]"></ha-menu-button><div main-title="">[[localize('panel.configuration')]]</div></app-toolbar></app-header><div class="content"><ha-config-section is-wide="[[isWide]]"><span slot="header">[[localize('ui.panel.config.header')]]</span> <span slot="introduction">[[localize('ui.panel.config.introduction')]]</span><template is="dom-if" if="[[computeIsLoaded(hass, &quot;cloud&quot;)]]"><ha-config-cloud-menu hass="[[hass]]" account="[[account]]"></ha-config-cloud-menu></template><template is="dom-if" if="[[computeIsLoaded(hass, &quot;config.config_entries&quot;)]]"><ha-config-entries-menu hass="[[hass]]"></ha-config-entries-menu></template><ha-config-navigation hass="[[hass]]"></ha-config-navigation></ha-config-section></div></app-header-layout></template></dom-module><script>class HaConfigDashboard extends(window.hassMixins.LocalizeMixin(Polymer.Element)){static get is(){return"ha-config-dashboard"}static get properties(){return{hass:Object,isWide:Boolean,account:Object,narrow:Boolean,showMenu:Boolean}}computeIsLoaded(e,o){return window.hassUtil.isComponentLoaded(e,o)}}customElements.define(HaConfigDashboard.is,HaConfigDashboard);</script><dom-module id="ha-config-section-core" assetpath="core/"><template><style include="iron-flex ha-style">.validate-container{@apply --layout-vertical;@apply --layout-center-center;height:140px;}.validate-result{color:var(--google-green-500);font-weight:500;margin-bottom:1em;}.config-invalid{margin:1em 0;}.config-invalid .text{color:var(--google-red-500);font-weight:500;}.config-invalid paper-button{float:right;}.validate-log{white-space:pre-wrap;}</style><ha-config-section is-wide="[[isWide]]"><span slot="header">[[localize('ui.panel.config.core.section.core.header')]]</span> <span slot="introduction">[[localize('ui.panel.config.core.section.core.introduction')]]</span><paper-card heading="[[localize('ui.panel.config.core.section.core.validation.heading')]]"><div class="card-content">[[localize('ui.panel.config.core.section.core.validation.introduction')]]<template is="dom-if" if="[[!validateLog]]"><div class="validate-container"><template is="dom-if" if="[[!validating]]"><template is="dom-if" if="[[isValid]]"><div class="validate-result" id="result">[[localize('ui.panel.config.core.section.core.validation.valid')]]</div></template><paper-button raised="" on-click="validateConfig">[[localize('ui.panel.config.core.section.core.validation.check_config')]]</paper-button></template><template is="dom-if" if="[[validating]]"><paper-spinner active=""></paper-spinner></template></div></template><template is="dom-if" if="[[validateLog]]"><div class="config-invalid"><span class="text">[[localize('ui.panel.config.core.section.core.validation.invalid')]]</span><paper-button raised="" on-click="validateConfig">[[localize('ui.panel.config.core.section.core.validation.check_config')]]</paper-button></div><div id="configLog" class="validate-log">[[validateLog]]</div></template></div></paper-card><paper-card heading="[[localize('ui.panel.config.core.section.core.reloading.heading')]]"><div class="card-content">[[localize('ui.panel.config.core.section.core.reloading.introduction')]]</div><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="homeassistant" service="reload_core_config">[[localize('ui.panel.config.core.section.core.reloading.core')]]</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="group" service="reload" hidden$="[[!groupLoaded(hass)]]">[[localize('ui.panel.config.core.section.core.reloading.group')]]</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="automation" service="reload" hidden$="[[!automationLoaded(hass)]]">[[localize('ui.panel.config.core.section.core.reloading.automation')]]</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="script" service="reload" hidden$="[[!scriptLoaded(hass)]]">[[localize('ui.panel.config.core.section.core.reloading.script')]]</ha-call-service-button></div></paper-card><paper-card heading="[[localize('ui.panel.config.core.section.core.server_management.heading')]]"><div class="card-content">[[localize('ui.panel.config.core.section.core.server_management.introduction')]]</div><div class="card-actions warning"><ha-call-service-button class="warning" hass="[[hass]]" domain="homeassistant" service="restart">[[localize('ui.panel.config.core.section.core.server_management.restart')]]</ha-call-service-button><ha-call-service-button class="warning" hass="[[hass]]" domain="homeassistant" service="stop">[[localize('ui.panel.config.core.section.core.server_management.stop')]]</ha-call-service-button></div></paper-card></ha-config-section></template></dom-module><script>class HaConfigSectionCore extends(window.hassMixins.LocalizeMixin(Polymer.Element)){static get is(){return"ha-config-section-core"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean,value:!1},validating:{type:Boolean,value:!1},isValid:{type:Boolean,value:null},validateLog:{type:String,value:""}}}groupLoaded(i){return window.hassUtil.isComponentLoaded(i,"group")}automationLoaded(i){return window.hassUtil.isComponentLoaded(i,"automation")}scriptLoaded(i){return window.hassUtil.isComponentLoaded(i,"script")}validateConfig(){this.validating=!0,this.validateLog="",this.isValid=null,this.hass.callApi("POST","config/core/check_config").then(i=>{this.validating=!1,this.isValid="valid"===i.result,this.isValid||(this.validateLog=i.errors)})}}customElements.define(HaConfigSectionCore.is,HaConfigSectionCore);</script><dom-module id="ha-config-section-hassbian" assetpath="core/"><template><style include="iron-flex ha-style">.header{font-size:16px;margin-bottom:1em;}.header .status{font-size:14px;float:right;}.card-actions paper-button{color:var(--default-primary-color);font-weight:500;}</style><ha-config-section is-wide="[[isWide]]"><span slot="header">[[localize('ui.panel.config.core.section.hassbian.header')]]</span> <span slot="introduction">[[localize('ui.panel.config.core.section.hassbian.introduction')]]</span><template is="dom-if" if="[[suiteStatus]]"><template is="dom-repeat" items="[[computeSuiteKeys(suiteStatus)]]" as="suiteKey"><paper-card><div class="card-content"><div class="header">[[computeTitle(suiteKey)]] <span class="status">[[computeSuiteStatus(suiteStatus, suiteKey)]]</span></div>[[computeSuiteDescription(suiteStatus, suiteKey)]]</div><div class="card-actions"><paper-button on-click="suiteMoreInfoTapped">[[localize('ui.panel.config.core.section.hassbian.learn_more')]]</paper-button><template is="dom-if" if="[[computeShowInstall(suiteStatus, suiteKey)]]"><paper-button on-click="suiteActionTapped">[[localize('ui.panel.config.core.section.hassbian.install')]]</paper-button></template></div></paper-card></template></template></ha-config-section></template></dom-module><script>class HaConfigSectionHassbian extends(window.hassMixins.LocalizeMixin(Polymer.Element)){static get is(){return"ha-config-section-hassbian"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean},suiteStatus:{type:Object,value:null}}}updateStatus(){this.hass.callApi("GET","config/hassbian/suites").then(function(t){this.suiteStatus=t;for(var e=!1,s=Object.keys(t),i=0;i<s.length;i++)if("installing"===t[s[i]].state){e=!0;break}e&&setTimeout(()=>this.updateStatus(),5e3)}.bind(this))}connectedCallback(){super.connectedCallback(),this.updateStatus=this.updateStatus.bind(this),this.updateStatus()}computeSuiteKeys(t){return Object.keys(t).sort(function(e,s){var i="installing"===t[e].state,a="installing"===t[s].state;if(i&&a);else{if(i)return-1;if(a)return 1}return e<s?-1:e>s?1:0})}computeSuiteDescription(t,e){return t[e].description}computeTitle(t){return t.substr(0,1).toUpperCase()+t.substr(1)}computeSuiteStatus(t,e){var s=t[e].state.replace(/_/," ");return s.substr(0,1).toUpperCase()+s.substr(1)}computeShowStatus(t,e){var s=t[e].state;return"installing"!==s&&"not_installed"!==s}computeShowInstall(t,e){return"not_installed"===t[e].state}suiteMoreInfoTapped(){}suiteActionTapped(){this.hass.callApi("POST","config/hassbian/suites/openzwave/install").then(this.updateStatus)}}customElements.define(HaConfigSectionHassbian.is,HaConfigSectionHassbian);</script><dom-module id="iron-label" assetpath="../../bower_components/iron-label/"><script>Polymer.IronLabel=Polymer({is:"iron-label",listeners:{tap:"_tapHandler"},properties:{for:{type:String,value:"",reflectToAttribute:!0,observer:"_forChanged"},_forElement:Object},attached:function(){this._forChanged()},ready:function(){this._generateLabelId()},_generateLabelId:function(){if(!this.id){var e="iron-label-"+Polymer.IronLabel._labelNumber++;Polymer.dom(this).setAttribute("id",e)}},_findTarget:function(){if(this.for){var e=Polymer.dom(this).getOwnerRoot();return Polymer.dom(e).querySelector("#"+this.for)}var t=Polymer.dom(this).querySelector("[iron-label-target]");return t||(t=Polymer.dom(this).firstElementChild),t},_tapHandler:function(e){if(this._forElement){Polymer.dom(e).localTarget!==this._forElement&&(this._forElement.focus(),this._forElement.click())}},_applyLabelledBy:function(){this._forElement&&Polymer.dom(this._forElement).setAttribute("aria-labelledby",this.id)},_forChanged:function(){this._forElement&&Polymer.dom(this._forElement).removeAttribute("aria-labelledby"),this._forElement=this._findTarget(),this._applyLabelledBy()}}),Polymer.IronLabel._labelNumber=0;</script></dom-module><dom-module id="ha-push-notifications-toggle" assetpath="../../src/components/"><template><paper-toggle-button hidden$="[[!pushSupported]]" disabled="[[loading]]" checked="{{pushChecked}}"></paper-toggle-button></template></dom-module><script>class HaPushNotificationsToggle extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-push-notifications-toggle"}static get properties(){return{hass:{type:Object,value:null},pushSupported:{type:Boolean,readOnly:!0,notify:!0,value:"serviceWorker"in navigator&&"PushManager"in window&&("https:"===document.location.protocol||"localhost"===document.location.hostname||"127.0.0.1"===document.location.hostname)},pushChecked:{type:Boolean,value:"Notification"in window&&"granted"===Notification.permission,observer:"handlePushChange"},loading:{type:Boolean,value:!0}}}connectedCallback(){super.connectedCallback(),this.pushSupported&&navigator.serviceWorker.ready.then(e=>{e.pushManager.getSubscription().then(e=>{this.loading=!1,this.pushChecked=!!e})},()=>{this._setPushSupported(!1)})}handlePushChange(e){this.pushSupported&&(e?this.subscribePushNotifications():this.unsubscribePushNotifications())}subscribePushNotifications(){navigator.serviceWorker.ready.then(e=>e.pushManager.subscribe({userVisibleOnly:!0})).then(e=>{let i;return i=navigator.userAgent.toLowerCase().indexOf("firefox")>-1?"firefox":"chrome",this.hass.callApi("POST","notify.html5",{subscription:e,browser:i})},e=>{let i;i=e.message&&-1!==e.message.indexOf("gcm_sender_id")?"Please setup the notify.html5 platform.":"Notification registration failed.",console.error(e),this.fire("hass-notification",{message:i}),this.pushChecked=!1})}unsubscribePushNotifications(){navigator.serviceWorker.ready.then(e=>e.pushManager.getSubscription()).then(e=>e?this.hass.callApi("DELETE","notify.html5",{subscription:e}).then(()=>{e.unsubscribe()}):Promise.resolve()).catch(e=>{console.error("Error in unsub push",e),this.fire("hass-notification",{message:"Failed unsubscribing for push notifications."})})}}customElements.define(HaPushNotificationsToggle.is,HaPushNotificationsToggle);</script><dom-module id="ha-config-section-push-notifications" assetpath="core/"><template><style include="iron-flex iron-flex-alignment iron-positioning">ha-push-notifications-toggle{margin-left:16px;}</style><ha-config-section is-wide="[[isWide]]"><span slot="header">[[localize('ui.panel.config.core.section.push_notifications.header')]]</span> <span slot="introduction">[[localize('ui.panel.config.core.section.push_notifications.introduction')]]</span><paper-card><div class="card-content"><iron-label class="horizontal layout">[[localize('ui.panel.config.core.section.push_notifications.push_notifications')]]<ha-push-notifications-toggle hass="[[hass]]" push-supported="{{pushSupported}}"></ha-push-notifications-toggle></iron-label></div></paper-card></ha-config-section></template></dom-module><script>class HaConfigSectionPushNotifications extends(window.hassMixins.LocalizeMixin(Polymer.Element)){static get is(){return"ha-config-section-push-notifications"}static get properties(){return{hass:Object,isWide:Boolean,pushSupported:{type:Boolean,notify:!0}}}}customElements.define(HaConfigSectionPushNotifications.is,HaConfigSectionPushNotifications);</script><dom-module id="ha-config-section-translation" assetpath="core/"><template><ha-config-section is-wide="[[isWide]]"><span slot="header">[[localize('ui.panel.config.core.section.translation.header')]]</span> <span slot="introduction">[[localize('ui.panel.config.core.section.translation.introduction')]]</span><paper-card><div class="card-content"><paper-dropdown-menu label="[[localize('ui.panel.config.core.section.translation.language')]]" dynamic-align=""><paper-listbox slot="dropdown-content" on-selected-item-changed="handleLanguageSelect" attr-for-selected="language-tag" selected="[[language]]"><template is="dom-repeat" items="[[languages]]"><paper-item language-tag="[[item.tag]]">[[item.nativeName]]</paper-item></template></paper-listbox>&gt;</paper-dropdown-menu></div></paper-card></ha-config-section></template></dom-module><script>class HaConfigSectionTranslation extends(window.hassMixins.LocalizeMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-config-section-translation"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean},languages:{type:Array,computed:"computeLanguages(hass)"}}}computeLanguages(a){return a&&a.translationMetadata?Object.keys(a.translationMetadata.translations).map(e=>({tag:e,nativeName:a.translationMetadata.translations[e].nativeName})):[]}handleLanguageSelect(a){a.detail.value&&a.detail.value.languageTag!==this.language&&this.fire("hass-language-select",{language:a.detail.value.languageTag})}}customElements.define(HaConfigSectionTranslation.is,HaConfigSectionTranslation);</script><dom-module id="ha-config-section-themes" assetpath="core/"><template><ha-config-section is-wide="[[isWide]]"><span slot="header">[[localize('ui.panel.config.core.section.themes.header')]]</span> <span slot="introduction">[[localize('ui.panel.config.core.section.themes.introduction')]]</span><paper-card><div class="card-content"><paper-dropdown-menu label="[[localize('ui.panel.config.core.section.themes.header')]]" dynamic-align=""><paper-listbox slot="dropdown-content" selected="{{selectedTheme}}"><template is="dom-repeat" items="[[themes]]" as="theme"><paper-item>[[theme]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></paper-card></ha-config-section></template></dom-module><script>class HaConfigSectionThemes extends(window.hassMixins.LocalizeMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-config-section-themes"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean},themes:{type:Array,computed:"computeThemes(hass)"},selectedTheme:{type:Number}}}static get observers(){return["selectionChanged(hass, selectedTheme)"]}ready(){super.ready(),this.hass.selectedTheme&&this.themes.indexOf(this.hass.selectedTheme)>0?this.selectedTheme=this.themes.indexOf(this.hass.selectedTheme):this.hass.selectedTheme||(this.selectedTheme=0)}computeThemes(e){return e?["Backend-selected","default"].concat(Object.keys(e.themes.themes).sort()):[]}selectionChanged(e,s){s>0&&s<this.themes.length?e.selectedTheme!==this.themes[s]&&this.fire("settheme",this.themes[s]):0===s&&""!==e.selectedTheme&&this.fire("settheme","")}}customElements.define(HaConfigSectionThemes.is,HaConfigSectionThemes);</script><dom-module id="ha-config-core" assetpath="core/"><template><style include="iron-flex ha-style">.content{padding-bottom:32px;}.border{margin:32px auto 0;border-bottom:1px solid rgba(0, 0, 0, 0.12);max-width:1040px;}.narrow .border{max-width:640px;}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="_backTapped"></paper-icon-button><div main-title="">[[localize('ui.panel.config.core.caption')]]</div></app-toolbar></app-header><div class$="[[computeClasses(isWide)]]"><ha-config-section-core is-wide="[[isWide]]" hass="[[hass]]"></ha-config-section-core><template is="dom-if" if="[[pushSupported]]"><div class="border"></div><ha-config-section-push-notifications is-wide="[[isWide]]" hass="[[hass]]" push-supported="{{pushSupported}}"></ha-config-section-push-notifications></template><template is="dom-if" if="[[computeIsTranslationLoaded(hass)]]"><div class="border"></div><ha-config-section-translation is-wide="[[isWide]]" hass="[[hass]]"></ha-config-section-translation></template><template is="dom-if" if="[[computeIsThemesLoaded(hass)]]"><div class="border"></div><ha-config-section-themes is-wide="[[isWide]]" hass="[[hass]]"></ha-config-section-themes></template><template is="dom-if" if="[[computeIsHassbianLoaded(hass)]]"><div class="border"></div><ha-config-section-hassbian is-wide="[[isWide]]" hass="[[hass]]"></ha-config-section-hassbian></template></div></ha-app-layout></template></dom-module><script>class HaConfigCore extends(window.hassMixins.LocalizeMixin(Polymer.Element)){static get is(){return"ha-config-core"}static get properties(){return{hass:Object,isWide:Boolean,pushSupported:{type:Boolean,value:!0}}}computeClasses(e){return e?"content":"content narrow"}computeIsHassbianLoaded(e){return window.hassUtil.isComponentLoaded(e,"config.hassbian")}computeIsZwaveLoaded(e){return window.hassUtil.isComponentLoaded(e,"config.zwave")}computeIsTranslationLoaded(e){return e.translationMetadata&&Object.keys(e.translationMetadata.translations).length}computeIsThemesLoaded(e){return e.themes&&e.themes.themes&&Object.keys(e.themes.themes).length}_backTapped(){history.back()}}customElements.define(HaConfigCore.is,HaConfigCore);</script><dom-module id="hass-subpage" assetpath="../../src/layouts/"><template><style include="ha-style"></style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="_backTapped"></paper-icon-button><div main-title="">[[title]]</div></app-toolbar></app-header><slot></slot></app-header-layout></template></dom-module><script>class HassSubpage extends Polymer.Element{static get is(){return"hass-subpage"}static get properties(){return{title:String}}_backTapped(){history.back()}}customElements.define(HassSubpage.is,HassSubpage);</script><dom-module id="ha-config-cloud-login" assetpath="cloud/"><template><style include="iron-flex ha-style">.content{padding-bottom:24px;}[slot=introduction] a{color:var(--primary-color);}paper-card{display:block;}paper-item{cursor:pointer;}paper-card:last-child{margin-top:24px;}h1{@apply --paper-font-headline;margin:0;}.error{color:var(--google-red-500);}.card-actions{display:flex;justify-content:space-between;align-items:center;}[hidden]{display:none;}.flash-msg{padding-right:44px;}.flash-msg paper-icon-button{position:absolute;top:8px;right:8px;color:var(--secondary-text-color);}</style><hass-subpage title="Cloud Login"><div class="content"><ha-config-section is-wide="[[isWide]]"><span slot="header">Home Assistant Cloud</span> <span slot="introduction">The Home Assistant Cloud allows your local Home Assistant instance to connect with cloud-only services like Amazon Alexa.<p><a href="https://home-assistant.io/components/cloud/" target="_blank">Learn more</a></p></span><paper-card hidden$="[[!flashMessage]]"><div class="card-content flash-msg">[[flashMessage]]<paper-icon-button icon="mdi:close" on-click="_dismissFlash">Dismiss</paper-icon-button><paper-ripple id="flashRipple" noink=""></paper-ripple></div></paper-card><paper-card><div class="card-content"><h1>Sign In</h1><div class="error" hidden$="[[!_error]]">[[_error]]</div><paper-input label="Email" id="email" type="email" value="{{email}}" on-keydown="_keyDown" error-message="Invalid email"></paper-input><paper-input id="password" label="Password" value="{{_password}}" type="password" on-keydown="_keyDown" error-message="Passwords are at least 8 characters"></paper-input></div><div class="card-actions"><ha-progress-button on-click="_handleLogin" progress="[[_requestInProgress]]">Sign in</ha-progress-button><button class="link" hidden="[[_requestInProgress]]" on-click="_handleForgotPassword">forgot password?</button></div></paper-card><paper-card><paper-item on-click="_handleRegister"><paper-item-body two-line="">Create Account<div secondary="">Get up and running quickly.</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></paper-card></ha-config-section></div></hass-subpage></template></dom-module><script>class HaConfigCloudLogin extends(window.hassMixins.NavigateMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-config-cloud-login"}static get properties(){return{hass:Object,isWide:Boolean,email:{type:String,notify:!0},_password:{type:String,value:""},_requestInProgress:{type:Boolean,value:!1},flashMessage:{type:String,notify:!0},_error:String}}static get observers(){return["_inputChanged(email, _password)"]}connectedCallback(){super.connectedCallback(),this.flashMessage&&requestAnimationFrame(()=>requestAnimationFrame(()=>this.$.flashRipple.simulatedRipple()))}_inputChanged(){this.$.email.invalid=!1,this.$.password.invalid=!1,this._error=!1}_keyDown(e){13===e.keyCode&&(this._handleLogin(),e.preventDefault())}_handleLogin(){let e=!1;this.email&&this.email.includes("@")||(this.$.email.invalid=!0,this.$.email.focus(),e=!0),this._password.length<8&&(this.$.password.invalid=!0,e||(e=!0,this.$.password.focus())),e||(this._requestInProgress=!0,this.hass.callApi("post","cloud/login",{email:this.email,password:this._password}).then(e=>{this.fire("ha-account-refreshed",{account:e}),this.setProperties({email:"",_password:""})},e=>{this._password="";const s=e&&e.body&&e.body.code;if("PasswordChangeRequired"===s)return alert("You need to change your password before logging in."),void this.navigate("/config/cloud/forgot-password");const i={_requestInProgress:!1,_error:e&&e.body&&e.body.message?e.body.message:"Unknown error"};"UserNotConfirmed"===s&&(i._error="You need to confirm your email before logging in."),this.setProperties(i),this.$.email.focus()}))}_handleRegister(){this.flashMessage="",this.navigate("/config/cloud/register")}_handleForgotPassword(){this.flashMessage="",this.navigate("/config/cloud/forgot-password")}_dismissFlash(){setTimeout(()=>{this.flashMessage=""},200)}}customElements.define(HaConfigCloudLogin.is,HaConfigCloudLogin);</script><dom-module id="ha-config-cloud-register" assetpath="cloud/"><template><style include="iron-flex ha-style">a{color:var(--primary-color);}paper-card{display:block;}paper-item{cursor:pointer;}paper-card:last-child{margin-top:24px;}h1{@apply --paper-font-headline;margin:0;}.error{color:var(--google-red-500);}.card-actions{display:flex;justify-content:space-between;align-items:center;}[hidden]{display:none;}</style><hass-subpage title="Register Account"><div class="content"><ha-config-section is-wide="[[isWide]]"><span slot="header">Register with the Home Assistant Cloud</span> <span slot="introduction">Register today to easily connect with the Home Assistant Cloud. This will allow you to unlock great new services and functionality, like Amazon Alexa integration.<p>By registering an account you agree to the following terms and conditions.</p><ul><li><a href="https://home-assistant.io/tos/" target="_blank">Terms and Conditions</a></li><li><a href="https://home-assistant.io/privacy/" target="_blank">Privacy Policy</a></li></ul><p></p></span><paper-card><div class="card-content"><div class="header"><h1>Register</h1><div class="error" hidden$="[[!_error]]">[[_error]]</div></div><paper-input autofocus="" id="email" label="Email address" type="email" value="{{email}}" on-keydown="_keyDown" error-message="Invalid email"></paper-input><paper-input id="password" label="Password" value="{{_password}}" type="password" on-keydown="_keyDown" error-message="Your password needs to be at least 8 characters"></paper-input></div><div class="card-actions"><ha-progress-button on-click="_handleRegister" progress="[[_requestInProgress]]">Create Account</ha-progress-button><button class="link" hidden="[[_requestInProgress]]" on-click="_handleResendVerifyEmail">Resend confirmation email</button></div></paper-card></ha-config-section></div></hass-subpage></template></dom-module><script>class HaConfigCloudRegister extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-config-cloud-register"}static get properties(){return{hass:Object,isWide:Boolean,email:{type:String,notify:!0},_requestInProgress:{type:Boolean,value:!1},_password:{type:String,value:""},_error:{type:String,value:""}}}static get observers(){return["_inputChanged(email, _password)"]}_inputChanged(){this._error="",this.$.email.invalid=!1,this.$.password.invalid=!1}_keyDown(e){13===e.keyCode&&(this._handleRegister(),e.preventDefault())}_handleRegister(){let e=!1;this.email&&this.email.includes("@")||(this.$.email.invalid=!0,this.$.email.focus(),e=!0),this._password.length<8&&(this.$.password.invalid=!0,e||(e=!0,this.$.password.focus())),e||(this._requestInProgress=!0,this.hass.callApi("post","cloud/register",{email:this.email,password:this._password}).then(()=>this._verificationEmailSent(),e=>{this._password="",this.setProperties({_requestInProgress:!1,_error:e&&e.body&&e.body.message?e.body.message:"Unknown error"})}))}_handleResendVerifyEmail(){this.email?this.hass.callApi("post","cloud/resend_confirm",{email:this.email}).then(()=>this._verificationEmailSent(),e=>this.setProperties({_error:e&&e.body&&e.body.message?e.body.message:"Unknown error"})):this.$.email.invalid=!0}_verificationEmailSent(){this.setProperties({_requestInProgress:!1,_password:""}),this.fire("cloud-done",{flashMessage:"Account created! Check your email for instructions on how to activate your account."})}}customElements.define(HaConfigCloudRegister.is,HaConfigCloudRegister);</script><dom-module id="ha-config-cloud-forgot-password" assetpath="cloud/"><template><style include="iron-flex ha-style">.content{padding-bottom:24px;}paper-card{display:block;max-width:600px;margin:0 auto;margin-top:24px;}h1{@apply --paper-font-headline;margin:0;}.error{color:var(--google-red-500);}.card-actions{display:flex;justify-content:space-between;align-items:center;}.card-actions a{color:var(--primary-text-color);}[hidden]{display:none;}</style><hass-subpage title="Forgot Password"><div class="content"><paper-card><div class="card-content"><h1>Forgot your password?</h1><p>Enter your email address and we will send you a link to reset your password.</p><div class="error" hidden$="[[!_error]]">[[_error]]</div><paper-input autofocus="" id="email" label="E-mail" value="{{email}}" type="email" on-keydown="_keyDown" error-message="Invalid email"></paper-input></div><div class="card-actions"><ha-progress-button on-click="_handleEmailPasswordReset" progress="[[_requestInProgress]]">Send reset email</ha-progress-button></div></paper-card></div></hass-subpage></template></dom-module><script>class HaConfigCloudForgotPassword extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-config-cloud-forgot-password"}static get properties(){return{hass:Object,email:{type:String,notify:!0,observer:"_emailChanged"},_requestInProgress:{type:Boolean,value:!1},_error:{type:String,value:""}}}_emailChanged(){this._error="",this.$.email.invalid=!1}_keyDown(e){13===e.keyCode&&(this._handleEmailPasswordReset(),e.preventDefault())}_handleEmailPasswordReset(){this.email&&this.email.includes("@")||(this.$.email.invalid=!0),this.$.email.invalid||(this._requestInProgress=!0,this.hass.callApi("post","cloud/forgot_password",{email:this.email}).then(()=>{this._requestInProgress=!1,this.fire("cloud-done",{flashMessage:"Check your email for instructions on how to reset your password."})},e=>this.setProperties({_requestInProgress:!1,_error:e&&e.body&&e.body.message?e.body.message:"Unknown error"})))}}customElements.define(HaConfigCloudForgotPassword.is,HaConfigCloudForgotPassword);</script><dom-module id="ha-config-cloud-account" assetpath="cloud/"><template><style include="iron-flex ha-style">.content{padding-bottom:24px;}paper-card{display:block;}.account-row{display:flex;padding:0 16px;}paper-button{align-self:center;}.soon{font-style:italic;margin-top:24px;text-align:center;}.nowrap{white-space:nowrap;}.wrap{white-space:normal;}.status{text-transform:capitalize;padding:16px;}paper-button{color:var(--primary-color);font-weight:500;}</style><hass-subpage title="Cloud Account"><div class="content"><ha-config-section is-wide="[[isWide]]"><span slot="header">Home Assistant Cloud</span> <span slot="introduction">Thank you for supporting Home Assistant. It's because of people like you that we are able to run this project and make a great home automation experience for everyone. Thank you!</span><paper-card heading="Account"><div class="account-row"><paper-item-body two-line="">[[account.email]]<div secondary="" class="wrap"><span class="nowrap">Subscription expires on </span><span class="nowrap">[[_formatExpiration(account.sub_exp)]]</span></div></paper-item-body><paper-button on-click="handleLogout">Sign out</paper-button></div><div class="account-row"><paper-item-body>Cloud connection status</paper-item-body><div class="status">[[account.cloud]]</div></div></paper-card></ha-config-section><ha-config-section is-wide="[[isWide]]"><span slot="header">Integrations</span> <span slot="introduction">Integrations for Home Assistant Cloud allow you to connect with services in the cloud without having to expose your Home Assistant instance publicy on the internet.</span><paper-card heading="Alexa"><div class="card-content">With the Alexa integration for Home Assistant Cloud you'll be able to control all your Home Assistant devices via any Alexa-enabled device.<p><em>This integration requires an Alexa-enabled device like the Amazon Echo.</em></p></div><div class="card-actions"><a href="https://alexa.amazon.com/spa/index.html#skills/dp/B0772J1QKB/?ref=skill_dsk_skb_sr_2" target="_blank"><paper-button>Home Assistant Alexa skill</paper-button></a><a href="https://home-assistant.io/components/cloud.alexa/" target="_blank"><paper-button>Documentation</paper-button></a></div></paper-card></ha-config-section></div></hass-subpage></template></dom-module><script>class HaConfigCloudAccount extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-config-cloud-account"}static get properties(){return{hass:Object,account:{type:Object,observer:"_accountChanged"}}}handleLogout(){this.hass.callApi("post","cloud/logout").then(()=>this.fire("ha-account-refreshed",{account:null}))}_formatExpiration(t){return window.hassUtil.formatDateTime(new Date(t))}_accountChanged(t){t&&"connecting"===t.cloud?this._accountUpdater||setTimeout(()=>{this._accountUpdater=null,this.hass.callApi("get","cloud/account").then(t=>this.fire("ha-account-refreshed",{account:t}))},5e3):this._accountUpdater&&(clearTimeout(this._accountUpdater),this._accountUpdater=null)}}customElements.define(HaConfigCloudAccount.is,HaConfigCloudAccount);</script><dom-module id="ha-config-cloud" assetpath="cloud/"><template><app-route route="[[route]]" pattern="/cloud/:page" data="{{_routeData}}" tail="{{_routeTail}}"></app-route><template is="dom-if" if="[[_equals(_routeData.page, &quot;account&quot;)]]" restamp=""><ha-config-cloud-account hass="[[hass]]" account="[[account]]" is-wide="[[isWide]]"></ha-config-cloud-account></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;login&quot;)]]" restamp=""><ha-config-cloud-login page-name="login" hass="[[hass]]" is-wide="[[isWide]]" email="{{_loginEmail}}" flash-message="{{_flashMessage}}"></ha-config-cloud-login></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;register&quot;)]]" restamp=""><ha-config-cloud-register page-name="register" hass="[[hass]]" is-wide="[[isWide]]" email="{{_loginEmail}}"></ha-config-cloud-register></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;forgot-password&quot;)]]" restamp=""><ha-config-cloud-forgot-password page-name="forgot-password" hass="[[hass]]" is-wide="[[isWide]]" email="{{_loginEmail}}"></ha-config-cloud-forgot-password></template></template></dom-module><script>{const e=["/cloud/account"],t=["/cloud/login","/cloud/register","/cloud/forgot-password"];class o extends(window.hassMixins.NavigateMixin(Polymer.Element)){static get is(){return"ha-config-cloud"}static get properties(){return{hass:Object,isWide:Boolean,loadingAccount:{type:Boolean,value:!1},account:{type:Object},_flashMessage:{type:String,value:""},route:Object,_routeData:Object,_routeTail:Object,_loginEmail:String}}static get observers(){return["_checkRoute(route, account)"]}ready(){super.ready(),this.addEventListener("cloud-done",e=>{this._flashMessage=e.detail.flashMessage,this.navigate("/config/cloud/login")})}_checkRoute(o){o&&"/cloud"===o.path.substr(0,6)&&(this._debouncer=Polymer.Debouncer.debounce(this._debouncer,Polymer.Async.timeOut.after(0),()=>{this.account||t.includes(o.path)?this.account&&!e.includes(o.path)&&this.navigate("/config/cloud/account",!0):this.navigate("/config/cloud/login",!0)}))}_equals(e,t){return e===t}}customElements.define(o.is,o)}</script><dom-module id="paper-fab" assetpath="../../bower_components/paper-fab/"><template strip-whitespace=""><style include="paper-material-styles">:host{@apply --layout-vertical;@apply --layout-center-center;background:var(--paper-fab-background, var(--accent-color));border-radius:50%;box-sizing:border-box;color:var(--text-primary-color);cursor:pointer;height:56px;min-width:0;outline:none;padding:16px;position:relative;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;user-select:none;width:56px;z-index:0;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;@apply --paper-fab;}[hidden]{display:none !important;}:host([mini]){width:40px;height:40px;padding:8px;@apply --paper-fab-mini;}:host([disabled]){color:var(--paper-fab-disabled-text, var(--paper-grey-500));background:var(--paper-fab-disabled-background, var(--paper-grey-300));@apply --paper-fab-disabled;}iron-icon{@apply --paper-fab-iron-icon;}span{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;@apply --paper-fab-label;}:host(.keyboard-focus){background:var(--paper-fab-keyboard-focus-background, var(--paper-pink-900));}:host([elevation="1"]){@apply --paper-material-elevation-1;}:host([elevation="2"]){@apply --paper-material-elevation-2;}:host([elevation="3"]){@apply --paper-material-elevation-3;}:host([elevation="4"]){@apply --paper-material-elevation-4;}:host([elevation="5"]){@apply --paper-material-elevation-5;}</style><iron-icon id="icon" hidden$="{{!_computeIsIconFab(icon, src)}}" src="[[src]]" icon="[[icon]]"></iron-icon><span hidden$="{{_computeIsIconFab(icon, src)}}">{{label}}</span></template><script>Polymer({is:"paper-fab",behaviors:[Polymer.PaperButtonBehavior],properties:{src:{type:String,value:""},icon:{type:String,value:""},mini:{type:Boolean,value:!1,reflectToAttribute:!0},label:{type:String,observer:"_labelChanged"}},_labelChanged:function(){this.setAttribute("aria-label",this.label)},_computeIsIconFab:function(e,t){return e.length>0||t.length>0}});</script></dom-module><dom-module id="ha-automation-picker" assetpath="automation/"><template><style include="ha-style">:host{display:block;}paper-item{cursor:pointer;}paper-fab{position:fixed;bottom:16px;right:16px;z-index:1;}paper-fab[is-wide]{bottom:24px;right:24px;}a{color:var(--primary-color);}ha-markdown p{margin:0px;}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="_backTapped"></paper-icon-button><div main-title="">[[localize('ui.panel.config.automation.caption')]]</div></app-toolbar></app-header><ha-config-section is-wide="[[isWide]]"><div slot="header">[[localize('ui.panel.config.automation.picker.header')]]</div><div slot="introduction"><ha-markdown content="[[localize('ui.panel.config.automation.picker.introduction')]]"></ha-markdown></div><paper-card heading="[[localize('ui.panel.config.automation.picker.pick_automation')]]"><template is="dom-if" if="[[!automations.length]]"><div class="card-content"><p>[[localize('ui.panel.config.automation.picker.no_automations')]]</p></div></template><template is="dom-repeat" items="[[automations]]" as="automation"><paper-item><paper-item-body two-line="" on-click="automationTapped"><div>[[computeName(automation)]]</div><div secondary="">[[computeDescription(automation)]]</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></template></paper-card></ha-config-section><paper-fab slot="fab" is-wide$="[[isWide]]" icon="mdi:plus" title="[[localize('ui.panel.config.automation.picker.add_automation')]]" on-click="addAutomation"></paper-fab></ha-app-layout></template></dom-module><script>class HaAutomationPicker extends(window.hassMixins.LocalizeMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-automation-picker"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},automations:{type:Array},isWide:{type:Boolean}}}automationTapped(t){history.pushState(null,null,"/config/automation/edit/"+this.automations[t.model.index].attributes.id),this.fire("location-changed")}addAutomation(){history.pushState(null,null,"/config/automation/new"),this.fire("location-changed")}computeName(t){return window.hassUtil.computeStateName(t)}computeDescription(t){return""}_backTapped(){history.back()}}customElements.define(HaAutomationPicker.is,HaAutomationPicker);</script><dom-module id="paper-radio-button" assetpath="../../bower_components/paper-radio-button/"><template strip-whitespace=""><style>:host{display:inline-block;line-height:0;white-space:nowrap;cursor:pointer;@apply --paper-font-common-base;--calculated-paper-radio-button-size:var(--paper-radio-button-size, 16px);--calculated-paper-radio-button-ink-size:var(--paper-radio-button-ink-size, -1px);}:host(:focus){outline:none;}#radioContainer{@apply --layout-inline;@apply --layout-center-center;position:relative;width:var(--calculated-paper-radio-button-size);height:var(--calculated-paper-radio-button-size);vertical-align:middle;@apply --paper-radio-button-radio-container;}#ink{position:absolute;top:50%;left:50%;right:auto;width:var(--calculated-paper-radio-button-ink-size);height:var(--calculated-paper-radio-button-ink-size);color:var(--paper-radio-button-unchecked-ink-color, var(--primary-text-color));opacity:0.6;pointer-events:none;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);}#ink[checked]{color:var(--paper-radio-button-checked-ink-color, var(--primary-color));}#offRadio, #onRadio{position:absolute;box-sizing:border-box;top:0;left:0;width:100%;height:100%;border-radius:50%;}#offRadio{border:2px solid var(--paper-radio-button-unchecked-color, var(--primary-text-color));background-color:var(--paper-radio-button-unchecked-background-color, transparent);transition:border-color 0.28s;}#onRadio{background-color:var(--paper-radio-button-checked-color, var(--primary-color));-webkit-transform:scale(0);transform:scale(0);transition:-webkit-transform ease 0.28s;transition:transform ease 0.28s;will-change:transform;}:host([checked]) #offRadio{border-color:var(--paper-radio-button-checked-color, var(--primary-color));}:host([checked]) #onRadio{-webkit-transform:scale(0.5);transform:scale(0.5);}#radioLabel{line-height:normal;position:relative;display:inline-block;vertical-align:middle;margin-left:var(--paper-radio-button-label-spacing, 10px);white-space:normal;color:var(--paper-radio-button-label-color, var(--primary-text-color));@apply --paper-radio-button-label;}:host([checked]) #radioLabel{@apply --paper-radio-button-label-checked;}:host-context([dir="rtl"]) #radioLabel{margin-left:0;margin-right:var(--paper-radio-button-label-spacing, 10px);}#radioLabel[hidden]{display:none;}:host([disabled]) #offRadio{border-color:var(--paper-radio-button-unchecked-color, var(--primary-text-color));opacity:0.5;}:host([disabled][checked]) #onRadio{background-color:var(--paper-radio-button-unchecked-color, var(--primary-text-color));opacity:0.5;}:host([disabled]) #radioLabel{opacity:0.65;}</style><div id="radioContainer"><div id="offRadio"></div><div id="onRadio"></div></div><div id="radioLabel"><slot></slot></div></template><script>Polymer({is:"paper-radio-button",behaviors:[Polymer.PaperCheckedElementBehavior],hostAttributes:{role:"radio","aria-checked":!1,tabindex:0},properties:{ariaActiveAttribute:{type:String,value:"aria-checked"}},ready:function(){this._rippleContainer=this.$.radioContainer},attached:function(){Polymer.RenderStatus.afterNextRender(this,function(){if("-1px"===this.getComputedStyleValue("--calculated-paper-radio-button-ink-size").trim()){var e=parseFloat(this.getComputedStyleValue("--calculated-paper-radio-button-size").trim()),t=Math.floor(3*e);t%2!=e%2&&t++,this.updateStyles({"--paper-radio-button-ink-size":t+"px"})}})}});</script></dom-module><dom-module id="paper-radio-group" assetpath="../../bower_components/paper-radio-group/"><template><style>:host{display:inline-block;}:host ::slotted(*){padding:var(--paper-radio-group-item-padding, 12px);}</style><slot></slot></template></dom-module><script>Polymer({is:"paper-radio-group",behaviors:[Polymer.IronMenubarBehavior],hostAttributes:{role:"radiogroup"},properties:{attrForSelected:{type:String,value:"name"},selectedAttribute:{type:String,value:"checked"},selectable:{type:String,value:"paper-radio-button"},allowEmptySelection:{type:Boolean,value:!1}},select:function(e){var t=this._valueToItem(e);if(!t||!t.hasAttribute("disabled")){if(this.selected){var i=this._valueToItem(this.selected);if(this.selected==e){if(!this.allowEmptySelection)return void(i&&(i.checked=!0));e=""}i&&(i.checked=!1)}Polymer.IronSelectableBehavior.select.apply(this,[e]),this.fire("paper-radio-group-changed")}},_activateFocusedItem:function(){this._itemActivate(this._valueForItem(this.focusedItem),this.focusedItem)},_onUpKey:function(e){this._focusPrevious(),e.preventDefault(),this._activateFocusedItem()},_onDownKey:function(e){this._focusNext(),e.preventDefault(),this._activateFocusedItem()},_onLeftKey:function(e){Polymer.IronMenubarBehaviorImpl._onLeftKey.apply(this,arguments),this._activateFocusedItem()},_onRightKey:function(e){Polymer.IronMenubarBehaviorImpl._onRightKey.apply(this,arguments),this._activateFocusedItem()}});</script><dom-module id="paper-dropdown-menu-light" assetpath="../../bower_components/paper-dropdown-menu/"><template><style include="paper-dropdown-menu-shared-styles">:host(:focus){outline:none;}:host{width:200px;}[slot="dropdown-trigger"]{box-sizing:border-box;position:relative;width:100%;padding:16px 0 8px 0;}:host([disabled]) [slot="dropdown-trigger"]{pointer-events:none;opacity:var(--paper-dropdown-menu-disabled-opacity, 0.33);}:host([no-label-float]) [slot="dropdown-trigger"]{padding-top:8px;}#input{@apply --paper-font-subhead;@apply --paper-font-common-nowrap;line-height:1.5;border-bottom:1px solid var(--paper-dropdown-menu-color, var(--secondary-text-color));color:var(--paper-dropdown-menu-color, var(--primary-text-color));width:100%;box-sizing:border-box;padding:12px 20px 0 0;outline:none;@apply --paper-dropdown-menu-input;}#input:dir(rtl){padding-right:0px;padding-left:20px;}:host([disabled]) #input{border-bottom:1px dashed var(--paper-dropdown-menu-color, var(--secondary-text-color));}:host([invalid]) #input{border-bottom:2px solid var(--paper-dropdown-error-color, var(--error-color));}:host([no-label-float]) #input{padding-top:0;}label{@apply --paper-font-subhead;@apply --paper-font-common-nowrap;display:block;position:absolute;bottom:0;left:0;right:0;top:28px;box-sizing:border-box;width:100%;padding-right:20px;text-align:left;transition-duration:.2s;transition-timing-function:cubic-bezier(.4,0,.2,1);color:var(--paper-dropdown-menu-color, var(--secondary-text-color));@apply --paper-dropdown-menu-label;}label:dir(rtl){padding-right:0px;padding-left:20px;}:host([no-label-float]) label{top:8px;transition-duration:0s;}label.label-is-floating{font-size:12px;top:8px;}label.label-is-hidden{visibility:hidden;}:host([focused]) label.label-is-floating{color:var(--paper-dropdown-menu-focus-color, var(--primary-color));}:host([invalid]) label.label-is-floating{color:var(--paper-dropdown-error-color, var(--error-color));}label:after{background-color:var(--paper-dropdown-menu-focus-color, var(--primary-color));bottom:7px;content:'';height:2px;left:45%;position:absolute;transition-duration:.2s;transition-timing-function:cubic-bezier(.4,0,.2,1);visibility:hidden;width:8px;z-index:10;}:host([invalid]) label:after{background-color:var(--paper-dropdown-error-color, var(--error-color));}:host([no-label-float]) label:after{bottom:7px;}:host([focused]:not([disabled])) label:after{left:0;visibility:visible;width:100%;}iron-icon{position:absolute;right:0px;bottom:8px;@apply --paper-font-subhead;color:var(--disabled-text-color);@apply --paper-dropdown-menu-icon;}iron-icon:dir(rtl){left:0;right:auto;}:host([no-label-float]) iron-icon{margin-top:0px;}.error{display:inline-block;visibility:hidden;color:var(--paper-dropdown-error-color, var(--error-color));@apply --paper-font-caption;position:absolute;left:0;right:0;bottom:-12px;}:host([invalid]) .error{visibility:visible;}</style><span role="button"></span><paper-menu-button id="menuButton" vertical-align="[[verticalAlign]]" horizontal-align="[[horizontalAlign]]" vertical-offset="[[_computeMenuVerticalOffset(noLabelFloat)]]" disabled="[[disabled]]" no-animations="[[noAnimations]]" on-iron-select="_onIronSelect" on-iron-deselect="_onIronDeselect" opened="{{opened}}" close-on-activate="" allow-outside-scroll="[[allowOutsideScroll]]"><div class="dropdown-trigger" slot="dropdown-trigger"><label class$="[[_computeLabelClass(noLabelFloat,alwaysFloatLabel,hasContent)]]">[[label]]</label><div id="input" tabindex="-1">&nbsp;</div><iron-icon icon="paper-dropdown-menu:arrow-drop-down"></iron-icon><span class="error">[[errorMessage]]</span></div><slot id="content" name="dropdown-content" slot="dropdown-content"></slot></paper-menu-button></template><script>!function(){"use strict";Polymer({is:"paper-dropdown-menu-light",behaviors:[Polymer.IronButtonState,Polymer.IronControlState,Polymer.PaperRippleBehavior,Polymer.IronFormElementBehavior,Polymer.IronValidatableBehavior],properties:{selectedItemLabel:{type:String,notify:!0,readOnly:!0},selectedItem:{type:Object,notify:!0,readOnly:!0},value:{type:String,notify:!0,readOnly:!0,observer:"_valueChanged"},label:{type:String},placeholder:{type:String},opened:{type:Boolean,notify:!0,value:!1,observer:"_openedChanged"},allowOutsideScroll:{type:Boolean,value:!1},noLabelFloat:{type:Boolean,value:!1,reflectToAttribute:!0},alwaysFloatLabel:{type:Boolean,value:!1},noAnimations:{type:Boolean,value:!1},horizontalAlign:{type:String,value:"right"},verticalAlign:{type:String,value:"top"},hasContent:{type:Boolean,readOnly:!0}},listeners:{tap:"_onTap"},keyBindings:{"up down":"open",esc:"close"},hostAttributes:{tabindex:0,role:"combobox","aria-autocomplete":"none","aria-haspopup":"true"},observers:["_selectedItemChanged(selectedItem)"],attached:function(){var e=this.contentElement;e&&e.selectedItem&&this._setSelectedItem(e.selectedItem)},get contentElement(){for(var e=Polymer.dom(this.$.content).getDistributedNodes(),t=0,n=e.length;t<n;t++)if(e[t].nodeType===Node.ELEMENT_NODE)return e[t]},open:function(){this.$.menuButton.open()},close:function(){this.$.menuButton.close()},_onIronSelect:function(e){this._setSelectedItem(e.detail.item)},_onIronDeselect:function(e){this._setSelectedItem(null)},_onTap:function(e){Polymer.Gestures.findOriginalTarget(e)===this&&this.open()},_selectedItemChanged:function(e){var t="";t=e?e.label||e.getAttribute("label")||e.textContent.trim():"",this._setValue(t),this._setSelectedItemLabel(t)},_computeMenuVerticalOffset:function(e){return e?-4:8},_getValidity:function(e){return this.disabled||!this.required||this.required&&!!this.value},_openedChanged:function(){var e=this.opened?"true":"false",t=this.contentElement;t&&t.setAttribute("aria-expanded",e)},_computeLabelClass:function(e,t,n){var o="";return!0===e?n?"label-is-hidden":"":((n||!0===t)&&(o+=" label-is-floating"),o)},_valueChanged:function(){this.$.input&&this.$.input.textContent!==this.value&&(this.$.input.textContent=this.value),this._setHasContent(!!this.value)}})}();</script></dom-module><script>!function(){"use strict";function e(e,t){var n,i,o,a,r=T;for(a=arguments.length;a-- >2;)D.push(arguments[a]);for(t&&null!=t.children&&(D.length||D.push(t.children),delete t.children);D.length;)if((i=D.pop())&&void 0!==i.pop)for(a=i.length;a--;)D.push(i[a]);else"boolean"==typeof i&&(i=null),(o="function"!=typeof e)&&(null==i?i="":"number"==typeof i?i=String(i):"string"!=typeof i&&(o=!1)),o&&n?r[r.length-1]+=i:r===T?r=[i]:r.push(i),n=o;var s=new function(){};return s.nodeName=e,s.children=r,s.attributes=null==t?void 0:t,s.key=null==t?void 0:t.key,void 0!==S.vnode&&S.vnode(s),s}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(e){!e._dirty&&(e._dirty=!0)&&1==E.push(e)&&(S.debounceRendering||O)(i)}function i(){var e,t=E;for(E=[];e=t.pop();)e._dirty&&C(e)}function o(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&a(e,t.nodeName):n||e._componentConstructor===t.nodeName}function a(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function r(e){var n=t({},e.attributes);n.children=e.children;var i=e.nodeName.defaultProps;if(void 0!==i)for(var o in i)void 0===n[o]&&(n[o]=i[o]);return n}function s(e){var t=e.parentNode;t&&t.removeChild(e)}function l(e,t,n,i,o){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),i&&i(e);else if("class"!==t||o)if("style"===t){if(i&&"string"!=typeof i&&"string"!=typeof n||(e.style.cssText=i||""),i&&"object"==typeof i){if("string"!=typeof n)for(var a in n)a in i||(e.style[a]="");for(var a in i)e.style[a]="number"==typeof i[a]&&!1===G.test(a)?i[a]+"px":i[a]}}else if("dangerouslySetInnerHTML"===t)i&&(e.innerHTML=i.__html||"");else if("o"==t[0]&&"n"==t[1]){var r=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),i?n||e.addEventListener(t,d,r):e.removeEventListener(t,d,r),(e._listeners||(e._listeners={}))[t]=i}else if("list"!==t&&"type"!==t&&!o&&t in e)!function(e,t,n){try{e[t]=n}catch(e){}}(e,t,null==i?"":i),null!=i&&!1!==i||e.removeAttribute(t);else{var s=o&&t!==(t=t.replace(/^xlink\:?/,""));null==i||!1===i?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof i&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),i):e.setAttribute(t,i))}else e.className=i||""}function d(e){return this._listeners[e.type](S.event&&S.event(e)||e)}function p(){for(var e;e=U.pop();)S.afterMount&&S.afterMount(e),e.componentDidMount&&e.componentDidMount()}function c(e,t,n,i,o,a){q++||(L=null!=o&&void 0!==o.ownerSVGElement,W=null!=e&&!("__preactattr_"in e));var r=u(e,t,n,i,a);return o&&r.parentNode!==o&&o.appendChild(r),--q||(W=!1,a||p()),r}function u(e,t,n,i,d){var p=e,c=L;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||d)?e.nodeValue!=t&&(e.nodeValue=t):(p=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(p,e),h(e,!0))),p.__preactattr_=!0,p;var g=t.nodeName;if("function"==typeof g)return function(e,t,n,i){var o=e&&e._component,a=o,s=e,l=o&&e._componentConstructor===t.nodeName,d=l,p=r(t);for(;o&&!d&&(o=o._parentComponent);)d=o.constructor===t.nodeName;o&&d&&(!i||o._component)?(v(o,p,3,n,i),e=o.base):(a&&!l&&(b(a),e=s=null),o=f(t.nodeName,p,n),e&&!o.nextBase&&(o.nextBase=e,s=null),v(o,p,1,n,i),e=o.base,s&&e!==s&&(s._component=null,h(s,!1)));return e}(e,t,n,i);if(L="svg"===g||"foreignObject"!==g&&L,g=String(g),(!e||!a(e,g))&&(p=function(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}(g,L),e)){for(;e.firstChild;)p.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(p,e),h(e,!0)}var m=p.firstChild,C=p.__preactattr_,y=t.children;if(null==C){C=p.__preactattr_={};for(var _=p.attributes,x=_.length;x--;)C[_[x].name]=_[x].value}return!W&&y&&1===y.length&&"string"==typeof y[0]&&null!=m&&void 0!==m.splitText&&null==m.nextSibling?m.nodeValue!=y[0]&&(m.nodeValue=y[0]):(y&&y.length||null!=m)&&function(e,t,n,i,a){var r,l,d,p,c,g=e.childNodes,f=[],m={},v=0,C=0,b=g.length,y=0,_=t?t.length:0;if(0!==b)for(w=0;w<b;w++){var x=g[w],k=x.__preactattr_;null!=(z=_&&k?x._component?x._component.__key:k.key:null)?(v++,m[z]=x):(k||(void 0!==x.splitText?!a||x.nodeValue.trim():a))&&(f[y++]=x)}if(0!==_)for(w=0;w<_;w++){p=t[w],c=null;var z=p.key;if(null!=z)v&&void 0!==m[z]&&(c=m[z],m[z]=void 0,v--);else if(!c&&C<y)for(r=C;r<y;r++)if(void 0!==f[r]&&o(l=f[r],p,a)){c=l,f[r]=void 0,r===y-1&&y--,r===C&&C++;break}c=u(c,p,n,i),d=g[w],c&&c!==e&&c!==d&&(null==d?e.appendChild(c):c===d.nextSibling?s(d):e.insertBefore(c,d))}if(v)for(var w in m)void 0!==m[w]&&h(m[w],!1);for(;C<=y;)void 0!==(c=f[y--])&&h(c,!1)}(p,y,n,i,W||null!=C.dangerouslySetInnerHTML),function(e,t,n){var i;for(i in n)t&&null!=t[i]||null==n[i]||l(e,i,n[i],n[i]=void 0,L);for(i in t)"children"===i||"innerHTML"===i||i in n&&t[i]===("value"===i||"checked"===i?e[i]:n[i])||l(e,i,n[i],n[i]=t[i],L)}(p,t.attributes,C),L=c,p}function h(e,t){var n=e._component;n?b(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||s(e),g(e))}function g(e){for(e=e.lastChild;e;){var t=e.previousSibling;h(e,!0),e=t}}function f(e,t,n){var i,o=j[e.name];if(e.prototype&&e.prototype.render?(i=new e(t,n),y.call(i,t,n)):((i=new y(t,n)).constructor=e,i.render=m),o)for(var a=o.length;a--;)if(o[a].constructor===e){i.nextBase=o[a].nextBase,o.splice(a,1);break}return i}function m(e,t,n){return this.constructor(e,n)}function v(e,t,i,o,a){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||a?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o),o&&o!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==i&&(1!==i&&!1===S.syncComponentUpdates&&e.base?n(e):C(e,1,a)),e.__ref&&e.__ref(e))}function C(e,n,i,o){if(!e._disable){var a,s,l,d=e.props,u=e.state,g=e.context,m=e.prevProps||d,y=e.prevState||u,_=e.prevContext||g,x=e.base,k=e.nextBase,z=x||k,w=e._component,P=!1;if(x&&(e.props=m,e.state=y,e.context=_,2!==n&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(d,u,g)?P=!0:e.componentWillUpdate&&e.componentWillUpdate(d,u,g),e.props=d,e.state=u,e.context=g),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!P){a=e.render(d,u,g),e.getChildContext&&(g=t(t({},g),e.getChildContext()));var N,D,T=a&&a.nodeName;if("function"==typeof T){var O=r(a);(s=w)&&s.constructor===T&&O.key==s.__key?v(s,O,1,g,!1):(N=s,e._component=s=f(T,O,g),s.nextBase=s.nextBase||k,s._parentComponent=e,v(s,O,0,g,!1),C(s,1,i,!0)),D=s.base}else l=z,(N=w)&&(l=e._component=null),(z||1===n)&&(l&&(l._component=null),D=c(l,a,g,i||!x,z&&z.parentNode,!0));if(z&&D!==z&&s!==w){var G=z.parentNode;G&&D!==G&&(G.replaceChild(D,z),N||(z._component=null,h(z,!1)))}if(N&&b(N),e.base=D,D&&!o){for(var E=e,L=e;L=L._parentComponent;)(E=L).base=D;D._component=E,D._componentConstructor=E.constructor}}if(!x||i?U.unshift(e):P||(e.componentDidUpdate&&e.componentDidUpdate(m,y,_),S.afterUpdate&&S.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);q||o||p()}}function b(e){S.beforeUnmount&&S.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?b(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,s(t),function(e){var t=e.constructor.name;(j[t]||(j[t]=[])).push(e)}(e),g(t)),e.__ref&&e.__ref(null)}function y(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function _(e,t,n){return c(n,e,{},!1,t,!1)}function x(e,t){const n=this.props[e];if(t.target.value===n[t.target.name])return;const i=B({},n);t.target.value?i[t.target.name]=t.target.value:delete i[t.target.name],this.props.onChange(this.props.index,i)}function k(e){return"latitude"in e.attributes&&"longitude"in e.attributes}function z(e){return e._domain||(e._domain=function(e){return e.substr(0,e.indexOf("."))}(e.entity_id)),e._domain}function w(e){return k(e)&&"zone"!==z(e)}function P(e){return k(e)&&"zone"!==z(e)}function N(e){const t=Object.keys(ve);for(let n=0;n<t.length;n++)if(t[n]in e)return t[n];return null}var S={},D=[],T=[],O="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,G=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,E=[],U=[],q=0,L=!1,W=!1,j={};t(y.prototype,{setState:function(e,i){var o=this.state;this.prevState||(this.prevState=t({},o)),t(o,"function"==typeof e?e(o,this.props):e),i&&(this._renderCallbacks=this._renderCallbacks||[]).push(i),n(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),C(this,2)},render:function(){}});class A extends y{constructor(e){super(e),this.state.isValid=!0,this.state.value=JSON.stringify(e.value||{},null,2),this.onChange=this.onChange.bind(this)}onChange(e){const t=e.target.value;let n,i;try{n=JSON.parse(t),i=!0}catch(e){i=!1}this.setState({value:t,isValid:i}),i&&this.props.onChange(n)}componentWillReceiveProps({value:e}){e!==this.props.value&&this.setState({value:JSON.stringify(e,null,2),isValid:!0})}render({label:t},{value:n,isValid:i}){const o={minWidth:300,width:"100%"};return i||(o.border="1px solid red"),e("paper-textarea",{label:t,value:n,style:o,"onvalue-changed":this.onChange})}}!function(){function e(e){this.value=e}function t(t){function n(o,a){try{var r=t[o](a),s=r.value;s instanceof e?Promise.resolve(s.value).then(function(e){n("next",e)},function(e){n("throw",e)}):i(r.done?"return":"normal",r.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?n(o.key,o.arg):a=null}var o,a;this._invoke=function(e,t){return new Promise(function(i,r){var s={key:e,arg:t,resolve:i,reject:r,next:null};a?a=a.next=s:(o=a=s,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}();var B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};class M extends y{constructor(){super(),this.onChange=x.bind(this,"trigger"),this.eventDataChanged=this.eventDataChanged.bind(this)}eventDataChanged(e){this.props.onChange(this.props.index,B({},this.props.trigger,{event_data:e}))}render({trigger:t,localize:n}){const{event_type:i,event_data:o}=t;return e("div",null,e("paper-input",{label:n("ui.panel.config.automation.editor.triggers.type.event.event_type"),name:"event_type",value:i,"onvalue-changed":this.onChange}),e(A,{label:n("ui.panel.config.automation.editor.triggers.type.event.event_data"),value:o,onChange:this.eventDataChanged}))}}M.defaultConfig={event_type:"",event_data:{}};class V extends y{constructor(){super(),this.radioGroupPicked=this.radioGroupPicked.bind(this)}radioGroupPicked(e){this.props.onChange(this.props.index,B({},this.props.trigger,{event:e.target.selected}))}render({trigger:t,localize:n}){const{event:i}=t;return e("div",null,e("label",{id:"eventlabel"},n("ui.panel.config.automation.editor.triggers.type.homeassistant.event")),e("paper-radio-group",{selected:i,"aria-labelledby":"eventlabel","onpaper-radio-group-changed":this.radioGroupPicked},e("paper-radio-button",{name:"start"},n("ui.panel.config.automation.editor.triggers.type.homeassistant.start")),e("paper-radio-button",{name:"shutdown"},n("ui.panel.config.automation.editor.triggers.type.homeassistant.shutdown"))))}}V.defaultConfig={event:"start"};class J extends y{constructor(){super(),this.onChange=x.bind(this,"trigger")}render({trigger:t,localize:n}){const{topic:i,payload:o}=t;return e("div",null,e("paper-input",{label:n("ui.panel.config.automation.editor.triggers.type.mqtt.topic"),name:"topic",value:i,"onvalue-changed":this.onChange}),e("paper-input",{label:n("ui.panel.config.automation.editor.triggers.type.mqtt.payload"),name:"payload",value:o,"onvalue-changed":this.onChange}))}}J.defaultConfig={topic:""};class I extends y{constructor(){super(),this.onChange=x.bind(this,"trigger"),this.entityPicked=this.entityPicked.bind(this)}entityPicked(e){this.props.onChange(this.props.index,B({},this.props.trigger,{entity_id:e.target.value}))}render({trigger:t,hass:n,localize:i}){const{value_template:o,entity_id:a,below:r,above:s}=t;return e("div",null,e("ha-entity-picker",{value:a,onChange:this.entityPicked,hass:n,allowCustomEntity:!0}),e("paper-input",{label:i("ui.panel.config.automation.editor.triggers.type.numeric_state.above"),name:"above",value:s,"onvalue-changed":this.onChange}),e("paper-input",{label:i("ui.panel.config.automation.editor.triggers.type.numeric_state.below"),name:"below",value:r,"onvalue-changed":this.onChange}),e("paper-textarea",{label:i("ui.panel.config.automation.editor.triggers.type.numeric_state.value_template"),name:"value_template",value:o,"onvalue-changed":this.onChange}))}}I.defaultConfig={entity_id:""};class F extends y{constructor(){super(),this.onChange=x.bind(this,"trigger"),this.entityPicked=this.entityPicked.bind(this)}entityPicked(e){this.props.onChange(this.props.index,B({},this.props.trigger,{entity_id:e.target.value}))}render({trigger:t,hass:n,localize:i}){const{entity_id:o,to:a}=t,r=t.from,s=t.for;return e("div",null,e("ha-entity-picker",{value:o,onChange:this.entityPicked,hass:n,allowCustomEntity:!0}),e("paper-input",{label:i("ui.panel.config.automation.editor.triggers.type.state.from"),name:"from",value:r,"onvalue-changed":this.onChange}),e("paper-input",{label:i("ui.panel.config.automation.editor.triggers.type.state.to"),name:"to",value:a,"onvalue-changed":this.onChange}),s&&e("pre",null,"For: ",JSON.stringify(s,null,2)))}}F.defaultConfig={entity_id:""};class $ extends y{constructor(){super(),this.onChange=x.bind(this,"trigger"),this.radioGroupPicked=this.radioGroupPicked.bind(this)}radioGroupPicked(e){this.props.onChange(this.props.index,B({},this.props.trigger,{event:e.target.selected}))}render({trigger:t,localize:n}){const{offset:i,event:o}=t;return e("div",null,e("label",{id:"eventlabel"},n("ui.panel.config.automation.editor.triggers.type.sun.event")),e("paper-radio-group",{selected:o,"aria-labelledby":"eventlabel","onpaper-radio-group-changed":this.radioGroupPicked},e("paper-radio-button",{name:"sunrise"},n("ui.panel.config.automation.editor.triggers.type.sun.sunrise")),e("paper-radio-button",{name:"sunset"},n("ui.panel.config.automation.editor.triggers.type.sun.sunset"))),e("paper-input",{label:n("ui.panel.config.automation.editor.triggers.type.sun.offset"),name:"offset",value:i,"onvalue-changed":this.onChange}))}}$.defaultConfig={event:"sunrise"};class H extends y{constructor(){super(),this.onChange=x.bind(this,"trigger")}render({trigger:t,localize:n}){const{value_template:i}=t;return e("div",null,e("paper-textarea",{label:n("ui.panel.config.automation.editor.triggers.type.template.value_template"),name:"value_template",value:i,"onvalue-changed":this.onChange}))}}H.defaultConfig={value_template:""};class R extends y{constructor(){super(),this.onChange=x.bind(this,"trigger")}render({trigger:t,localize:n}){const{at:i}=t;return e("div",null,e("paper-input",{label:n("ui.panel.config.automation.editor.triggers.type.time.at"),name:"at",value:i,"onvalue-changed":this.onChange}))}}R.defaultConfig={at:""};class K extends y{constructor(){super(),this.onChange=x.bind(this,"trigger"),this.radioGroupPicked=this.radioGroupPicked.bind(this),this.entityPicked=this.entityPicked.bind(this),this.zonePicked=this.zonePicked.bind(this)}entityPicked(e){this.props.onChange(this.props.index,B({},this.props.trigger,{entity_id:e.target.value}))}zonePicked(e){this.props.onChange(this.props.index,B({},this.props.trigger,{zone:e.target.value}))}radioGroupPicked(e){this.props.onChange(this.props.index,B({},this.props.trigger,{event:e.target.selected}))}render({trigger:t,hass:n,localize:i}){const{entity_id:o,zone:a,event:r}=t;return e("div",null,e("ha-entity-picker",{label:i("ui.panel.config.automation.editor.triggers.type.zone.entity"),value:o,onChange:this.entityPicked,hass:n,allowCustomEntity:!0,entityFilter:w}),e("ha-entity-picker",{label:i("ui.panel.config.automation.editor.triggers.type.zone.zone"),value:a,onChange:this.zonePicked,hass:n,allowCustomEntity:!0,domainFilter:"zone"}),e("label",{id:"eventlabel"},i("ui.panel.config.automation.editor.triggers.type.zone.event")),e("paper-radio-group",{selected:r,"aria-labelledby":"eventlabel","onpaper-radio-group-changed":this.radioGroupPicked},e("paper-radio-button",{name:"enter"},i("ui.panel.config.automation.editor.triggers.type.zone.enter")),e("paper-radio-button",{name:"leave"},i("ui.panel.config.automation.editor.triggers.type.zone.leave"))))}}K.defaultConfig={entity_id:"",zone:"",event:"enter"};const Q={event:M,state:F,homeassistant:V,mqtt:J,numeric_state:I,sun:$,template:H,time:R,zone:K},X=Object.keys(Q).sort();class Y extends y{constructor(){super(),this.typeChanged=this.typeChanged.bind(this)}typeChanged(e){const t=e.target.selectedItem.attributes.platform.value;t!==this.props.trigger.platform&&this.props.onChange(this.props.index,B({platform:t},Q[t].defaultConfig))}render({index:t,trigger:n,onChange:i,hass:o,localize:a}){const r=Q[n.platform],s=X.indexOf(n.platform);return r?e("div",null,e("paper-dropdown-menu-light",{label:a("ui.panel.config.automation.editor.triggers.type_select"),"no-animations":!0},e("paper-listbox",{slot:"dropdown-content",selected:s,"oniron-select":this.typeChanged},X.map(t=>e("paper-item",{platform:t},a(`ui.panel.config.automation.editor.triggers.type.${t}.label`))))),e(r,{index:t,trigger:n,onChange:i,hass:o,localize:a})):e("div",null,a("ui.panel.config.automation.editor.triggers.unsupported_platform","platform",n.platform),e("pre",null,JSON.stringify(n,null,2)))}}class Z extends y{constructor(){super(),this.onDelete=this.onDelete.bind(this)}onDelete(){confirm(this.props.localize("ui.panel.config.automation.editor.triggers.delete_confirm"))&&this.props.onChange(this.props.index,null)}render(t){return e("paper-card",null,e("div",{class:"card-menu"},e("paper-menu-button",{"no-animations":!0,"horizontal-align":"right","horizontal-offset":"-5","vertical-offset":"-5"},e("paper-icon-button",{icon:"mdi:dots-vertical",slot:"dropdown-trigger"}),e("paper-listbox",{slot:"dropdown-content"},e("paper-item",{disabled:!0},t.localize("ui.panel.config.automation.editor.triggers.duplicate")),e("paper-item",{onTap:this.onDelete},t.localize("ui.panel.config.automation.editor.triggers.delete"))))),e("div",{class:"card-content"},e(Y,t)))}}class ee extends y{constructor(){super(),this.addTrigger=this.addTrigger.bind(this),this.triggerChanged=this.triggerChanged.bind(this)}addTrigger(){const e=this.props.trigger.concat(B({platform:"state"},F.defaultConfig));this.props.onChange(e)}triggerChanged(e,t){const n=this.props.trigger.concat();null===t?n.splice(e,1):n[e]=t,this.props.onChange(n)}render({trigger:t,hass:n,localize:i}){return e("div",{class:"triggers"},t.map((t,o)=>e(Z,{index:o,trigger:t,onChange:this.triggerChanged,hass:n,localize:i})),e("paper-card",null,e("div",{class:"card-actions add-card"},e("paper-button",{onTap:this.addTrigger},i("ui.panel.config.automation.editor.triggers.add")))))}}class te extends y{constructor(){super(),this.onChange=x.bind(this,"condition"),this.entityPicked=this.entityPicked.bind(this)}entityPicked(e){this.props.onChange(this.props.index,B({},this.props.condition,{entity_id:e.target.value}))}render({condition:t,hass:n,localize:i}){const{value_template:o,entity_id:a,below:r,above:s}=t;return e("div",null,e("ha-entity-picker",{value:a,onChange:this.entityPicked,hass:n,allowCustomEntity:!0}),e("paper-input",{label:i("ui.panel.config.automation.editor.conditions.type.numeric_state.above"),name:"above",value:s,"onvalue-changed":this.onChange}),e("paper-input",{label:i("ui.panel.config.automation.editor.conditions.type.numeric_state.below"),name:"below",value:r,"onvalue-changed":this.onChange}),e("paper-textarea",{label:i("ui.panel.config.automation.editor.conditions.type.numeric_state.value_template"),name:"value_template",value:o,"onvalue-changed":this.onChange}))}}te.defaultConfig={entity_id:""};class ne extends y{constructor(){super(),this.onChange=x.bind(this,"condition"),this.entityPicked=this.entityPicked.bind(this)}entityPicked(e){this.props.onChange(this.props.index,B({},this.props.condition,{entity_id:e.target.value}))}render({condition:t,hass:n,localize:i}){const{entity_id:o,state:a}=t,r=t.for;return e("div",null,e("ha-entity-picker",{value:o,onChange:this.entityPicked,hass:n,allowCustomEntity:!0}),e("paper-input",{label:i("ui.panel.config.automation.editor.conditions.type.state.state"),name:"state",value:a,"onvalue-changed":this.onChange}),r&&e("pre",null,"For: ",JSON.stringify(r,null,2)))}}ne.defaultConfig={entity_id:"",state:""};class ie extends y{constructor(){super(),this.onChange=x.bind(this,"condition"),this.afterPicked=this.radioGroupPicked.bind(this,"after"),this.beforePicked=this.radioGroupPicked.bind(this,"before")}radioGroupPicked(e,t){const n=B({},this.props.condition);t.target.selected?n[e]=t.target.selected:delete n[e],this.props.onChange(this.props.index,n)}render({condition:t,localize:n}){const{after:i,after_offset:o,before:a,before_offset:r}=t;return e("div",null,e("label",{id:"beforelabel"},n("ui.panel.config.automation.editor.conditions.type.sun.before")),e("paper-radio-group",{"allow-empty-selection":!0,selected:a,"aria-labelledby":"beforelabel","onpaper-radio-group-changed":this.beforePicked},e("paper-radio-button",{name:"sunrise"},n("ui.panel.config.automation.editor.conditions.type.sun.sunrise")),e("paper-radio-button",{name:"sunset"},n("ui.panel.config.automation.editor.conditions.type.sun.sunset"))),e("paper-input",{label:n("ui.panel.config.automation.editor.conditions.type.sun.before_offset"),name:"before_offset",value:r,"onvalue-changed":this.onChange,disabled:void 0===a}),e("label",{id:"afterlabel"},n("ui.panel.config.automation.editor.conditions.type.sun.after")),e("paper-radio-group",{"allow-empty-selection":!0,selected:i,"aria-labelledby":"afterlabel","onpaper-radio-group-changed":this.afterPicked},e("paper-radio-button",{name:"sunrise"},n("ui.panel.config.automation.editor.conditions.type.sun.sunrise")),e("paper-radio-button",{name:"sunset"},n("ui.panel.config.automation.editor.conditions.type.sun.sunset"))),e("paper-input",{label:n("ui.panel.config.automation.editor.conditions.type.sun.after_offset"),name:"after_offset",value:o,"onvalue-changed":this.onChange,disabled:void 0===i}))}}ie.defaultConfig={};class oe extends y{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:t,localize:n}){const{value_template:i}=t;return e("div",null,e("paper-textarea",{label:n("ui.panel.config.automation.editor.conditions.type.template.value_template"),name:"value_template",value:i,"onvalue-changed":this.onChange}))}}oe.defaultConfig={value_template:""};class ae extends y{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:t,localize:n}){const{after:i,before:o}=t;return e("div",null,e("paper-input",{label:n("ui.panel.config.automation.editor.conditions.type.time.after"),name:"after",value:i,"onvalue-changed":this.onChange}),e("paper-input",{label:n("ui.panel.config.automation.editor.conditions.type.time.before"),name:"before",value:o,"onvalue-changed":this.onChange}))}}ae.defaultConfig={};class re extends y{constructor(){super(),this.onChange=x.bind(this,"condition"),this.entityPicked=this.entityPicked.bind(this),this.zonePicked=this.zonePicked.bind(this)}entityPicked(e){this.props.onChange(this.props.index,B({},this.props.condition,{entity_id:e.target.value}))}zonePicked(e){this.props.onChange(this.props.index,B({},this.props.condition,{zone:e.target.value}))}render({condition:t,hass:n,localize:i}){const{entity_id:o,zone:a}=t;return e("div",null,e("ha-entity-picker",{label:i("ui.panel.config.automation.editor.conditions.type.zone.entity"),value:o,onChange:this.entityPicked,hass:n,allowCustomEntity:!0,entityFilter:P}),e("ha-entity-picker",{label:i("ui.panel.config.automation.editor.conditions.type.zone.zone"),value:a,onChange:this.zonePicked,hass:n,allowCustomEntity:!0,domainFilter:"zone"}))}}re.defaultConfig={entity_id:"",zone:""};const se={state:ne,numeric_state:te,sun:ie,template:oe,time:ae,zone:re},le=Object.keys(se).sort();class de extends y{constructor(){super(),this.typeChanged=this.typeChanged.bind(this)}typeChanged(e){const t=e.target.selectedItem.attributes.condition.value;t!==this.props.condition.condition&&this.props.onChange(this.props.index,B({condition:t},se[t].defaultConfig))}render({index:t,condition:n,onChange:i,hass:o,localize:a}){const r=se[n.condition],s=le.indexOf(n.condition);return r?e("div",null,e("paper-dropdown-menu-light",{label:a("ui.panel.config.automation.editor.conditions.type_select"),"no-animations":!0},e("paper-listbox",{slot:"dropdown-content",selected:s,"oniron-select":this.typeChanged},le.map(t=>e("paper-item",{condition:t},a(`ui.panel.config.automation.editor.conditions.type.${t}.label`))))),e(r,{index:t,condition:n,onChange:i,hass:o,localize:a})):e("div",null,a("ui.panel.config.automation.editor.conditions.unsupported_condition","condition",n.condition),e("pre",null,JSON.stringify(n,null,2)))}}class pe extends y{constructor(){super(),this.onDelete=this.onDelete.bind(this)}onDelete(){confirm(this.props.localize("ui.panel.config.automation.editor.conditions.delete_confirm"))&&this.props.onChange(this.props.index,null)}render(t){return e("paper-card",null,e("div",{class:"card-menu"},e("paper-menu-button",{"no-animations":!0,"horizontal-align":"right","horizontal-offset":"-5","vertical-offset":"-5"},e("paper-icon-button",{icon:"mdi:dots-vertical",slot:"dropdown-trigger"}),e("paper-listbox",{slot:"dropdown-content"},e("paper-item",{disabled:!0},t.localize("ui.panel.config.automation.editor.conditions.duplicate")),e("paper-item",{onTap:this.onDelete},t.localize("ui.panel.config.automation.editor.conditions.delete"))))),e("div",{class:"card-content"},e(de,t)))}}class ce extends y{constructor(){super(),this.addCondition=this.addCondition.bind(this),this.conditionChanged=this.conditionChanged.bind(this)}addCondition(){const e=this.props.condition.concat({condition:"state"});this.props.onChange(e)}conditionChanged(e,t){const n=this.props.condition.concat();null===t?n.splice(e,1):n[e]=t,this.props.onChange(n)}render({condition:t,hass:n,localize:i}){return e("div",{class:"triggers"},t.map((t,o)=>e(pe,{index:o,condition:t,onChange:this.conditionChanged,hass:n,localize:i})),e("paper-card",null,e("div",{class:"card-actions add-card"},e("paper-button",{onTap:this.addCondition},i("ui.panel.config.automation.editor.conditions.add")))))}}class ue extends y{constructor(){super(),this.serviceChanged=this.serviceChanged.bind(this),this.serviceDataChanged=this.serviceDataChanged.bind(this)}serviceChanged(e){this.props.onChange(this.props.index,B({},this.props.action,{service:e.target.value}))}serviceDataChanged(e){this.props.onChange(this.props.index,B({},this.props.action,{data:e}))}render({action:t,hass:n,localize:i}){const{service:o,data:a}=t;return e("div",null,e("ha-service-picker",{hass:n,value:o,onChange:this.serviceChanged}),e(A,{label:i("ui.panel.config.automation.editor.actions.type.service.service_data"),value:a,onChange:this.serviceDataChanged}))}}ue.defaultConfig={alias:"",service:"",data:{}};class he extends y{render({action:t,index:n,onChange:i,hass:o,localize:a}){return e(de,{condition:t,onChange:i,index:n,hass:o,localize:a})}}he.defaultConfig=B({condition:"state"},ne.defaultConfig);class ge extends y{constructor(){super(),this.onChange=x.bind(this,"action")}render({action:t,localize:n}){const{delay:i}=t;return e("div",null,e("paper-input",{label:n("ui.panel.config.automation.editor.actions.type.delay.delay"),name:"delay",value:i,"onvalue-changed":this.onChange}))}}ge.defaultConfig={delay:""};class fe extends y{constructor(){super(),this.onChange=x.bind(this,"action"),this.serviceDataChanged=this.serviceDataChanged.bind(this)}serviceDataChanged(e){this.props.onChange(this.props.index,B({},this.props.action,{data:e}))}render({action:t,localize:n}){const{event:i,event_data:o}=t;return e("div",null,e("paper-input",{label:n("ui.panel.config.automation.editor.actions.type.event.event"),name:"event",value:i,"onvalue-changed":this.onChange}),e(A,{label:n("ui.panel.config.automation.editor.actions.type.event.service_data"),value:o,onChange:this.serviceDataChanged}))}}fe.defaultConfig={event:"",event_data:{}};class me extends y{constructor(){super(),this.onChange=x.bind(this,"action"),this.onTemplateChange=this.onTemplateChange.bind(this)}onTemplateChange(e){this.props.onChange(this.props.index,B({},this.props.trigger,{[e.target.name]:e.target.value}))}render({action:t,localize:n}){const{wait_template:i,timeout:o}=t;return e("div",null,e("paper-textarea",{label:n("ui.panel.config.automation.editor.actions.type.wait_template.wait_template"),name:"wait_template",value:i,"onvalue-changed":this.onTemplateChange}),e("paper-input",{label:n("ui.panel.config.automation.editor.actions.type.wait_template.timeout"),name:"timeout",value:o,"onvalue-changed":this.onChange}))}}me.defaultConfig={wait_template:"",timeout:""};const ve={service:ue,delay:ge,wait_template:me,condition:he,event:fe},Ce=Object.keys(ve).sort();class be extends y{constructor(){super(),this.typeChanged=this.typeChanged.bind(this)}typeChanged(e){const t=e.target.selectedItem.attributes.action.value;N(this.props.action)!==t&&this.props.onChange(this.props.index,ve[t].defaultConfig)}render({index:t,action:n,onChange:i,hass:o,localize:a}){const r=N(n),s=r&&ve[r],l=Ce.indexOf(r);return s?e("div",null,e("paper-dropdown-menu-light",{label:a("ui.panel.config.automation.editor.actions.type_select"),"no-animations":!0},e("paper-listbox",{slot:"dropdown-content",selected:l,"oniron-select":this.typeChanged},Ce.map(t=>e("paper-item",{action:t},a(`ui.panel.config.automation.editor.actions.type.${t}.label`))))),e(s,{index:t,action:n,onChange:i,hass:o,localize:a})):e("div",null,a("ui.panel.config.automation.editor.actions.unsupported_action","action",r),e("pre",null,JSON.stringify(n,null,2)))}}class ye extends y{constructor(){super(),this.onDelete=this.onDelete.bind(this)}onDelete(){confirm(this.props.localize("ui.panel.config.automation.editor.actions.delete_confirm"))&&this.props.onChange(this.props.index,null)}render(t){return e("paper-card",null,e("div",{class:"card-menu"},e("paper-menu-button",{"no-animations":!0,"horizontal-align":"right","horizontal-offset":"-5","vertical-offset":"-5"},e("paper-icon-button",{icon:"mdi:dots-vertical",slot:"dropdown-trigger"}),e("paper-listbox",{slot:"dropdown-content"},e("paper-item",{disabled:!0},t.localize("ui.panel.config.automation.editor.actions.duplicate")),e("paper-item",{onTap:this.onDelete},t.localize("ui.panel.config.automation.editor.actions.delete"))))),e("div",{class:"card-content"},e(be,t)))}}class _e extends y{constructor(){super(),this.addAction=this.addAction.bind(this),this.actionChanged=this.actionChanged.bind(this)}addAction(){const e=this.props.script.concat({service:""});this.props.onChange(e)}actionChanged(e,t){const n=this.props.script.concat();null===t?n.splice(e,1):n[e]=t,this.props.onChange(n)}render({script:t,hass:n,localize:i}){return e("div",{class:"script"},t.map((t,o)=>e(ye,{index:o,action:t,onChange:this.actionChanged,hass:n,localize:i})),e("paper-card",null,e("div",{class:"card-actions add-card"},e("paper-button",{onTap:this.addAction},i("ui.panel.config.automation.editor.actions.add")))))}}class xe extends y{constructor(){super(),this.onChange=this.onChange.bind(this),this.triggerChanged=this.triggerChanged.bind(this),this.conditionChanged=this.conditionChanged.bind(this),this.actionChanged=this.actionChanged.bind(this)}onChange(e){this.props.onChange(B({},this.props.automation,{[e.target.name]:e.target.value}))}triggerChanged(e){this.props.onChange(B({},this.props.automation,{trigger:e}))}conditionChanged(e){this.props.onChange(B({},this.props.automation,{condition:e}))}actionChanged(e){this.props.onChange(B({},this.props.automation,{action:e}))}render({automation:t,isWide:n,hass:i,localize:o}){const{alias:a,trigger:r,condition:s,action:l}=t;return e("div",null,e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},a),e("span",{slot:"introduction"},o("ui.panel.config.automation.editor.introduction")),e("paper-card",null,e("div",{class:"card-content"},e("paper-input",{label:o("ui.panel.config.automation.editor.alias"),name:"alias",value:a,"onvalue-changed":this.onChange})))),e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},o("ui.panel.config.automation.editor.triggers.header")),e("span",{slot:"introduction"},e("ha-markdown",{content:o("ui.panel.config.automation.editor.triggers.introduction")})),e(ee,{trigger:r,onChange:this.triggerChanged,hass:i,localize:o})),e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},o("ui.panel.config.automation.editor.conditions.header")),e("span",{slot:"introduction"},e("ha-markdown",{content:o("ui.panel.config.automation.editor.conditions.introduction")})),e(ce,{condition:s||[],onChange:this.conditionChanged,hass:i,localize:o})),e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},o("ui.panel.config.automation.editor.actions.header")),e("span",{slot:"introduction"},e("ha-markdown",{content:o("ui.panel.config.automation.editor.actions.introduction")})),e(_e,{script:l,onChange:this.actionChanged,hass:i,localize:o})))}}class ke extends y{constructor(){super(),this.onChange=this.onChange.bind(this),this.sequenceChanged=this.sequenceChanged.bind(this)}onChange(e){this.props.onChange(B({},this.props.script,{[e.target.name]:e.target.value}))}sequenceChanged(e){this.props.onChange(B({},this.props.script,{sequence:e}))}render({script:t,isWide:n,hass:i,localize:o}){const{alias:a,sequence:r}=t;return e("div",null,e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},a),e("span",{slot:"introduction"},"Use scripts to execute a sequence of actions."),e("paper-card",null,e("div",{class:"card-content"},e("paper-input",{label:"Name",name:"alias",value:a,"onvalue-changed":this.onChange})))),e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},"Sequence"),e("span",{slot:"introduction"},"The sequence of actions of this script.",e("p",null,e("a",{href:"https://home-assistant.io/docs/scripts/",target:"_blank"},"Learn more about available actions."))),e(_e,{script:r,onChange:this.sequenceChanged,hass:i,localize:o})))}}window.ScriptEditor=function(t,n,i){return _(e(ke,n),t,i)},window.AutomationEditor=function(t,n,i){return _(e(xe,n),t,i)},window.unmountPreact=function(e,t){_(()=>null,e,t)}}();</script><dom-module id="ha-automation-editor" assetpath="automation/"><template><style include="ha-style">.errors{padding:20px;font-weight:bold;color:var(--google-red-500);}.content{padding-bottom:20px;}paper-card{display:block;}.triggers,
      .script{margin-top:-16px;}.triggers paper-card,
      .script paper-card{margin-top:16px;}.add-card paper-button{display:block;text-align:center;}.card-menu{position:absolute;top:0;right:0;z-index:1;color:var(--primary-text-color);}.card-menu paper-item{cursor:pointer;}span[slot=introduction] a{color:var(--primary-color);}paper-fab{position:fixed;bottom:16px;right:16px;z-index:1;margin-bottom:-80px;transition:margin-bottom .3s;}paper-fab[is-wide]{bottom:24px;right:24px;}paper-fab[dirty]{margin-bottom:0;}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="backTapped"></paper-icon-button><div main-title="">[[name]]</div></app-toolbar></app-header><div class="content"><template is="dom-if" if="[[errors]]"><div class="errors">[[errors]]</div></template><div id="root"></div></div><paper-fab slot="fab" is-wide$="[[isWide]]" dirty$="[[dirty]]" icon="mdi:content-save" title="[[localize('ui.panel.config.automation.editor.save')]]" on-click="saveAutomation"></paper-fab></ha-app-layout></template></dom-module><script>class HaAutomationEditor extends(window.hassMixins.LocalizeMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-automation-editor"}static get properties(){return{hass:{type:Object,observer:"_updateComponent"},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},errors:{type:Object,value:null},dirty:{type:Boolean,value:!1},config:{type:Object,value:null},automation:{type:Object,observer:"automationChanged"},creatingNew:{type:Boolean,observer:"creatingNewChanged"},name:{type:String,computed:"computeName(automation, localize)"},isWide:{type:Boolean,observer:"_updateComponent"},_rendered:{type:Object,value:null},_renderScheduled:{type:Boolean,value:!1}}}ready(){this.configChanged=this.configChanged.bind(this),super.ready()}disconnectedCallback(){super.disconnectedCallback(),this._rendered&&(window.unmountPreact(this._rendered),this._rendered=null)}configChanged(t){null!==this._rendered&&(this.config=t,this.errors=null,this.dirty=!0,this._updateComponent())}automationChanged(t,e){t&&(this.hass?e&&e.attributes.id===t.attributes.id||this.hass.callApi("get","config/automation/config/"+t.attributes.id).then(function(t){["trigger","condition","action"].forEach(function(e){var i=t[e];i&&!Array.isArray(i)&&(t[e]=[i])}),this.dirty=!1,this.config=t,this._updateComponent()}.bind(this)):setTimeout(()=>this.automationChanged(t,e),0))}creatingNewChanged(t){t&&(this.dirty=!1,this.config={alias:this.localize("ui.panel.config.automation.editor.default_name"),trigger:[{platform:"state"}],condition:[],action:[{service:""}]},this._updateComponent())}backTapped(){this.dirty&&!confirm(this.localize("ui.panel.config.automation.editor.unsaved_confirm"))||history.back()}_updateComponent(){!this._renderScheduled&&this.hass&&this.config&&(this._renderScheduled=!0,Promise.resolve().then(()=>{this._rendered=window.AutomationEditor(this.$.root,{automation:this.config,onChange:this.configChanged,isWide:this.isWide,hass:this.hass,localize:this.localize},this._rendered),this._renderScheduled=!1}))}saveAutomation(){var t=this.creatingNew?""+Date.now():this.automation.attributes.id;this.hass.callApi("post","config/automation/config/"+t,this.config).then(function(){this.dirty=!1,this.creatingNew&&(history.replaceState(null,null,"/config/automation/edit/"+t),this.fire("location-changed"))}.bind(this),function(t){throw this.errors=t.body.message,t}.bind(this))}computeName(t,e){return t?window.hassUtil.computeStateName(t):e("ui.panel.config.automation.editor.default_name")}}customElements.define(HaAutomationEditor.is,HaAutomationEditor);</script><dom-module id="ha-config-automation" assetpath="automation/"><template><style>ha-automation-picker,
      ha-automation-editor{height:100%;}</style><app-route route="[[route]]" pattern="/automation/edit/:automation" data="{{_routeData}}" active="{{_edittingAutomation}}"></app-route><app-route route="[[route]]" pattern="/automation/new" active="{{_creatingNew}}"></app-route><template is="dom-if" if="[[!showEditor]]"><ha-automation-picker hass="[[hass]]" narrow="[[narrow]]" show-menu="[[showMenu]]" automations="[[automations]]" is-wide="[[isWide]]"></ha-automation-picker></template><template is="dom-if" if="[[showEditor]]" restamp=""><ha-automation-editor hass="[[hass]]" automation="[[automation]]" is-wide="[[isWide]]" creating-new="[[_creatingNew]]"></ha-automation-editor></template></template></dom-module><script>class HaConfigAutomation extends Polymer.Element{static get is(){return"ha-config-automation"}static get properties(){return{hass:Object,narrow:Boolean,showMenu:Boolean,route:Object,isWide:Boolean,_routeData:Object,_routeMatches:Boolean,_creatingNew:Boolean,_edittingAutomation:Boolean,automations:{type:Array,computed:"computeAutomations(hass)"},automation:{type:Object,computed:"computeAutomation(automations, _edittingAutomation, _routeData)"},showEditor:{type:Boolean,computed:"computeShowEditor(_edittingAutomation, _creatingNew)"}}}computeAutomation(t,o,e){if(!t||!o)return null;for(var a=0;a<t.length;a++)if(t[a].attributes.id===e.automation)return t[a];return null}computeAutomations(t){var o=[];return Object.keys(t.states).forEach(function(e){var a=t.states[e];"automation"===window.hassUtil.computeDomain(a)&&"id"in a.attributes&&o.push(a)}),o.sort(function(t,o){var e=(t.attributes.alias||t.entity_id).toLowerCase(),a=(o.attributes.alias||o.entity_id).toLowerCase();return e<a?-1:e>a?1:0})}computeShowEditor(t,o){return o||t}}customElements.define(HaConfigAutomation.is,HaConfigAutomation);</script><dom-module id="ha-script-picker" assetpath="script/"><template><style include="ha-style">:host{display:block;}paper-item{cursor:pointer;}paper-fab{position:fixed;bottom:16px;right:16px;z-index:1;}paper-fab[is-wide]{bottom:24px;right:24px;}a{color:var(--primary-color);}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="_backTapped"></paper-icon-button><div main-title="">[[localize('ui.panel.config.script.caption')]]</div></app-toolbar></app-header><ha-config-section is-wide="[[isWide]]"><div slot="header">Script Editor</div><div slot="introduction">The script editor allows you to create and edit scripts. Please read <a href="https://home-assistant.io/docs/scripts/editor/" target="_blank">the instructions</a> to make sure that you have configured Home Assistant correctly.</div><paper-card heading="Pick script to edit"><template is="dom-if" if="[[!scripts.length]]"><div class="card-content"><p>We couldn't find any editable scripts.</p></div></template><template is="dom-repeat" items="[[scripts]]" as="script"><paper-item><paper-item-body two-line="" on-click="scriptTapped"><div>[[computeName(script)]]</div><div secondary="">[[computeDescription(script)]]</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></template></paper-card></ha-config-section><paper-fab slot="fab" is-wide$="[[isWide]]" icon="mdi:plus" title="Add Script" on-click="addScript"></paper-fab></ha-app-layout></template></dom-module><script>class HaScriptPicker extends(window.hassMixins.LocalizeMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-script-picker"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},scripts:{type:Array},isWide:{type:Boolean}}}scriptTapped(e){history.pushState(null,null,"/config/script/edit/"+this.scripts[e.model.index].entity_id),this.fire("location-changed")}addScript(){history.pushState(null,null,"/config/script/new"),this.fire("location-changed")}computeName(e){return window.hassUtil.computeStateName(e)}computeDescription(e){return""}_backTapped(){history.back()}}customElements.define(HaScriptPicker.is,HaScriptPicker);</script><dom-module id="ha-script-editor" assetpath="script/"><template><style include="ha-style">.errors{padding:20px;font-weight:bold;color:var(--google-red-500);}.content{padding-bottom:20px;}paper-card{display:block;}.triggers,
      .script{margin-top:-16px;}.triggers paper-card,
      .script paper-card{margin-top:16px;}.add-card paper-button{display:block;text-align:center;}.card-menu{position:absolute;top:0;right:0;z-index:1;color:var(--primary-text-color);}.card-menu paper-item{cursor:pointer;}span[slot=introduction] a{color:var(--primary-color);}paper-fab{position:fixed;bottom:16px;right:16px;z-index:1;margin-bottom:-80px;transition:margin-bottom .3s;}paper-fab[is-wide]{bottom:24px;right:24px;}paper-fab[dirty]{margin-bottom:0;}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="backTapped"></paper-icon-button><div main-title="">Script [[name]]</div></app-toolbar></app-header><div class="content"><template is="dom-if" if="[[errors]]"><div class="errors">[[errors]]</div></template><div id="root"></div></div><paper-fab slot="fab" is-wide$="[[isWide]]" dirty$="[[dirty]]" icon="mdi:content-save" title="Save" on-click="saveScript"></paper-fab></ha-app-layout></template></dom-module><script>class HaScriptEditor extends(window.hassMixins.LocalizeMixin(Polymer.Element)){static get is(){return"ha-script-editor"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},errors:{type:Object,value:null},dirty:{type:Boolean,value:!1},config:{type:Object,value:null},script:{type:Object,observer:"scriptChanged"},creatingNew:{type:Boolean,observer:"creatingNewChanged"},name:{type:String,computed:"computeName(script)"},isWide:{type:Boolean,observer:"_updateComponent"},_rendered:{type:Object,value:null},_renderScheduled:{type:Boolean,value:!1}}}ready(){this.configChanged=this.configChanged.bind(this),super.ready()}disconnectedCallback(){super.disconnectedCallback(),this._rendered&&(window.unmountPreact(this._rendered),this._rendered=null)}configChanged(e){null!==this._rendered&&(this.config=e,this.errors=null,this.dirty=!0,this._updateComponent())}scriptChanged(e,t){e&&(this.hass?t&&t.entity_id===e.entity_id||this.hass.callApi("get","config/script/config/"+window.hassUtil.computeObjectId(e)).then(e=>{var t=e.sequence;t&&!Array.isArray(t)&&(e.sequence=[t]),this.dirty=!1,this.config=e,this._updateComponent()},()=>{alert("Only scripts inside scripts.yaml are editable."),history.back()}):setTimeout(()=>this.scriptChanged(e,t),0))}creatingNewChanged(e){e&&(this.dirty=!1,this.config={alias:"New Script",sequence:[{service:"",data:{}}]},this._updateComponent())}backTapped(){this.dirty&&!confirm("You have unsaved changes. Are you sure you want to leave?")||history.back()}_updateComponent(){!this._renderScheduled&&this.hass&&this.config&&(this._renderScheduled=!0,Promise.resolve().then(()=>{this._rendered=window.ScriptEditor(this.$.root,{script:this.config,onChange:this.configChanged,isWide:this.isWide,hass:this.hass,localize:this.localize},this._rendered),this._renderScheduled=!1}))}saveScript(){var e=this.creatingNew?""+Date.now():window.hassUtil.computeObjectId(this.script);this.hass.callApi("post","config/script/config/"+e,this.config).then(()=>{this.dirty=!1,this.creatingNew&&this.navigate(`/config/script/edit/${e}`,!0)},e=>{throw this.errors=e.body.message,e})}computeName(e){return e&&window.hassUtil.computeStateName(e)}}customElements.define(HaScriptEditor.is,HaScriptEditor);</script><dom-module id="ha-config-script" assetpath="script/"><template><style>ha-script-picker,
      ha-script-editor{height:100%;}</style><app-route route="[[route]]" pattern="/script/edit/:script" data="{{_routeData}}" active="{{_edittingScript}}"></app-route><app-route route="[[route]]" pattern="/script/new" active="{{_creatingNew}}"></app-route><template is="dom-if" if="[[!showEditor]]"><ha-script-picker hass="[[hass]]" narrow="[[narrow]]" show-menu="[[showMenu]]" scripts="[[scripts]]" is-wide="[[isWide]]"></ha-script-picker></template><template is="dom-if" if="[[showEditor]]" restamp=""><ha-script-editor hass="[[hass]]" script="[[script]]" is-wide="[[isWide]]" creating-new="[[_creatingNew]]"></ha-script-editor></template></template></dom-module><script>class HaConfigScript extends Polymer.Element{static get is(){return"ha-config-script"}static get properties(){return{hass:Object,narrow:Boolean,showMenu:Boolean,route:Object,isWide:Boolean,_routeData:Object,_routeMatches:Boolean,_creatingNew:Boolean,_edittingScript:Boolean,scripts:{type:Array,computed:"computeScripts(hass)"},script:{type:Object,computed:"computeScript(scripts, _edittingScript, _routeData)"},showEditor:{type:Boolean,computed:"computeShowEditor(_edittingScript, _creatingNew)"}}}computeScript(t,e,r){if(!t||!e)return null;for(var o=0;o<t.length;o++)if(t[o].entity_id===r.script)return t[o];return null}computeScripts(t){var e=[];return Object.keys(t.states).forEach(function(r){var o=t.states[r];"script"===window.hassUtil.computeDomain(o)&&e.push(o)}),e.sort(function(t,e){var r=window.hassUtil.computeStateName(t),o=window.hassUtil.computeStateName(e);return r<o?-1:r>o?1:0})}computeShowEditor(t,e){return e||t}}customElements.define(HaConfigScript.is,HaConfigScript);</script><dom-module id="ha-service-description" assetpath="../../src/components/"><template>[[_getDescription(hass, domain, service)]]</template></dom-module><script>class HaServiceDescription extends Polymer.Element{static get is(){return"ha-service-description"}static get properties(){return{hass:Object,domain:String,service:String}}_getDescription(e,i,r){var t=e.config.services[i];if(!t)return"";var s=t[r];return s?s.description:""}}customElements.define(HaServiceDescription.is,HaServiceDescription);</script><dom-module id="ha-form-style"><template><style>.form-group{@apply --layout-horizontal;@apply --layout-center;padding:8px 16px;}.form-group label{@apply --layout-flex-2;}.form-group .form-control{@apply --layout-flex;}.form-group.vertical{@apply --layout-vertical;@apply --layout-start;}paper-dropdown-menu.form-control{margin:-9px 0;}</style></template></dom-module><dom-module id="ozw-log" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{padding-left:24px;padding-right:24px;padding-bottom:24px;}</style><ha-config-section is-wide="[[isWide]]"><span slot="header">OZW Log</span><paper-card><div class="device-picker"><paper-input label="Number of last log lines." type="number" min="0" max="1000" step="10" value="{{numLogLines}}"></paper-input></div><div class="card-actions"><paper-button raised="" on-click="refreshLog">Refresh</paper-button></div><div class="help-text"><pre>[[ozwLogs]]</pre></div></paper-card></ha-config-section></template></dom-module><script>class OzwLog extends Polymer.Element{static get is(){return"ozw-log"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean,value:!1},ozwLogs:{type:String,value:"Refresh to pull log"},numLogLines:{type:Number,value:0}}}refreshLog(){this.ozwLogs="Loading ozw log...",this.hass.callApi("GET","zwave/ozwlog?lines="+this.numLogLines).then(e=>{this.ozwLogs=e})}}customElements.define(OzwLog.is,OzwLog);</script><dom-module id="ha-call-api-button" assetpath="../../src/components/buttons/"><template><ha-progress-button id="progress" progress="[[progress]]" on-click="buttonTapped" disabled="[[disabled]]"><slot></slot></ha-progress-button></template></dom-module><script>class HaCallApiButton extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-call-api-button"}static get properties(){return{hass:Object,progress:{type:Boolean,value:!1},path:String,method:{type:String,value:"POST"},data:{type:Object,value:{}},disabled:{type:Boolean,value:!1}}}buttonTapped(){this.progress=!0;const t={method:this.method,path:this.path,data:this.data};this.hass.callApi(this.method,this.path,this.data).then(s=>{this.progress=!1,this.$.progress.actionSuccess(),t.success=!0,t.response=s},s=>{this.progress=!1,this.$.progress.actionError(),t.success=!1,t.response=s}).then(()=>{this.fire("hass-api-called",t)})}}customElements.define(HaCallApiButton.is,HaCallApiButton);</script><dom-module id="zwave-network" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.card-actions.warning ha-call-service-button{color:var(--google-red-500);}.toggle-help-icon{position:absolute;top:-6px;right:0;color:var(--primary-color);}ha-service-description{display:block;color:grey;}[hidden]{display:none;}</style><ha-config-section is-wide="[[isWide]]"><div style="position: relative" slot="header"><span>Z-Wave Network Management</span><paper-icon-button class="toggle-help-icon" on-click="helpTap" icon="mdi:help-circle"></paper-icon-button></div><span slot="introduction">Run commands that affect the Z-Wave network. You won't get feedback on whether the command succeeded, but you can look in the OZW Log to try to figure out.</span><paper-card class="content"><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="add_node_secure">Add Node Secure</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="add_node_secure" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="add_node">Add Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="add_node" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="remove_node">Remove Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="remove_node" hidden$="[[!showDescription]]"></ha-service-description></div><div class="card-actions warning"><ha-call-service-button hass="[[hass]]" domain="zwave" service="cancel_command">Cancel Command</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="cancel_command" hidden$="[[!showDescription]]"></ha-service-description></div><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="heal_network">Heal Network</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="zwave" service="start_network">Start Network</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="start_network" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="stop_network">Stop Network</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="stop_network" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="soft_reset">Soft Reset</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="soft_reset" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="test_network">Test Network</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="test_network" hidden$="[[!showDescription]]"></ha-service-description><ha-call-api-button hass="[[hass]]" path="zwave/saveconfig">Save Config</ha-call-api-button></div></paper-card></ha-config-section></template></dom-module><script>class ZwaveNetwork extends Polymer.Element{static get is(){return"zwave-network"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean,value:!1},showDescription:{type:Boolean,value:!1}}}helpTap(){this.showDescription=!this.showDescription}}customElements.define(ZwaveNetwork.is,ZwaveNetwork);</script><dom-module id="zwave-node-information" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}.node-info{margin-left:16px;}paper-card{display:block;margin:0 auto;max-width:600px;}paper-button[toggles][active]{background:lightgray;}</style><div class="content"><paper-card heading="Node Information"><div class="card-actions"><paper-button toggles="" raised="" noink="" active="{{nodeInfoActive}}">Show</paper-button></div><template is="dom-if" if="{{nodeInfoActive}}"><template is="dom-repeat" items="[[selectedNodeAttrs]]" as="state"><div class="node-info"><span>[[state]]</span></div></template></template></paper-card></div></template></dom-module><script>class ZwaveNodeInformation extends Polymer.Element{static get is(){return"zwave-node-information"}static get properties(){return{nodes:{type:Array,observer:"nodeChanged"},selectedNode:{type:Number,value:-1,observer:"nodeChanged"},selectedNodeAttrs:{type:Array},nodeInfoActive:{type:Boolean}}}nodeChanged(e){if(this.nodes&&-1!==e){var t=this.nodes[this.selectedNode].attributes,o=[];Object.keys(t).forEach(function(e){o.push(e+": "+t[e])}),this.selectedNodeAttrs=o.sort()}}}customElements.define(ZwaveNodeInformation.is,ZwaveNodeInformation);</script><dom-module id="zwave-values" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply --layout-horizontal;@apply --layout-center-center;padding-left:24px;padding-right:24px;padding-bottom:24px;}.help-text{padding-left:24px;padding-right:24px;}</style><div class="content"><paper-card heading="Node Values"><div class="device-picker"><paper-dropdown-menu label="Value" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedValue}}"><template is="dom-repeat" items="[[values]]" as="item"><paper-item>[[computeSelectCaption(item)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[!computeIsValueSelected(selectedValue)]]"><div class="card-actions"><paper-input float-label="Value Name" type="text" value="{{newValueNameInput}}" placeholder="[[computeGetValueName(selectedValue)]]"></paper-input><ha-call-service-button hass="[[hass]]" domain="zwave" service="rename_value" service-data="[[computeValueNameServiceData(newValueNameInput)]]">Rename Value</ha-call-service-button></div></template></paper-card></div></template></dom-module><script>class ZwaveValues extends Polymer.Element{static get is(){return"zwave-values"}static get properties(){return{hass:{type:Object},nodes:{type:Array},values:{type:Array},selectedNode:{type:Number},selectedValue:{type:Number,value:-1,observer:"selectedValueChanged"}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){var t=this;e.detail.success&&setTimeout(function(){t.refreshValues(t.selectedNode)},5e3)}computeSelectCaption(e){return e.value.label+" (Instance: "+e.value.instance+", Index: "+e.value.index+")"}computeGetValueName(e){return this.values[e].value.label}computeIsValueSelected(e){return!this.nodes||-1===this.selectedNode||-1===e}refreshValues(e){var t=[];this.hass.callApi("GET","zwave/values/"+this.nodes[e].attributes.node_id).then(function(e){Object.keys(e).forEach(function(s){t.push({key:s,value:e[s]})}),this.values=t,this.selectedValueChanged(this.selectedValue)}.bind(this))}computeValueNameServiceData(e){return-1===!this.selectedNode||-1===this.selectedValue?-1:{node_id:this.nodes[this.selectedNode].attributes.node_id,value_id:this.values[this.selectedValue].key,name:e}}selectedValueChanged(e){if(-1!==!this.selectedNode&&-1!==this.selectedValue){var t=this;this.hass.callApi("GET","config/zwave/device_config/"+this.values[e].value.entity_id).then(function(s){t.entityIgnored=s.ignored||!1,t.entityPollingIntensity=t.values[e].value.poll_intensity})}}}customElements.define(ZwaveValues.is,ZwaveValues);</script><dom-module id="zwave-groups" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply --layout-horizontal;@apply --layout-center-center;padding-left:24px;padding-right:24px;padding-bottom:24px;}.help-text{padding-left:24px;padding-right:24px;padding-bottom:12px;}</style><paper-card class="content" heading="Node group associations"><div class="device-picker"><paper-dropdown-menu label="Group" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedGroup}}"><template is="dom-repeat" items="[[groups]]" as="state"><paper-item>[[computeSelectCaptionGroup(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[computeIsGroupSelected(selectedGroup)]]"><div class="device-picker"><paper-dropdown-menu label="Node to control" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedTargetNode}}"><template is="dom-repeat" items="[[nodes]]" as="state"><paper-item>[[computeSelectCaption(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><div class="help-text"><span>Other Nodes in this group:</span><template is="dom-repeat" items="[[otherGroupNodes]]" as="state"><div>[[state]]</div></template></div><div class="help-text"><span>Max Associations:</span> <span>[[maxAssociations]]</span></div></template><template is="dom-if" if="[[computeIsTargetNodeSelected(selectedTargetNode)]]"><div class="card-actions"><template is="dom-if" if="[[!noAssociationsLeft]]"><ha-call-service-button hass="[[hass]]" domain="zwave" service="change_association" service-data="[[computeAssocServiceData(selectedGroup, &quot;add&quot;)]]">Add To Group</ha-call-service-button></template><template is="dom-if" if="[[computeTargetInGroup(selectedGroup, selectedTargetNode)]]"><ha-call-service-button hass="[[hass]]" domain="zwave" service="change_association" service-data="[[computeAssocServiceData(selectedGroup, &quot;remove&quot;)]]">Remove From Group</ha-call-service-button></template></div></template></paper-card></template></dom-module><script>class ZwaveGroups extends Polymer.Element{static get is(){return"zwave-groups"}static get properties(){return{hass:{type:Object},nodes:{type:Array},groups:{type:Array},selectedNode:{type:Number},selectedTargetNode:{type:Number,value:-1},selectedGroup:{type:Number,value:-1,observer:"selectedGroupChanged"},otherGroupNodes:{type:Array,value:-1,computed:"computeOtherGroupNodes(selectedGroup)"},maxAssociations:{type:String,value:"",computed:"computeMaxAssociations(selectedGroup)"},noAssociationsLeft:{type:Boolean,value:!0,computed:"computeAssociationsLeft(selectedGroup)"}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){if(e.detail.success){var t=this;setTimeout(function(){t.refreshGroups(t.selectedNode)},5e3)}}computeAssociationsLeft(e){return-1===e||this.maxAssociations===this.otherGroupNodes.length}computeMaxAssociations(e){if(-1===e)return-1;var t=this.groups[e].value.max_associations;return t||"None"}computeOtherGroupNodes(e){if(-1===e)return-1;var t=Object.values(this.groups[e].value.association_instances);return t.length?t.map(e=>{if(!e.length||2!==e.length)return"Unknown Node: "+e;const t=e[0],s=e[1],o=this.nodes.find(e=>e.attributes.node_id===t);if(!o)return"Unknown Node (id: "+(s?t+"."+s:t)+")";let r=this.computeSelectCaption(o);return s&&(r+="/ Instance: "+s),r}):["None"]}computeTargetInGroup(e,t){if(-1===e||-1===t)return!1;const s=Object.values(this.groups[e].value.associations);return!!s.length&&-1!==s.indexOf(this.nodes[t].attributes.node_id)}computeSelectCaption(e){return window.hassUtil.computeStateName(e)+" (Node:"+e.attributes.node_id+" "+e.attributes.query_stage+")"}computeSelectCaptionGroup(e){return e.key+": "+e.value.label}computeIsTargetNodeSelected(e){return this.nodes&&-1!==e}computeIsGroupSelected(e){return this.nodes&&-1!==this.selectedNode&&-1!==e}computeAssocServiceData(e,t){return-1===!this.groups||-1===e||-1===this.selectedNode?-1:{node_id:this.nodes[this.selectedNode].attributes.node_id,association:t,target_node_id:this.nodes[this.selectedTargetNode].attributes.node_id,group:this.groups[e].key}}refreshGroups(e){var t=[];this.hass.callApi("GET","zwave/groups/"+this.nodes[e].attributes.node_id).then(function(e){Object.keys(e).forEach(function(s){t.push({key:s,value:e[s]})}),this.groups=t,this.selectedGroupChanged(this.selectedGroup)}.bind(this))}selectedGroupChanged(e){-1!==this.selectedGroup&&-1!==e&&(this.maxAssociations=this.groups[e].value.max_associations,this.otherGroupNodes=Object.values(this.groups[e].value.associations))}}customElements.define(ZwaveGroups.is,ZwaveGroups);</script><dom-module id="zwave-node-config" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply --layout-horizontal;@apply --layout-center-center;padding-left:24px;padding-right:24px;padding-bottom:24px;}.help-text{padding-left:24px;padding-right:24px;}</style><div class="content"><paper-card heading="Node config options"><template is="dom-if" if="[[wakeupNode]]"><div class="card-actions"><paper-input float-label="Wakeup Interval" type="number" value="{{wakeupInput}}" placeholder="[[computeGetWakeupValue(selectedNode)]]"><div suffix="">seconds</div></paper-input><ha-call-service-button hass="[[hass]]" domain="zwave" service="set_wakeup" service-data="[[computeWakeupServiceData(wakeupInput)]]">Set Wakeup</ha-call-service-button></div></template><div class="device-picker"><paper-dropdown-menu label="Config parameter" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedConfigParameter}}"><template is="dom-repeat" items="[[config]]" as="state"><paper-item>[[computeSelectCaptionConfigParameter(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[isConfigParameterSelected(selectedConfigParameter, 'List')]]"><div class="device-picker"><paper-dropdown-menu label="Config value" dynamic-align="" class="flex" placeholder="{{loadedConfigValue}}"><paper-listbox slot="dropdown-content" selected="{{selectedConfigValue}}"><template is="dom-repeat" items="[[selectedConfigParameterValues]]" as="state"><paper-item>[[state]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></template><template is="dom-if" if="[[isConfigParameterSelected(selectedConfigParameter, 'Byte Short Int')]]"><div class="card-actions"><paper-input label="{{selectedConfigParameterNumValues}}" type="number" value="{{selectedConfigValue}}" max="{{configParameterMax}}" min="{{configParameterMin}}"></paper-input></div></template><template is="dom-if" if="[[isConfigParameterSelected(selectedConfigParameter, 'Bool Button')]]"><div class="device-picker"><paper-dropdown-menu label="Config value" class="flex" dynamic-align="" placeholder="{{loadedConfigValue}}"><paper-listbox slot="dropdown-content" selected="{{selectedConfigValue}}"><template is="dom-repeat" items="[[selectedConfigParameterValues]]" as="state"><paper-item>[[state]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></template><div class="help-text"><span>[[configValueHelpText]]</span></div><template is="dom-if" if="[[isConfigParameterSelected(selectedConfigParameter, 'Bool Button Byte Short Int List')]]"><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="set_config_parameter" service-data="[[computeSetConfigParameterServiceData(selectedConfigValue)]]">Set Config Parameter</ha-call-service-button></div></template></paper-card></div></template></dom-module><script>class ZwaveNodeConfig extends Polymer.Element{static get is(){return"zwave-node-config"}static get properties(){return{hass:{type:Object},nodes:{type:Array,observer:"nodesChanged"},selectedNode:{type:Number,value:-1,observer:"nodesChanged"},config:{type:Array,value:function(){return[]}},selectedConfigParameter:{type:Number,value:-1,observer:"selectedConfigParameterChanged"},configParameterMax:{type:Number,value:-1},configParameterMin:{type:Number,value:-1},configValueHelpText:{type:String,value:"",computed:"computeConfigValueHelp(selectedConfigParameter)"},selectedConfigParameterType:{type:String,value:""},selectedConfigValue:{type:Number,value:-1,observer:"computeSetConfigParameterServiceData"},selectedConfigParameterValues:{type:Array,value:function(){return[]}},selectedConfigParameterNumValues:{type:String,value:""},loadedConfigValue:{type:Number,value:-1},wakeupInput:{type:Number},wakeupNode:{type:Boolean,value:!1}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){if(e.detail.success){var t=this;setTimeout(function(){t.refreshConfig(t.selectedNode)},5e3)}}nodesChanged(){this.nodes&&(this.wakeupNode=0===this.nodes[this.selectedNode].attributes.wake_up_interval||this.nodes[this.selectedNode].attributes.wake_up_interval,this.wakeupNode&&(0===this.nodes[this.selectedNode].attributes.wake_up_interval?this.wakeupInput="":this.wakeupInput=this.nodes[this.selectedNode].attributes.wake_up_interval))}computeGetWakeupValue(e){return-1!==this.selectedNode&&this.nodes[e].attributes.wake_up_interval?this.nodes[e].attributes.wake_up_interval:"unknown"}computeWakeupServiceData(e){return{node_id:this.nodes[this.selectedNode].attributes.node_id,value:e}}computeConfigValueHelp(e){if(-1===e)return"";var t=this.config[e].value.help;return t||["No helptext available"]}computeSetConfigParameterServiceData(e){if(-1===this.selectedNode||-1===this.selectedConfigParameter)return-1;var t=null;return"Short Byte Int".includes(this.selectedConfigParameterType)&&(t=parseInt(e,10)),"Bool Button".includes(this.selectedConfigParameterType)&&(t=this.selectedConfigParameterValues[e]),"List"===this.selectedConfigParameterType&&(t=this.selectedConfigParameterValues[e]),{node_id:this.nodes[this.selectedNode].attributes.node_id,parameter:this.config[this.selectedConfigParameter].key,value:t}}selectedConfigParameterChanged(e){-1!==e&&(this.selectedConfigValue=-1,this.loadedConfigValue=-1,this.selectedConfigParameterValues=[],this.selectedConfigParameterType=this.config[e].value.type,this.configParameterMax=this.config[e].value.max,this.configParameterMin=this.config[e].value.min,this.loadedConfigValue=this.config[e].value.data,this.configValueHelpText=this.config[e].value.help,"Short Byte Int".includes(this.selectedConfigParameterType)&&(this.selectedConfigParameterNumValues=this.config[e].value.data_items,this.selectedConfigValue=this.loadedConfigValue),"Bool Button".includes(this.selectedConfigParameterType)&&(this.selectedConfigParameterValues=["True","False"],this.config[e].value.data?this.loadedConfigValue="True":this.loadedConfigValue="False"),"List".includes(this.selectedConfigParameterType)&&(this.selectedConfigParameterValues=this.config[e].value.data_items))}isConfigParameterSelected(e,t){return-1!==e&&(this.config[e].value.type===t||!!t.includes(this.config[e].value.type))}computeSelectCaptionConfigParameter(e){return e.key+": "+e.value.label}refreshConfig(e){var t=[];this.hass.callApi("GET","zwave/config/"+this.nodes[e].attributes.node_id).then(function(e){Object.keys(e).forEach(function(a){t.push({key:a,value:e[a]})}),this.config=t,this.selectedConfigParameterChanged(this.selectedConfigParameter)}.bind(this))}}customElements.define(ZwaveNodeConfig.is,ZwaveNodeConfig);</script><dom-module id="zwave-usercodes" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply --layout-horizontal;@apply --layout-center-center;padding-left:24px;padding-right:24px;padding-bottom:24px;}</style><div class="content"><paper-card heading="Node user codes"><div class="device-picker"><paper-dropdown-menu label="Code slot" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedUserCode}}"><template is="dom-repeat" items="[[userCodes]]" as="state"><paper-item>[[computeSelectCaptionUserCodes(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[isUserCodeSelected(selectedUserCode)]]"><div class="card-actions"><paper-input label="User code" type="text" allowed-pattern="[0-9,a-f,x,\\]" maxlength="{{userCodeMaxLen}}" minlength="16" value="{{selectedUserCodeValue}}"></paper-input><pre>Ascii: [[computedCodeOutput]]</pre></div><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="lock" service="set_usercode" service-data="[[computeUserCodeServiceData(selectedUserCodeValue, &quot;Add&quot;)]]">Set Usercode</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="lock" service="clear_usercode" service-data="[[computeUserCodeServiceData(selectedUserCode, &quot;Delete&quot;)]]">Delete Usercode</ha-call-service-button></div></template></paper-card></div></template></dom-module><script>class ZwaveUsercodes extends Polymer.Element{static get is(){return"zwave-usercodes"}static get properties(){return{hass:{type:Object},nodes:{type:Array},selectedNode:{type:Number},userCodes:{type:Object},userCodeMaxLen:{type:Number,value:4},selectedUserCode:{type:Number,value:-1,observer:"selectedUserCodeChanged"},selectedUserCodeValue:{type:String},computedCodeOutput:{type:String,value:""}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){if(e.detail.success){var s=this;setTimeout(function(){s.refreshUserCodes(s.selectedNode)},5e3)}}isUserCodeSelected(e){return-1!==e}computeSelectCaptionUserCodes(e){return e.key+": "+e.value.label}selectedUserCodeChanged(e){if(-1!==this.selectedUserCode&&-1!==e){var s=this.userCodes[e].value.code;this.userCodeMaxLen=4*this.userCodes[e].value.length,this.selectedUserCodeValue=this.a2hex(s),this.computedCodeOutput="["+this.hex2a(this.selectedUserCodeValue)+"]"}}computeUserCodeServiceData(e,s){if(-1===this.selectedNode||!e)return-1;var t=null,d=null;return"Add"===s&&(d=this.hex2a(e),this.computedCodeOutput="["+d+"]",t={node_id:this.nodes[this.selectedNode].attributes.node_id,code_slot:this.selectedUserCode,usercode:d}),"Delete"===s&&(t={node_id:this.nodes[this.selectedNode].attributes.node_id,code_slot:this.selectedUserCode}),t}refreshUserCodes(e){this.selectedUserCodeValue="";var s=[];this.hass.callApi("GET","zwave/usercodes/"+this.nodes[e].attributes.node_id).then(function(e){Object.keys(e).forEach(function(t){s.push({key:t,value:e[t]})}),this.userCodes=s,this.selectedUserCodeChanged(this.selectedUserCode)}.bind(this))}a2hex(e){for(var s=[],t="",d=0,r=e.length;d<r;d++){var o=Number(e.charCodeAt(d)).toString(16);t="0"===o?"00":o,s.push("\\x"+t)}return s.join("")}hex2a(e){for(var s=e.toString().replace(/\\x/g,""),t="",d=0;d<s.length;d+=2)t+=String.fromCharCode(parseInt(s.substr(d,2),16));return t}}customElements.define(ZwaveUsercodes.is,ZwaveUsercodes);</script><dom-module id="ha-config-zwave" assetpath="zwave/"><template><style include="iron-flex ha-style ha-form-style">.content{margin-top:24px;}.node-info{margin-left:16px;}.help-text{padding-left:24px;padding-right:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply --layout-horizontal;@apply --layout-center-center;padding-left:24px;padding-right:24px;padding-bottom:24px;}ha-service-description{display:block;color:grey;}[hidden]{display:none;}.toggle-help-icon{position:absolute;top:6px;right:0;color:var(--primary-color);}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="_backTapped"></paper-icon-button><div main-title="">[[localize('ui.panel.config.zwave.caption')]]</div></app-toolbar></app-header><zwave-network id="zwave-network" is-wide="[[isWide]]" hass="[[hass]]"></zwave-network><ha-config-section is-wide="[[isWide]]"><div style="position: relative" slot="header"><span>Z-Wave Node Management</span><paper-icon-button class="toggle-help-icon" on-click="toggleHelp" icon="mdi:help-circle"></paper-icon-button></div><span slot="introduction">Run Z-Wave commands that affect a single node. Pick a node to see a list of available commands.</span><paper-card class="content"><div class="device-picker"><paper-dropdown-menu dynamic-align="" label="Nodes" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedNode}}"><template is="dom-repeat" items="[[nodes]]" as="state"><paper-item>[[computeSelectCaption(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[!computeIsNodeSelected(selectedNode)]]"><template is="dom-if" if="[[showHelp]]"><div style="color: grey; padding: 12px">Select node to view per-node options</div></template></template><template is="dom-if" if="[[computeIsNodeSelected(selectedNode)]]"><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="refresh_node" service-data="[[computeNodeServiceData(selectedNode)]]">Refresh Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="refresh_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="remove_failed_node" service-data="[[computeNodeServiceData(selectedNode)]]">Remove Failed Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="remove_failed_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="replace_failed_node" service-data="[[computeNodeServiceData(selectedNode)]]">Replace Failed Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="replace_failed_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="print_node" service-data="[[computeNodeServiceData(selectedNode)]]">Print Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="print_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="heal_node" service-data="[[computeHealNodeServiceData(selectedNode)]]">Heal Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="heal_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="test_node" service-data="[[computeNodeServiceData(selectedNode)]]">Test Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="test_node" hidden$="[[!showHelp]]"></ha-service-description></div><div class="card-actions"><paper-input float-label="New node name" type="text" value="{{newNodeNameInput}}" placeholder="[[computeGetNodeName(selectedNode)]]"></paper-input><ha-call-service-button hass="[[hass]]" domain="zwave" service="rename_node" service-data="[[computeNodeNameServiceData(newNodeNameInput)]]">Rename Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="rename_node" hidden$="[[!showHelp]]"></ha-service-description></div><div class="device-picker"><paper-dropdown-menu label="Entities of this node" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedEntity}}"><template is="dom-repeat" items="[[entities]]" as="state"><paper-item>[[computeSelectCaptionEnt(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[!computeIsEntitySelected(selectedEntity)]]"><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="refresh_entity" service-data="[[computeRefreshEntityServiceData(selectedEntity)]]">Refresh Entity</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="refresh_entity" hidden$="[[!showHelp]]"></ha-service-description></div><div class="form-group"><paper-checkbox checked="{{entityIgnored}}" class="form-control">Exclude this entity from Home Assistant</paper-checkbox><paper-input disabled="{{entityIgnored}}" label="Polling intensity" type="number" min="0" value="{{entityPollingIntensity}}"></paper-input></div><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="set_poll_intensity" service-data="[[computePollIntensityServiceData(entityPollingIntensity)]]">Save</ha-call-service-button></div><div class="content"><div class="card-actions"><paper-button toggles="" raised="" noink="" active="{{entityInfoActive}}">Entity Attributes</paper-button></div><template is="dom-if" if="{{entityInfoActive}}"><template is="dom-repeat" items="[[selectedEntityAttrs]]" as="state"><div class="node-info"><span>[[state]]</span></div></template></template></div></template></template></paper-card><template is="dom-if" if="[[computeIsNodeSelected(selectedNode)]]"><zwave-node-information id="zwave-node-information" nodes="[[nodes]]" selected-node="[[selectedNode]]"></zwave-node-information><zwave-values hass="[[hass]]" nodes="[[nodes]]" selected-node="[[selectedNode]]" values="[[values]]"></zwave-values><zwave-groups hass="[[hass]]" nodes="[[nodes]]" selected-node="[[selectedNode]]" groups="[[groups]]"></zwave-groups><zwave-node-config hass="[[hass]]" nodes="[[nodes]]" selected-node="[[selectedNode]]" config="[[config]]"></zwave-node-config></template><template is="dom-if" if="{{hasNodeUserCodes}}"><zwave-usercodes id="zwave-usercodes" hass="[[hass]]" nodes="[[nodes]]" user-codes="[[userCodes]]" selected-node="[[selectedNode]]"></zwave-usercodes></template></ha-config-section><ozw-log is-wide="[[isWide]]" hass="[[hass]]"></ozw-log></ha-app-layout></template></dom-module><script>class HaConfigZwave extends(window.hassMixins.LocalizeMixin(Polymer.Element)){static get is(){return"ha-config-zwave"}static get properties(){return{hass:Object,isWide:Boolean,nodes:{type:Array,computed:"computeNodes(hass)"},selectedNode:{type:Number,value:-1,observer:"selectedNodeChanged"},config:{type:Array,value:function(){return[]}},entities:{type:Array,computed:"computeEntities(selectedNode)"},entityInfoActive:{type:Boolean},selectedEntity:{type:Number,value:-1,observer:"selectedEntityChanged"},selectedEntityAttrs:{type:Array,computed:"computeSelectedEntityAttrs(selectedEntity)"},values:{type:Array},groups:{type:Array},newNodeNameInput:{type:String},userCodes:{type:Array,value:function(){return[]}},hasNodeUserCodes:{type:Boolean,value:!1},showHelp:{type:Boolean,value:!1},entityIgnored:{type:Boolean},entityPollingIntensity:{type:Number}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){var t=this;e.detail.success&&"set_poll_intensity"===e.detail.service&&t.saveEntity()}computeNodes(e){return Object.keys(e.states).map(function(t){return e.states[t]}).filter(function(e){return e.entity_id.match("zwave[.]")}).sort(window.hassUtil.sortByName)}computeEntities(e){if(!this.nodes||-1===e)return-1;var t=this.hass,s=this.nodes[this.selectedNode].attributes.node_id;return Object.keys(t.states).map(function(e){return t.states[e]}).filter(function(e){return void 0!==e.attributes.node_id&&(!e.attributes.hidden&&"node_id"in e.attributes&&e.attributes.node_id===s&&!e.entity_id.match("zwave[.]"))}).sort(window.hassUtil.sortByName)}selectedNodeChanged(e){this.newNodeNameInput="",-1!==e&&(this.selectedConfigParameter=-1,this.selectedConfigParameterValue=-1,this.selectedGroup=-1,this.hass.callApi("GET","zwave/config/"+this.nodes[e].attributes.node_id).then(e=>{this.config=this._objToArray(e)}),this.hass.callApi("GET","zwave/values/"+this.nodes[e].attributes.node_id).then(e=>{this.values=this._objToArray(e)}),this.hass.callApi("GET","zwave/groups/"+this.nodes[e].attributes.node_id).then(e=>{this.groups=this._objToArray(e)}),this.hasNodeUserCodes=!1,this.notifyPath("hasNodeUserCodes"),this.hass.callApi("GET","zwave/usercodes/"+this.nodes[e].attributes.node_id).then(e=>{this.userCodes=this._objToArray(e),this.hasNodeUserCodes=this.userCodes.length>0,this.notifyPath("hasNodeUserCodes")}))}selectedEntityChanged(e){if(-1!==e){var t=this;t.hass.callApi("GET","zwave/values/"+t.nodes[t.selectedNode].attributes.node_id).then(e=>{t.values=t._objToArray(e)});var s=t.entities[e].attributes.value_id,i=t.values.find(function(e){return e.key===s}),n=t.values.indexOf(i);t.hass.callApi("GET","config/zwave/device_config/"+s).then(function(e){t.entityIgnored=e.ignored||!1,t.entityPollingIntensity=t.values[n].value.poll_intensity})}}computeSelectedEntityAttrs(e){if(-1===e)return"No entity selected";var t=this.entities[e].attributes,s=[];return Object.keys(t).forEach(function(e){s.push(e+": "+t[e])}),s.sort()}computeSelectCaption(e){return window.hassUtil.computeStateName(e)+" (Node:"+e.attributes.node_id+" "+e.attributes.query_stage+")"}computeSelectCaptionEnt(e){return window.hassUtil.computeDomain(e)+"."+window.hassUtil.computeStateName(e)}computeIsNodeSelected(){return this.nodes&&-1!==this.selectedNode}computeIsEntitySelected(e){return-1===e}computeNodeServiceData(e){return{node_id:this.nodes[e].attributes.node_id}}computeHealNodeServiceData(e){return{node_id:this.nodes[e].attributes.node_id,return_routes:!0}}computeGetNodeName(e){return-1!==this.selectedNode&&this.nodes[e].entity_id?this.nodes[e].attributes.node_name:-1}computeNodeNameServiceData(e){return{node_id:this.nodes[this.selectedNode].attributes.node_id,name:e}}computeRefreshEntityServiceData(e){return-1===e?-1:{entity_id:this.entities[e].entity_id}}computePollIntensityServiceData(e){return-1===!this.selectedNode||-1===this.selectedEntity?-1:{node_id:this.nodes[this.selectedNode].attributes.node_id,value_id:this.entities[this.selectedEntity].attributes.value_id,poll_intensity:parseInt(e)}}saveEntity(){var e={ignored:this.entityIgnored,polling_intensity:parseInt(this.entityPollingIntensity)};return this.hass.callApi("POST","config/zwave/device_config/"+this.entities[this.selectedEntity].entity_id,e)}toggleHelp(){this.showHelp=!this.showHelp}_objToArray(e){var t=[];return Object.keys(e).forEach(function(s){t.push({key:s,value:e[s]})}),t}_backTapped(){history.back()}}customElements.define(HaConfigZwave.is,HaConfigZwave);</script><dom-module id="ha-customize-array" assetpath="customize/types/"><template><style>paper-dropdown-menu{margin:-9px 0;}</style><paper-dropdown-menu label="[[item.description]]" disabled="[[item.secondary]]" selected-item-label="{{item.value}}" dynamic-align=""><paper-listbox slot="dropdown-content" selected="[[computeSelected(item)]]"><template is="dom-repeat" items="[[getOptions(item)]]" as="option"><paper-item>[[option]]</paper-item></template></paper-listbox></paper-dropdown-menu></template></dom-module><script>class HaCustomizeArray extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-customize-array"}static get properties(){return{item:{type:Object,notifies:!0}}}getOptions(t){const e=t.domain||"*",i=t.options[e]||t.options["*"];return i?i.sort():(this.item.type="string",this.fire("item-changed"),[])}computeSelected(t){return this.getOptions(t).indexOf(t.value)}}customElements.define(HaCustomizeArray.is,HaCustomizeArray);</script><dom-module id="ha-customize-boolean" assetpath="customize/types/"><template><paper-checkbox disabled="[[item.secondary]]" checked="{{item.value}}">[[item.description]]</paper-checkbox></template></dom-module><script>class HaCustomizeBoolean extends Polymer.Element{static get is(){return"ha-customize-boolean"}static get properties(){return{item:{type:Object,notifies:!0}}}}customElements.define(HaCustomizeBoolean.is,HaCustomizeBoolean);</script><dom-module id="ha-customize-icon" assetpath="customize/types/"><template><style>:host{@apply --layout-horizontal;}.icon-image{border:1px solid grey;padding:8px;margin-right:20px;margin-top:10px;}</style><iron-icon class="icon-image" icon="[[item.value]]"></iron-icon><paper-input auto-validate="" pattern="(mdi:.*)?" error-message="Must start with 'mdi:'" disabled="[[item.secondary]]" label="icon" value="{{item.value}}"></paper-input></template></dom-module><script>class HaCustomizeIcon extends Polymer.Element{static get is(){return"ha-customize-icon"}static get properties(){return{item:{type:Object,notifies:!0}}}}customElements.define(HaCustomizeIcon.is,HaCustomizeIcon);</script><dom-module id="ha-customize-key-value" assetpath="customize/types/"><template><style>:host{@apply --layout-horizontal;}paper-input{@apply --layout-flex;}.key{padding-right:20px;}</style><paper-input disabled="[[item.secondary]]" class="key" label="Attribute name" value="{{item.attribute}}"></paper-input><paper-input disabled="[[item.secondary]]" label="Attribute value" value="{{item.value}}"></paper-input></template></dom-module><script>class HaCustomizeKeyValue extends Polymer.Element{static get is(){return"ha-customize-key-value"}static get properties(){return{item:{type:Object,notifies:!0}}}}customElements.define(HaCustomizeKeyValue.is,HaCustomizeKeyValue);</script><dom-module id="ha-customize-string" assetpath="customize/types/"><template><paper-input disabled="[[item.secondary]]" label="[[getLabel(item)]]" value="{{item.value}}"></paper-input></template></dom-module><script>class HaCustomizeString extends Polymer.Element{static get is(){return"ha-customize-string"}static get properties(){return{item:{type:Object,notifies:!0}}}getLabel(t){return t.description+("json"===t.type?" (JSON formatted)":"")}}customElements.define(HaCustomizeString.is,HaCustomizeString);</script><dom-module id="ha-customize-attribute" assetpath="customize/"><template><style include="ha-form-style">:host{display:block;position:relative;padding-right:40px;}.button{position:absolute;margin-top:-20px;top:50%;right:0;}</style><div id="wrapper" class="form-group"></div><paper-icon-button class="button" icon="[[getIcon(item.secondary)]]" on-click="tapButton"></paper-icon-button></template></dom-module><script>class HaCustomizeAttribute extends Polymer.Element{static get is(){return"ha-customize-attribute"}static get properties(){return{item:{type:Object,notify:!0,observer:"itemObserver"}}}tapButton(){this.item.secondary?this.item=Object.assign({},this.item,{secondary:!1}):this.item=Object.assign({},this.item,{closed:!0})}getIcon(t){return t?"mdi:pencil":"mdi:close"}itemObserver(t){const e=this.$.wrapper,i=window.hassAttributeUtil.TYPE_TO_TAG[t.type].toUpperCase();let s;e.lastChild&&e.lastChild.tagName===i?s=e.lastChild:(e.lastChild&&e.removeChild(e.lastChild),this.$.child=s=document.createElement(i.toLowerCase()),s.className="form-control",s.addEventListener("item-changed",()=>{this.item=Object.assign({},s.item)})),s.setProperties({item:this.item}),null===s.parentNode&&e.appendChild(s)}}customElements.define(HaCustomizeAttribute.is,HaCustomizeAttribute);</script><dom-module id="ha-form-customize-attributes" assetpath="customize/"><template><style>[hidden]{display:none;}</style><template is="dom-repeat" items="{{attributes}}" mutable-data=""><ha-customize-attribute item="{{item}}" hidden$="[[item.closed]]"></ha-customize-attribute></template></template></dom-module><script>class HaFormCustomizeAttributes extends(Polymer.MutableData(Polymer.Element)){static get is(){return"ha-form-customize-attributes"}static get properties(){return{attributes:{type:Array,notify:!0}}}}customElements.define(HaFormCustomizeAttributes.is,HaFormCustomizeAttributes);</script><dom-module id="ha-form-customize" assetpath="customize/"><template><style include="iron-flex ha-style ha-form-style">.warning{color:red;}.attributes-text{padding-left:20px;}</style><template is="dom-if" if="[[computeShowWarning(localConfig, globalConfig)]]"><div class="warning">It seems that your configuration.yaml doesn't properly include customize.yaml<br>Changes made here won't affect your configuration.</div></template><template is="dom-if" if="[[hasLocalAttributes]]"><h4 class="attributes-text">The following attributes are already set in customize.yaml<br></h4><ha-form-customize-attributes attributes="{{localAttributes}}"></ha-form-customize-attributes></template><template is="dom-if" if="[[hasGlobalAttributes]]"><h4 class="attributes-text">The following attributes are customized from outside of customize.yaml<br>Possibly via a domain, a glob or a different include.</h4><ha-form-customize-attributes attributes="{{globalAttributes}}"></ha-form-customize-attributes></template><template is="dom-if" if="[[hasExistingAttributes]]"><h4 class="attributes-text">The following attributes of the entity are set programatically.<br>You can override them if you like.</h4><ha-form-customize-attributes attributes="{{existingAttributes}}"></ha-form-customize-attributes></template><template is="dom-if" if="[[hasNewAttributes]]"><h4 class="attributes-text">The following attributes weren't set. Set them if you like.</h4><ha-form-customize-attributes attributes="{{newAttributes}}"></ha-form-customize-attributes></template><div class="form-group"><paper-dropdown-menu label="Pick an attribute to override" class="flex" dynamic-align=""><paper-listbox slot="dropdown-content" selected="{{selectedNewAttribute}}"><template is="dom-repeat" items="[[newAttributesOptions]]" as="option"><paper-item>[[option]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></template></dom-module><script>class HaFormCustomize extends Polymer.Element{static get is(){return"ha-form-customize"}static get properties(){return{hass:{type:Object},entity:Object,localAttributes:{type:Array,computed:"computeLocalAttributes(localConfig)"},hasLocalAttributes:Boolean,globalAttributes:{type:Array,computed:"computeGlobalAttributes(localConfig, globalConfig)"},hasGlobalAttributes:Boolean,existingAttributes:{type:Array,computed:"computeExistingAttributes(localConfig, globalConfig, entity)"},hasExistingAttributes:Boolean,newAttributes:{type:Array,value:[]},hasNewAttributes:Boolean,newAttributesOptions:Array,selectedNewAttribute:{type:Number,value:-1,observer:"selectedNewAttributeObserver"},localConfig:Object,globalConfig:Object}}static get observers(){return["attributesObserver(localAttributes.*, globalAttributes.*, existingAttributes.*, newAttributes.*)"]}_initOpenObject(t,e,i,s){return Object.assign({attribute:t,value:e,closed:!1,domain:window.hassUtil.computeDomain(this.entity),secondary:i,description:t},s)}loadEntity(t){return this.entity=t,this.hass.callApi("GET","config/customize/config/"+t.entity_id).then(t=>{this.localConfig=t.local,this.globalConfig=t.global,this.newAttributes=[]})}saveEntity(){const t={};this.localAttributes.concat(this.globalAttributes,this.existingAttributes,this.newAttributes).forEach(e=>{if(e.closed||e.secondary||!e.attribute||!e.value)return;const i="json"===e.type?JSON.parse(e.value):e.value;i&&(t[e.attribute]=i)});const e=this.entity.entity_id;return this.hass.callApi("POST","config/customize/config/"+e,t)}_computeSingleAttribute(t,e,i){const s=window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES[t]||{type:window.hassAttributeUtil.UNKNOWN_TYPE};return this._initOpenObject(t,"json"===s.type?JSON.stringify(e):e,i,s)}_computeAttributes(t,e,i){return e.map(e=>this._computeSingleAttribute(e,t[e],i))}computeLocalAttributes(t){if(!t)return[];const e=Object.keys(t);return this._computeAttributes(t,e,!1)}computeGlobalAttributes(t,e){if(!t||!e)return[];const i=Object.keys(t),s=Object.keys(e).filter(t=>!i.includes(t));return this._computeAttributes(e,s,!0)}computeExistingAttributes(t,e,i){if(!t||!e||!i)return[];const s=Object.keys(t),r=Object.keys(e),u=Object.keys(i.attributes).filter(t=>!s.includes(t)&&!r.includes(t));return this._computeAttributes(i.attributes,u,!0)}computeShowWarning(t,e){return!(!t||!e)&&Object.keys(t).some(i=>JSON.stringify(e[i])!==JSON.stringify(t[i]))}filterFromAttributes(t){return e=>!t||t.every(t=>t.attribute!==e||t.closed)}getNewAttributesOptions(t,e,i,s){return Object.keys(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES).filter(t=>{const e=window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES[t];return e&&(!e.domains||!this.entity||e.domains.includes(window.hassUtil.computeDomain(this.entity)))}).filter(this.filterFromAttributes(t)).filter(this.filterFromAttributes(e)).filter(this.filterFromAttributes(i)).filter(this.filterFromAttributes(s)).sort().concat("Other")}selectedNewAttributeObserver(t){if(t<0)return;const e=this.newAttributesOptions[t];if(t===this.newAttributesOptions.length-1){const t=this._initOpenObject("","",!1,{type:window.hassAttributeUtil.ADD_TYPE});return this.push("newAttributes",t),void(this.selectedNewAttribute=-1)}let i=this.localAttributes.findIndex(t=>t.attribute===e);if(i>=0)return this.set("localAttributes."+i+".closed",!1),void(this.selectedNewAttribute=-1);if((i=this.globalAttributes.findIndex(t=>t.attribute===e))>=0)return this.set("globalAttributes."+i+".closed",!1),void(this.selectedNewAttribute=-1);if((i=this.existingAttributes.findIndex(t=>t.attribute===e))>=0)return this.set("existingAttributes."+i+".closed",!1),void(this.selectedNewAttribute=-1);if((i=this.newAttributes.findIndex(t=>t.attribute===e))>=0)return this.set("newAttributes."+i+".closed",!1),void(this.selectedNewAttribute=-1);const s=this._computeSingleAttribute(e,"",!1);this.push("newAttributes",s),this.selectedNewAttribute=-1}attributesObserver(){this.hasLocalAttributes=this.localAttributes&&this.localAttributes.some(t=>!t.closed),this.hasGlobalAttributes=this.globalAttributes&&this.globalAttributes.some(t=>!t.closed),this.hasExistingAttributes=this.existingAttributes&&this.existingAttributes.some(t=>!t.closed),this.hasNewAttributes=this.newAttributes&&this.newAttributes.some(t=>!t.closed),this.newAttributesOptions=this.getNewAttributesOptions(this.localAttributes,this.globalAttributes,this.existingAttributes,this.newAttributes)}}customElements.define(HaFormCustomize.is,HaFormCustomize);</script><dom-module id="ha-entity-config"><template><style include="iron-flex ha-style">paper-card{display:block;}.device-picker{@apply --layout-horizontal;padding-bottom:24px;}.form-placeholder{@apply --layout-vertical;@apply --layout-center-center;height:96px;}[hidden]:{display:none;};.card-actions{@apply --layout-horizontal;@apply --layout-justified;}</style><paper-card><div class="card-content"><div class="device-picker"><paper-dropdown-menu label="[[label]]" class="flex" disabled="[[!entities.length]]"><paper-listbox slot="dropdown-content" selected="{{selectedEntity}}"><template is="dom-repeat" items="[[entities]]" as="state"><paper-item>[[computeSelectCaption(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><div class="form-container"><template is="dom-if" if="[[computeShowPlaceholder(formState)]]"><div class="form-placeholder"><template is="dom-if" if="[[computeShowNoDevices(formState)]]">No entities found! :-(</template><template is="dom-if" if="[[computeShowSpinner(formState)]]"><paper-spinner active="" alt="[[formState]]"></paper-spinner>[[formState]]</template></div></template><div hidden$="[[!computeShowForm(formState)]]" id="form"></div></div></div><div class="card-actions"><paper-button on-click="saveEntity" disabled="[[computeShowPlaceholder(formState)]]">SAVE</paper-button><template is="dom-if" if="[[allowDelete]]"><paper-button class="warning" on-click="deleteEntity" disabled="[[computeShowPlaceholder(formState)]]">DELETE</paper-button></template></div></paper-card></template></dom-module><script>class HaEntityConfig extends Polymer.Element{static get is(){return"ha-entity-config"}static get properties(){return{hass:{type:Object,observer:"hassChanged"},label:{type:String,value:"Device"},entities:{type:Array,observer:"entitiesChanged"},allowDelete:{type:Boolean,value:!1},selectedEntity:{type:Number,value:-1,observer:"entityChanged"},formState:{type:String,value:"no-devices"},config:{type:Object}}}connectedCallback(){super.connectedCallback(),this.formEl=document.createElement(this.config.component),this.formEl.hass=this.hass,this.$.form.appendChild(this.formEl),this.entityChanged(this.selectedEntity)}computeSelectCaption(t){return this.config.computeSelectCaption?this.config.computeSelectCaption(t):window.hassUtil.computeStateName(t)}computeShowNoDevices(t){return"no-devices"===t}computeShowSpinner(t){return"loading"===t||"saving"===t}computeShowPlaceholder(t){return"editing"!==t}computeShowForm(t){return"editing"===t}hassChanged(t){this.formEl&&(this.formEl.hass=t)}entitiesChanged(t,e){if(0!==t.length)if(e){var i=e[this.selectedEntity].entity_id,n=t.findIndex(function(t){return t.entity_id===i});-1===n?this.selectedEntity=0:n!==this.selectedEntity&&(this.selectedEntity=n)}else this.selectedEntity=0;else this.formState="no-devices"}entityChanged(t){if(this.entities&&this.formEl){var e=this.entities[t];if(e){this.formState="loading";var i=this;this.formEl.loadEntity(e).then(function(){i.formState="editing"})}}}saveEntity(){this.formState="saving";var t=this;this.formEl.saveEntity().then(function(){t.formState="editing"})}}customElements.define(HaEntityConfig.is,HaEntityConfig);</script><dom-module id="ha-config-customize" assetpath="customize/"><template><style include="ha-style"></style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="_backTapped"></paper-icon-button><div main-title="">[[localize('ui.panel.config.customize.caption')]]</div></app-toolbar></app-header><div class$="[[computeClasses(isWide)]]"><ha-config-section is-wide="[[isWide]]"><span slot="header">Customization</span> <span slot="introduction">Tweak per-entity attributes.<br>Added/edited customizations will take effect immediately. Removed customizations will take effect when the entity is updated.</span><ha-entity-config hass="[[hass]]" label="Entity" entities="[[entities]]" config="[[entityConfig]]"></ha-entity-config></ha-config-section></div></app-header-layout></template></dom-module><script>class HaConfigCustomize extends(window.hassMixins.LocalizeMixin(Polymer.Element)){static get is(){return"ha-config-customize"}static get properties(){return{hass:Object,isWide:Boolean,entities:{type:Array,computed:"computeEntities(hass)"},entityConfig:{type:Object,value:{component:"ha-form-customize",computeSelectCaption:t=>window.hassUtil.computeStateName(t)+" ("+window.hassUtil.computeDomain(t)+")"}}}}computeClasses(t){return t?"content":"content narrow"}_backTapped(){history.back()}computeEntities(t){return Object.keys(t.states).map(e=>t.states[e]).sort(window.hassUtil.sortByName)}}customElements.define(HaConfigCustomize.is,HaConfigCustomize);</script><dom-module id="ha-form" assetpath="config-entries/"><template><style>.error{color:red;}</style><template is="dom-if" if="[[_isArray(schema)]]" restamp=""><template is="dom-repeat" items="[[schema]]"><ha-form data="[[_getValue(data, item)]]" schema="[[item]]" error="[[_getValue(error, item)]]" on-data-changed="_valueChanged"></ha-form></template></template><template is="dom-if" if="[[!_isArray(schema)]]" restamp=""><template is="dom-if" if="[[error]]"><div class="error">[[error]]</div></template><template is="dom-if" if="[[_equals(schema.type, &quot;string&quot;)]]" restamp=""><paper-input label="[[schema.name]]" value="{{data}}"></paper-input></template><template is="dom-if" if="[[_equals(schema.type, &quot;integer&quot;)]]" restamp=""><template is="dom-if" if="[[_isRange(schema)]]" restamp=""><div>[[schema.name]]<paper-slider pin="" value="{{data}}" min="[[schema.valueMin]]" max="[[schema.valueMax]]"></paper-slider></div></template><template is="dom-if" if="[[!_isRange(schema)]]" restamp=""><paper-input label="[[schema.name]]" value="{{data}}" type="number"></paper-input></template></template><template is="dom-if" if="[[_equals(schema.type, &quot;float&quot;)]]" restamp=""><paper-input label="[[schema.name]]" value="{{data}}"></paper-input></template><template is="dom-if" if="[[_equals(schema.type, &quot;boolean&quot;)]]" restamp=""><paper-checkbox checked="{{data}}">[[schema.name]]</paper-checkbox></template><template is="dom-if" if="[[_equals(schema.type, &quot;select&quot;)]]" restamp=""><paper-dropdown-menu label="[[schema.name]]"><paper-listbox slot="dropdown-content" attr-for-selected="item-name" selected="{{data}}"><template is="dom-repeat" items="[[schema.options]]"><paper-item item-name="[[item]]">[[item]]</paper-item></template></paper-listbox></paper-dropdown-menu></template></template></template></dom-module><script>class HaForm extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-form"}static get properties(){return{data:{type:Object,notify:!0},schema:Object,error:Object}}_isArray(e){return Array.isArray(e)}_isRange(e){return"valueMin"in e&&"valueMax"in e}_equals(e,t){return e===t}_getValue(e,t){return e[t.name]}_valueChanged(e){this.set(["data",e.model.item.name],e.detail.value)}}customElements.define(HaForm.is,HaForm);</script><dom-module id="ha-config-flow" assetpath="config-entries/"><template><style include="ha-style-dialog">.error{color:red;}paper-dialog{max-width:500px;}ha-markdown img:first-child:last-child{display:block;margin:0 auto;}</style><paper-dialog id="dialog" with-backdrop="" opened="[[step]]" on-opened-changed="_openedChanged"><h2><template is="dom-if" if="[[_equals(step.type, &quot;abort&quot;)]]">Aborted</template><template is="dom-if" if="[[_equals(step.type, &quot;create_entry&quot;)]]">Success!</template><template is="dom-if" if="[[_equals(step.type, &quot;form&quot;)]]">[[step.title]]</template></h2><paper-dialog-scrollable><template is="dom-if" if="[[!step]]">Loading flow.</template><template is="dom-if" if="[[step]]"><template is="dom-if" if="[[_equals(step.type, &quot;abort&quot;)]]"><p>[[step.reason]]</p></template><template is="dom-if" if="[[_equals(step.type, &quot;create_entry&quot;)]]"><p>Created config for [[step.title]]</p></template><template is="dom-if" if="[[_equals(step.type, &quot;form&quot;)]]"><template is="dom-if" if="[[step.description]]"><ha-markdown content="[[step.description]]"></ha-markdown></template><template is="dom-if" if="[[step.errors.base]]"><div class="error">[[step.errors.base]]</div></template><ha-form data="{{stepData}}" schema="[[step.data_schema]]" error="[[step.errors]]"></ha-form></template></template></paper-dialog-scrollable><div class="buttons"><template is="dom-if" if="[[_equals(step.type, &quot;abort&quot;)]]"><paper-button on-click="_flowDone">Close</paper-button></template><template is="dom-if" if="[[_equals(step.type, &quot;create_entry&quot;)]]"><paper-button on-click="_flowDone">Close</paper-button></template><template is="dom-if" if="[[_equals(step.type, &quot;form&quot;)]]"><paper-button on-click="_submitStep">Submit</paper-button></template></div></paper-dialog></template></dom-module><script>class HaConfigFlow extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-config-flow"}static get properties(){return{hass:Object,step:{type:Object,notify:!0},flowId:{type:String,observer:"_flowIdChanged"},stepData:Object}}ready(){super.ready(),this.addEventListener("keypress",e=>{13===e.keyCode&&this._submitStep()}),this.$.dialog.addEventListener("iron-overlay-opened",e=>{e.target.withBackdrop&&e.target.parentNode.insertBefore(e.target.backdropElement,e.target)})}_flowIdChanged(e){e?this.step?this._processStep(this.step):this.hass.callApi("get",`config/config_entries/flow/${e}`).then(e=>{this._processStep(e),setTimeout(()=>this.$.dialog.center(),0)}):this.setProperties({step:null,stepData:{}})}_submitStep(){this.hass.callApi("post",`config/config_entries/flow/${this.flowId}`,this.stepData).then(e=>this._processStep(e))}_processStep(e){e.errors||(e.errors={}),this.step=e,0===Object.keys(e.errors).length&&(this.stepData={})}_flowDone(){this.fire("flow-closed",{flowFinished:!0})}_equals(e,t){return e===t}_openedChanged(e){this.step&&!e.detail.value&&this.fire("flow-closed",{flowFinished:["success","abort"].includes(this.step.type)})}}customElements.define(HaConfigFlow.is,HaConfigFlow);</script><dom-module id="ha-config-entries" assetpath="config-entries/"><template><style include="iron-flex ha-style">.content{padding:8px;}.entries{margin:0 -4px;}.entries paper-card{margin:4px;}</style><hass-subpage title="Integrations"><div class="content"><h1>Configured</h1><template is="dom-if" if="[[!_entries.length]]"><i>Nothing configured.</i></template><div class="entries layout horizontal wrap"><template is="dom-repeat" items="[[_entries]]"><paper-card heading="[[item.title]]"><div class="card-content">Integration: [[item.domain]]<br>State: [[item.state]]<br>Added by: [[item.source]]</div><div class="card-actions"><paper-button on-click="_removeEntry">Remove</paper-button></div></paper-card></template></div><template is="dom-if" if="[[_progress.length]]"><h1>To be finished</h1><div class="entries layout horizontal wrap"><template is="dom-repeat" items="[[_progress]]"><paper-card heading="[[item.domain]]"><div class="card-actions"><paper-button on-click="_continueFlow">Configure</paper-button></div></paper-card></template></div></template><h1>Add integration</h1><div class="entries layout horizontal wrap"><template is="dom-repeat" items="[[_handlers]]"><paper-card heading="[[item]]"><div class="card-actions"><paper-button on-click="_createFlow">Configure</paper-button></div></paper-card></template></div></div></hass-subpage><ha-config-flow hass="[[hass]]" flow-id="[[_flowId]]" step="{{_flowStep}}" on-flow-closed="_flowClose"></ha-config-flow></template></dom-module><script>{class e extends(window.hassMixins.NavigateMixin(Polymer.Element)){static get is(){return"ha-config-entries"}static get properties(){return{hass:Object,_flowId:{type:String,value:null},_flowStep:Object,_entries:Array,_progress:Array,_handlers:Array}}ready(){super.ready(),this._loadData()}_createFlow(e){this.hass.callApi("post","config/config_entries/flow",{domain:e.model.item}).then(e=>{this._userCreatedFlow=!0,this.setProperties({_flowStep:e,_flowId:e.flow_id})})}_continueFlow(e){this._userCreatedFlow=!1,this.setProperties({_flowId:e.model.item.flow_id,_flowStep:null})}_removeEntry(e){if(!confirm("Are you sure you want to delete this integration?"))return;const t=e.model.item.entry_id;this.hass.callApi("delete",`config/config_entries/entry/${t}`).then(e=>{this._entries=this._entries.filter(e=>e.entry_id!==t),e.require_restart&&alert("Restart Home Assistant to finish removing this integration")})}_flowClose(e){e.detail.flowFinished?this._loadData():this._userCreatedFlow&&this.hass.callApi("delete",`config/config_entries/flow/${this._flowId}`),this._flowId=null}_loadData(){this._loadEntries(),this._loadDiscovery(),this.hass.callApi("get","config/config_entries/flow_handlers").then(e=>{this._handlers=e})}_loadEntries(){this.hass.callApi("get","config/config_entries/entry").then(e=>{this._entries=e})}_loadDiscovery(){this.hass.callApi("get","config/config_entries/flow").then(e=>{this._progress=e})}}customElements.define(e.is,e)}</script></div><dom-module id="ha-panel-config"><template><app-route route="[[route]]" pattern="/:page" data="{{_routeData}}"></app-route><iron-media-query query="(min-width: 1040px)" query-matches="{{wide}}"></iron-media-query><iron-media-query query="(min-width: 1296px)" query-matches="{{wideSidebar}}"></iron-media-query><template is="dom-if" if="[[_equals(_routeData.page, &quot;core&quot;)]]" restamp=""><ha-config-core page-name="core" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-core></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;cloud&quot;)]]" restamp=""><ha-config-cloud page-name="cloud" route="[[route]]" hass="[[hass]]" is-wide="[[isWide]]" account="[[account]]"></ha-config-cloud></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;dashboard&quot;)]]"><ha-config-dashboard page-name="dashboard" hass="[[hass]]" is-wide="[[isWide]]" account="[[account]]" narrow="[[narrow]]" show-menu="[[showMenu]]"></ha-config-dashboard></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;automation&quot;)]]" restamp=""><ha-config-automation page-name="automation" route="[[route]]" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-automation></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;script&quot;)]]" restamp=""><ha-config-script page-name="script" route="[[route]]" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-script></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;zwave&quot;)]]" restamp=""><ha-config-zwave page-name="zwave" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-zwave></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;customize&quot;)]]" restamp=""><ha-config-customize page-name="customize" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-customize></template><template is="dom-if" if="[[_equals(_routeData.page, &quot;integrations&quot;)]]" restamp=""><ha-config-entries page-name="integrations" hass="[[hass]]"></ha-config-entries></template></template></dom-module><script>class HaPanelConfig extends(window.hassMixins.NavigateMixin(Polymer.Element)){static get is(){return"ha-panel-config"}static get properties(){return{hass:Object,narrow:Boolean,showMenu:Boolean,account:Object,route:{type:Object,observer:"_routeChanged"},_routeData:Object,wide:Boolean,wideSidebar:Boolean,isWide:{type:Boolean,computed:"computeIsWide(showMenu, wideSidebar, wide)"}}}ready(){super.ready(),window.hassUtil.isComponentLoaded(this.hass,"cloud")&&this.hass.callApi("get","cloud/account").then(e=>{this.account=e}),this.addEventListener("ha-account-refreshed",e=>{this.account=e.detail.account})}computeIsWide(e,t,a){return e?t:a}_routeChanged(e){""===e.path&&"/config"===e.prefix&&this.navigate("/config/dashboard",!0)}_equals(e,t){return e===t}}customElements.define(HaPanelConfig.is,HaPanelConfig);</script></body></html>