<html><head></head><body><div hidden="" by-polymer-bundler=""><dom-module id="ha-config-section"><template><style include="iron-flex ha-style">.content{padding:28px 20px 0;max-width:1040px;margin:0 auto;}.header{@apply (--paper-font-display1);opacity:var(--dark-primary-opacity);}.together{margin-top:32px;}.intro{@apply (--paper-font-subhead);width:100%;max-width:400px;margin-right:40px;opacity:var(--dark-primary-opacity);}.panel{margin-top:-24px;}.panel ::slotted(*){margin-top:24px;display:block;}.narrow.content{max-width:640px;}.narrow .together{margin-top:20px;}.narrow .header{@apply (--paper-font-headline);}.narrow .intro{font-size:14px;padding-bottom:20px;margin-right:0;max-width:500px;}</style><div class$="[[computeContentClasses(isWide)]]"><div class="header"><slot name="header"></slot></div><div class$="[[computeClasses(isWide)]]"><div class="intro"><slot name="introduction"></slot></div><div class="flex panel"><slot></slot></div></div></div></template></dom-module><script>class HaConfigSection extends Polymer.Element{static get is(){return"ha-config-section"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},isWide:{type:Boolean,value:!1}}}computeContentClasses(e){return e?"content ":"content narrow"}computeClasses(e){return"together layout "+(e?"horizontal":"vertical narrow")}}customElements.define(HaConfigSection.is,HaConfigSection);</script><dom-module id="ha-config-navigation" assetpath="dashboard/"><template><style include="iron-flex">paper-card{display:block;}paper-item{cursor:pointer;}</style><paper-card><template is="dom-repeat" items="[[pages]]"><template is="dom-if" if="[[_computeLoaded(hass, item)]]"><paper-item on-tap="_navigate"><paper-item-body two-line="">[[_computeCaption(item)]]<div secondary="">[[_computeDescription(item)]]</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></template></template></paper-card></template></dom-module><script>class HaConfigNavigation extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-config-navigation"}static get properties(){return{hass:{type:Object},pages:{type:Array,value:[{domain:"core",caption:"General",description:"Validate your configuration file and control the server.",loaded:!0},{domain:"customize",caption:"Customization",description:"Customize your entities.",loaded:!0},{domain:"automation",caption:"Automation",description:"Create and edit automations."},{domain:"script",caption:"Script",description:"Create and edit scripts."},{domain:"zwave",caption:"Z-Wave",description:"Manage your Z-Wave network."}]}}}_computeLoaded(i,t){return t.loaded||window.hassUtil.isComponentLoaded(i,t.domain)}_computeCaption(i){return i.caption}_computeDescription(i){return i.description}_navigate(i){history.pushState(null,null,"/config/"+i.model.item.domain),this.fire("location-changed")}}customElements.define(HaConfigNavigation.is,HaConfigNavigation);</script><dom-module id="ha-config-cloud-menu" assetpath="dashboard/"><template><style include="iron-flex">paper-card{display:block;}paper-item{cursor:pointer;}</style><paper-card><paper-item on-tap="_navigate"><paper-item-body two-line="">Home Assistant Cloud<template is="dom-if" if="[[account]]"><div secondary="">Logged in as [[account.email]]</div></template><template is="dom-if" if="[[!account]]"><div secondary="">Not logged in</div></template></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></paper-card></template></dom-module><script>class HaConfigCloudMenu extends(window.hassMixins.NavigateMixin(Polymer.Element)){static get is(){return"ha-config-cloud-menu"}static get properties(){return{hass:Object,isWide:Boolean,account:Object}}_navigate(){this.navigate("/config/cloud")}}customElements.define(HaConfigCloudMenu.is,HaConfigCloudMenu);</script><dom-module id="ha-config-dashboard" assetpath="dashboard/"><template><style include="iron-flex ha-style">.content{padding-bottom:32px;}</style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><ha-menu-button narrow="[[narrow]]" show-menu="[[showMenu]]"></ha-menu-button><div main-title="">Configuration</div></app-toolbar></app-header><div class="content"><ha-config-section is-wide="[[isWide]]"><span slot="header">Configure Home Assistant</span> <span slot="introduction">Here it is possible to configure your components and Home Assistant. Not everything is possible to configure from the UI yet, but we're working on it.</span><template is="dom-if" if="[[computeIsCloudLoaded(hass)]]"><ha-config-cloud-menu hass="[[hass]]" account="[[account]]"></ha-config-cloud-menu></template><ha-config-navigation hass="[[hass]]"></ha-config-navigation></ha-config-section></div></app-header-layout></template></dom-module><script>class HaConfigDashboard extends Polymer.Element{static get is(){return"ha-config-dashboard"}static get properties(){return{hass:Object,isWide:Boolean,account:Object,narrow:Boolean,showMenu:Boolean}}computeIsCloudLoaded(o){return window.hassUtil.isComponentLoaded(o,"cloud")}}customElements.define(HaConfigDashboard.is,HaConfigDashboard);</script><dom-module id="ha-config-section-core" assetpath="core/"><template><style include="iron-flex ha-style">.validate-container{@apply (--layout-vertical);@apply (--layout-center-center);height:140px;}.validate-result{color:var(--google-green-500);font-weight:500;margin-bottom:1em;}.config-invalid{margin:1em 0;}.config-invalid .text{color:var(--google-red-500);font-weight:500;}.config-invalid paper-button{float:right;}.validate-log{white-space:pre-wrap;}</style><ha-config-section is-wide="[[isWide]]"><span slot="header">Configuration and Server Control</span> <span slot="introduction">Changing your configuration can be a tiresome process. We know. This section will try to make your life a little bit easier.</span><paper-card heading="Configuration Validation"><div class="card-content">Validate your configuration if you recently made some changes to your configuration and want to make sure that it is all valid.<template is="dom-if" if="[[!validateLog]]"><div class="validate-container"><template is="dom-if" if="[[!validating]]"><div class="validate-result" id="result">[[validateResult]]</div><paper-button raised="" on-tap="validateConfig">check config</paper-button></template><template is="dom-if" if="[[validating]]"><paper-spinner active=""></paper-spinner></template></div></template><template is="dom-if" if="[[validateLog]]"><div class="config-invalid"><span class="text">Configuration invalid.</span><paper-button raised="" on-tap="validateConfig">check config</paper-button></div><div id="configLog" class="validate-log">[[validateLog]]</div></template></div></paper-card><paper-card heading="Configuration Reloading"><div class="card-content">Some parts of Home Assistant can reload without requiring a restart. Hitting reload will unload their current configuration and load the new one.</div><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="homeassistant" service="reload_core_config">Reload Core</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="group" service="reload" hidden$="[[!groupLoaded(hass)]]">Reload Groups</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="automation" service="reload" hidden$="[[!automationLoaded(hass)]]">Reload Automation</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="script" service="reload" hidden$="[[!scriptLoaded(hass)]]">Reload Scripts</ha-call-service-button></div></paper-card><paper-card heading="Server Management"><div class="card-content">Control your Home Assistant serverâ€¦ from Home Assistant.</div><div class="card-actions warning"><ha-call-service-button class="warning" hass="[[hass]]" domain="homeassistant" service="restart">Restart</ha-call-service-button><ha-call-service-button class="warning" hass="[[hass]]" domain="homeassistant" service="stop">Stop</ha-call-service-button></div></paper-card></ha-config-section></template></dom-module><script>class HaConfigSectionCore extends Polymer.Element{static get is(){return"ha-config-section-core"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean,value:!1},validating:{type:Boolean,value:!1},validateResult:{type:String,value:""},validateLog:{type:String,value:""}}}groupLoaded(e){return window.hassUtil.isComponentLoaded(e,"group")}automationLoaded(e){return window.hassUtil.isComponentLoaded(e,"automation")}scriptLoaded(e){return window.hassUtil.isComponentLoaded(e,"script")}validateConfig(){this.validating=!0,this.validateLog="",this.validateResult="";var e=this;this.hass.callApi("POST","config/core/check_config").then(function(t){e.validating=!1;(e.configValid="valid"===t.result)?e.validateResult="Valid!":e.validateLog=t.errors})}}customElements.define(HaConfigSectionCore.is,HaConfigSectionCore);</script><dom-module id="ha-config-section-hassbian" assetpath="core/"><template><style include="iron-flex ha-style">.header{font-size:16px;margin-bottom:1em;}.header .status{font-size:14px;float:right;}.card-actions paper-button{color:var(--default-primary-color);font-weight:500;}</style><ha-config-section is-wide="[[isWide]]"><span slot="header">Bring Hassbian to the next level</span> <span slot="introduction">Discover exciting add-ons to enhance your Home Assistant installation. Add an MQTT server or control a connected TV via HDMI-CEC.</span><template is="dom-if" if="[[suiteStatus]]"><template is="dom-repeat" items="[[computeSuiteKeys(suiteStatus)]]" as="suiteKey"><paper-card><div class="card-content"><div class="header">[[computeTitle(suiteKey)]] <span class="status">[[computeSuiteStatus(suiteStatus, suiteKey)]]</span></div>[[computeSuiteDescription(suiteStatus, suiteKey)]]</div><div class="card-actions"><paper-button on-tap="suiteMoreInfoTapped">LEARN MORE</paper-button><template is="dom-if" if="[[computeShowInstall(suiteStatus, suiteKey)]]"><paper-button on-tap="suiteActionTapped">INSTALL</paper-button></template></div></paper-card></template></template></ha-config-section></template></dom-module><script>class HaConfigSectionHassbian extends Polymer.Element{static get is(){return"ha-config-section-hassbian"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean},suiteStatus:{type:Object,value:null}}}updateStatus(){this.hass.callApi("GET","config/hassbian/suites").then(function(t){this.suiteStatus=t;for(var e=!1,s=Object.keys(t),a=0;a<s.length;a++)if("installing"===t[s[a]].state){e=!0;break}e&&setTimeout(()=>this.updateStatus(),5e3)}.bind(this))}connectedCallback(){super.connectedCallback(),this.updateStatus=this.updateStatus.bind(this),this.updateStatus()}computeSuiteKeys(t){return Object.keys(t).sort(function(e,s){var a="installing"===t[e].state,i="installing"===t[s].state;if(a&&i);else{if(a)return-1;if(i)return 1}return e<s?-1:e>s?1:0})}computeSuiteDescription(t,e){return t[e].description}computeTitle(t){return t.substr(0,1).toUpperCase()+t.substr(1)}computeSuiteStatus(t,e){var s=t[e].state.replace(/_/," ");return s.substr(0,1).toUpperCase()+s.substr(1)}computeShowStatus(t,e){var s=t[e].state;return"installing"!==s&&"not_installed"!==s}computeShowInstall(t,e){return"not_installed"===t[e].state}suiteMoreInfoTapped(){}suiteActionTapped(){this.hass.callApi("POST","config/hassbian/suites/openzwave/install").then(this.updateStatus)}}customElements.define(HaConfigSectionHassbian.is,HaConfigSectionHassbian);</script><dom-module id="ha-config-section-translation" assetpath="core/"><template><ha-config-section is-wide="[[isWide]]"><span slot="header">Choose a Language</span> <span slot="introduction">Choose a language for the Home Assistant interface on this device.</span><paper-card><div class="card-content"><paper-dropdown-menu label="Language" dynamic-align=""><paper-listbox slot="dropdown-content" on-selected-item-changed="handleLanguageSelect" attr-for-selected="language-tag" selected="[[language]]"><template is="dom-repeat" items="[[languages]]"><paper-item language-tag="[[item.tag]]">[[item.nativeName]]</paper-item></template></paper-listbox>&gt;</paper-dropdown-menu></div></paper-card></ha-config-section></template></dom-module><script>class HaConfigSectionTranslation extends(window.hassMixins.LocalizeMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-config-section-translation"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean},languages:{type:Array,computed:"computeLanguages(hass)"}}}computeLanguages(a){return a&&a.translationMetadata?Object.keys(a.translationMetadata).map(e=>({tag:e,nativeName:a.translationMetadata[e].nativeName})):[]}handleLanguageSelect(a){a.detail.value&&a.detail.value.languageTag!==this.language&&this.fire("hass-language-select",{language:a.detail.value.languageTag})}}customElements.define(HaConfigSectionTranslation.is,HaConfigSectionTranslation);</script><dom-module id="ha-config-section-themes" assetpath="core/"><template><ha-config-section is-wide="[[isWide]]"><span slot="header">Set a theme</span> <span slot="introduction">Choose 'Backend-selected' to use whatever theme the backend chooses or pick a theme for this device.</span><paper-card><div class="card-content"><paper-dropdown-menu label="Theme" dynamic-align=""><paper-listbox slot="dropdown-content" selected="{{selectedTheme}}"><template is="dom-repeat" items="[[themes]]" as="theme"><paper-item>[[theme]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></paper-card></ha-config-section></template></dom-module><script>class HaConfigSectionThemes extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-config-section-themes"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean},themes:{type:Array,computed:"computeThemes(hass)"},selectedTheme:{type:Number}}}static get observers(){return["selectionChanged(hass, selectedTheme)"]}ready(){super.ready(),this.hass.selectedTheme&&this.themes.indexOf(this.hass.selectedTheme)>0?this.selectedTheme=this.themes.indexOf(this.hass.selectedTheme):this.hass.selectedTheme||(this.selectedTheme=0)}computeThemes(e){return e?["Backend-selected","default"].concat(Object.keys(e.themes.themes).sort()):[]}selectionChanged(e,s){s>0&&s<this.themes.length?e.selectedTheme!==this.themes[s]&&this.fire("settheme",this.themes[s]):0===s&&""!==e.selectedTheme&&this.fire("settheme","")}}customElements.define(HaConfigSectionThemes.is,HaConfigSectionThemes);</script><dom-module id="ha-config-core" assetpath="core/"><template><style include="iron-flex ha-style">.content{padding-bottom:32px;}.border{margin:32px auto 0;border-bottom:1px solid rgba(0, 0, 0, 0.12);max-width:1040px;}.narrow .border{max-width:640px;}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="_backTapped"></paper-icon-button><div main-title="">General</div></app-toolbar></app-header><div class$="[[computeClasses(isWide)]]"><ha-config-section-core is-wide="[[isWide]]" hass="[[hass]]"></ha-config-section-core><template is="dom-if" if="[[computeIsTranslationLoaded(hass)]]"><div class="border"></div><ha-config-section-translation is-wide="[[isWide]]" hass="[[hass]]"></ha-config-section-translation></template><template is="dom-if" if="[[computeIsThemesLoaded(hass)]]"><div class="border"></div><ha-config-section-themes is-wide="[[isWide]]" hass="[[hass]]"></ha-config-section-themes></template><template is="dom-if" if="[[computeIsHassbianLoaded(hass)]]"><div class="border"></div><ha-config-section-hassbian is-wide="[[isWide]]" hass="[[hass]]"></ha-config-section-hassbian></template></div></ha-app-layout></template></dom-module><script>class HaConfigCore extends Polymer.Element{static get is(){return"ha-config-core"}static get properties(){return{hass:Object,isWide:Boolean}}computeClasses(e){return e?"content":"content narrow"}computeIsHassbianLoaded(e){return window.hassUtil.isComponentLoaded(e,"config.hassbian")}computeIsZwaveLoaded(e){return window.hassUtil.isComponentLoaded(e,"config.zwave")}computeIsTranslationLoaded(e){return e.translationMetadata&&Object.keys(e.translationMetadata).length}computeIsThemesLoaded(e){return e.themes&&e.themes.themes&&Object.keys(e.themes.themes).length}_backTapped(){history.back()}}customElements.define(HaConfigCore.is,HaConfigCore);</script><dom-module id="hass-subpage" assetpath="../../src/layouts/"><template><style include="ha-style"></style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="_backTapped"></paper-icon-button><div main-title="">[[title]]</div></app-toolbar></app-header><slot></slot></app-header-layout></template></dom-module><script>class HassSubpage extends Polymer.Element{static get is(){return"hass-subpage"}static get properties(){return{title:String}}_backTapped(){history.back()}}customElements.define(HassSubpage.is,HassSubpage);</script><dom-module id="ha-config-cloud-login" assetpath="cloud/"><template><style include="iron-flex ha-style">.content{padding-bottom:24px;}paper-card{display:block;}paper-item{cursor:pointer;}paper-card:last-child{margin-top:24px;}h1{@apply (--paper-font-headline);margin:0;}.error{color:var(--google-red-500);}.card-actions{display:flex;justify-content:space-between;align-items:center;}[hidden]{display:none;}</style><hass-subpage title="Cloud Login"><div class="content"><ha-config-section is-wide="[[isWide]]"><span slot="header">Home Assistant Cloud</span> <span slot="introduction">The Home Assistant Cloud allows your local Home Assistant instance to connect with cloud-only services like Amazon Alexa.</span><paper-card><div class="card-content"><h1>Sign In</h1><paper-input label="Email" id="emailInput" type="email" value="{{email}}" on-keydown="_keyDown"></paper-input><paper-input label="Password" value="{{_password}}" type="password" on-keydown="_keyDown"></paper-input><div class="error" hidden$="[[!error]]">[[error]]</div></div><div class="card-actions"><ha-progress-button on-tap="_handleLogin" progress="[[_requestInProgress]]">Sign in</ha-progress-button><button class="link" hidden="[[_requestInProgress]]" on-click="_handleForgotPassword">forgot password?</button></div></paper-card><paper-card><paper-item on-tap="_handleRegister"><paper-item-body two-line="">Create Account<div secondary="">Get up and running quickly.</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></paper-card></ha-config-section></div></hass-subpage></template></dom-module><script>class HaConfigCloudLogin extends(window.hassMixins.NavigateMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-config-cloud-login"}static get properties(){return{hass:Object,isWide:Boolean,email:{type:String,notify:!0},_password:{type:String,value:""},_requestInProgress:{type:Boolean,value:!1}}}static get observers(){return["_inputChanged(email, _password)"]}_inputChanged(){this.error=!1}_keyDown(e){13===e.keyCode&&(this._handleLogin(),e.preventDefault())}_handleLogin(){this.email?this._password||(this.error="Password is required."):this.error="Email is required.",this.error||(this._requestInProgress=!0,this.hass.callApi("post","cloud/login",{email:this.email,password:this._password}).then(e=>{this.fire("ha-account-refreshed",{account:e}),this.email="",this._password=""},e=>{if(this._password="",this._requestInProgress=!1,e&&e.body&&e.body.message){if("UserNotConfirmed"===e.body.code)return alert("You need to confirm your email before logging in."),void this.navigate("/config/cloud/register#confirm");"PasswordChangeRequired"===e.body.code&&(alert("You need to change your password before logging in."),this.navigate("/config/cloud/forgot-password")),this.error=e.body.message}else this.error="Unknown error"}))}_handleRegister(){this.navigate("/config/cloud/register")}_handleForgotPassword(){this.navigate("/config/cloud/forgot-password")}}customElements.define(HaConfigCloudLogin.is,HaConfigCloudLogin);</script><dom-module id="ha-config-cloud-register" assetpath="cloud/"><template><style include="iron-flex ha-style">a{color:var(--primary-color);}paper-card{display:block;}paper-item{cursor:pointer;}paper-card:last-child{margin-top:24px;}h1{@apply (--paper-font-headline);margin:0;}.error{color:var(--google-red-500);}.card-actions{display:flex;justify-content:space-between;align-items:center;}[hidden]{display:none;}</style><hass-subpage title="Register Account"><div class="content"><ha-config-section is-wide="[[isWide]]"><span slot="header">Register with the Home Assistant Cloud</span> <span slot="introduction">Register today to easily connect with the Home Assistant Cloud. This will allow you to unlock great new services and functionality, like Amazon Alexa integration.<p>By registering an account you agree to the following terms and conditions.</p><ul><li><a href="https://home-assistant.io/tos/" target="_blank">Terms and Conditions</a></li><li><a href="https://home-assistant.io/privacy/" target="_blank">Privacy Policy</a></li></ul><p></p></span><template is="dom-if" if="[[!_hasConfirmationCode]]"><paper-card><div class="card-content"><div class="header"><h1>Register</h1><div class="error" hidden$="[[!_error]]">[[_error]]</div></div><paper-input autofocus="" label="Email address" type="email" value="{{email}}" on-keydown="_keyDown"></paper-input><paper-input label="Password" value="{{_password}}" type="password" on-keydown="_keyDown"></paper-input></div><div class="card-actions"><ha-progress-button on-tap="_handleRegister" progress="[[_requestInProgress]]">Create Account</ha-progress-button><button class="link" hidden="[[_requestInProgress]]" on-click="_handleShowVerifyAccount">have confirmation code?</button></div></paper-card></template><template is="dom-if" if="[[_hasConfirmationCode]]"><paper-card><div class="card-content"><div class="header"><h1>Verify email</h1><div class="error" hidden$="[[!_error]]">[[_error]]</div></div><p>Check your email address, we've emailed you a verification code to activate your account.</p><template is="dom-if" if="[[_showEmailInputForConfirmation]]"><paper-input label="Email address" type="email" value="{{email}}" on-keydown="_keyDown"></paper-input></template><paper-input label="Confirmation code" value="{{_confirmationCode}}" on-keydown="_keyDown" type="number"></paper-input></div><div class="card-actions"><ha-progress-button on-tap="_handleVerifyEmail" progress="[[_requestInProgress]]">Verify Email</ha-progress-button></div></paper-card></template></ha-config-section></div></hass-subpage></template></dom-module><script>class HaConfigCloudRegister extends(window.hassMixins.NavigateMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-config-cloud-register"}static get properties(){return{hass:Object,isWide:Boolean,email:{type:String,notify:!0},_requestInProgress:{type:Boolean,value:!1},_password:{type:String,value:""},_showEmailInputForConfirmation:{type:Boolean,value:!1},_hasConfirmationCode:{type:Boolean,value:()=>"#confirm"===document.location.hash}}}static get observers(){return["_inputChanged(email, _password)"]}_inputChanged(){this._error=!1}_keyDown(e){13===e.keyCode&&(this._hasConfirmationCode?this._handleVerifyEmail():this._handleRegister(),e.preventDefault())}_handleRegister(){this.email?this._password||(this._error="Password is required."):this._error="Email is required.",this._error||(this._requestInProgress=!0,this.hass.callApi("post","cloud/register",{email:this.email,password:this._password}).then(()=>{this._requestInProgress=!1,this._hasConfirmationCode=!0},e=>{this._password="",this._requestInProgress=!1,this._error=e&&e.body&&e.body.message?e.body.message:"Unknown error"}))}_handleShowVerifyAccount(){this._error="",this._showEmailInputForConfirmation=!0,this._hasConfirmationCode=!0}_handleVerifyEmail(){this.email?this._confirmationCode||(this._error="Confirmation code is required."):this._error="Email is required.",this._error||(this._requestInProgress=!0,this.hass.callApi("post","cloud/confirm_register",{email:this.email,confirmation_code:this._confirmationCode}).then(()=>{alert("Confirmation successful. You can now login."),this.navigate("config/cloud/login")},e=>{this._confirmationCode="",this._error=e&&e.body&&e.body.message?e.body.message:"Unknown error",this._requestInProgress=!1}))}}customElements.define(HaConfigCloudRegister.is,HaConfigCloudRegister);</script><dom-module id="ha-config-cloud-forgot-password" assetpath="cloud/"><template><style include="iron-flex ha-style">.content{padding-bottom:24px;}paper-card{display:block;max-width:600px;margin:0 auto;margin-top:24px;}h1{@apply (--paper-font-headline);margin:0;}.error{color:var(--google-red-500);}.card-actions{display:flex;justify-content:space-between;align-items:center;}.card-actions a{color:var(--primary-text-color);}[hidden]{display:none;}</style><hass-subpage title="Forgot Password"><div class="content"><template is="dom-if" if="[[!_hasToken]]"><paper-card><div class="card-content"><h1>Forgot Password</h1><p>Enter your email address and we will send you a link to reset your password.</p><paper-input autofocus="" label="E-mail" value="{{email}}" type="email" on-keydown="_keyDown"></paper-input><div class="error" hidden$="[[!error]]">[[error]]</div></div><div class="card-actions"><ha-progress-button on-tap="_handleEmailPasswordReset" progress="[[_requestInProgress]]">Send reset email</ha-progress-button><button class="link" hidden="[[_requestInProgress]]" on-click="_handleHaveToken">have a token?</button></div></paper-card></template><template is="dom-if" if="[[_hasToken]]"><paper-card><div class="card-content"><h1>Confirm new password</h1><template is="dom-if" if="[[_showEmailInputForConfirmation]]"><paper-input label="E-mail" type="email" value="{{email}}" on-keydown="_keyDown"></paper-input></template><paper-input label="Confirmation code" value="{{_confirmationCode}}" on-keydown="_keyDown" type="number"></paper-input><paper-input label="New password" value="{{_newPassword}}" on-keydown="_keyDown" type="password"></paper-input><div class="error" hidden$="[[!error]]">[[error]]</div></div><div class="card-actions"><ha-progress-button on-tap="_handleConfirmPasswordReset" progress="[[_requestInProgress]]">Reset Password</ha-progress-button></div></paper-card></template></div></hass-subpage></template></dom-module><script>class HaConfigCloudForgotPassword extends(window.hassMixins.NavigateMixin(window.hassMixins.EventsMixin(Polymer.Element))){static get is(){return"ha-config-cloud-forgot-password"}static get properties(){return{hass:Object,email:{type:String,notify:!0},_hasToken:{type:Boolean,value:!1},_newPassword:{type:String,value:""},_confirmationCode:{type:String,value:""},_showEmailInputForConfirmation:{type:Boolean,value:!1},_requestInProgress:{type:Boolean,value:!1}}}static get observers(){return["_inputChanged(email, _newPassword)"]}_inputChanged(){this.error=!1}_keyDown(s){13===s.keyCode&&(this._hasToken?this._handleConfirmPasswordReset():this._handleEmailPasswordReset(),s.preventDefault())}_handleEmailPasswordReset(){this.email||(this.error="Email is required."),this.error||(this._requestInProgress=!0,this.hass.callApi("post","cloud/forgot_password",{email:this.email}).then(()=>{this._hasToken=!0,this._requestInProgress=!1},s=>{this._requestInProgress=!1,this.error=s&&s.body&&s.body.message?s.body.message:"Unknown error"}))}_handleHaveToken(){this._error="",this._showEmailInputForConfirmation=!0,this._hasToken=!0}_handleConfirmPasswordReset(){this.error="",this.email||(this.error+="Email is required. "),this._confirmationCode||(this.error+="Confirmation code is required. "),this._newPassword?this._newPassword.length<6&&(this.error+="New password should be at least 6 characters."):this.error+="New password is required. ",this.error||(this._requestInProgress=!0,this.hass.callApi("post","cloud/confirm_forgot_password",{email:this.email,confirmation_code:this._confirmationCode,new_password:this._newPassword}).then(()=>{alert("Password reset successful! You can now login."),this.navigate("config/cloud/login")},s=>{this._requestInProgress=!1,this.error=s&&s.body&&s.body.message?s.body.message:"Unknown error"}))}}customElements.define(HaConfigCloudForgotPassword.is,HaConfigCloudForgotPassword);</script><dom-module id="ha-config-cloud-account" assetpath="cloud/"><template><style include="iron-flex ha-style">.content{padding-bottom:24px;}paper-card{display:block;}.account-row{display:flex;padding:0 16px;}paper-button{align-self:center;}.soon{font-style:italic;margin-top:24px;text-align:center;}.nowrap{white-space:nowrap;}.wrap{white-space:normal;}.status{padding:16px;}paper-button{color:var(--primary-color);font-weight:500;}</style><hass-subpage title="Cloud Account"><div class="content"><ha-config-section is-wide="[[isWide]]"><span slot="header">Home Assistant Cloud</span> <span slot="introduction">Thank you for supporting Home Assistant. It's because of people like you that we are able to run this project and make a great home automation experience for everyone. Thank you!</span><paper-card><div class="account-row"><paper-item-body two-line="">[[account.email]]<div secondary="" class="wrap"><span class="nowrap">Subscription expires on </span><span class="nowrap">[[_formatExpiration(account.sub_exp)]]</span></div></paper-item-body><paper-button on-tap="handleLogout">Sign out</paper-button></div><div class="account-row"><paper-item-body>Cloud connection status</paper-item-body><div class="status">[[account.cloud]]</div></div></paper-card><div class="soon">More configuration options coming soon.</div></ha-config-section></div></hass-subpage></template></dom-module><script>class HaConfigCloudAccount extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-config-cloud-account"}static get properties(){return{hass:Object,account:Object}}handleLogout(){this.hass.callApi("post","cloud/logout").then(()=>this.fire("ha-account-refreshed",{account:null}))}_formatExpiration(t){return window.hassUtil.formatDateTime(new Date(t))}}customElements.define(HaConfigCloudAccount.is,HaConfigCloudAccount);</script><dom-module id="ha-config-cloud" assetpath="cloud/"><template><style>iron-pages{height:100%;}</style><app-route route="[[route]]" pattern="/:page" data="{{_routeData}}" tail="{{_routeTail}}"></app-route><template is="dom-if" if="[[account]]" restamp=""><ha-config-cloud-account hass="[[hass]]" account="[[account]]" is-wide="[[isWide]]"></ha-config-cloud-account></template><template is="dom-if" if="[[!account]]" restamp=""><template is="dom-if" if="[[_isLoginPage(_routeData.page)]]" restamp=""><ha-config-cloud-login page-name="login" hass="[[hass]]" is-wide="[[isWide]]" email="{{_loginEmail}}"></ha-config-cloud-login></template><template is="dom-if" if="[[_isRegisterPage(_routeData.page)]]" restamp=""><ha-config-cloud-register page-name="register" hass="[[hass]]" is-wide="[[isWide]]" email="{{_loginEmail}}"></ha-config-cloud-register></template><template is="dom-if" if="[[_isForgotPasswordPage(_routeData.page)]]" restamp=""><ha-config-cloud-forgot-password page-name="forgot-password" hass="[[hass]]" is-wide="[[isWide]]" email="{{_loginEmail}}"></ha-config-cloud-forgot-password></template></template></template></dom-module><script>class HaConfigCloud extends(window.hassMixins.NavigateMixin(Polymer.Element)){static get is(){return"ha-config-cloud"}static get properties(){return{hass:Object,isWide:Boolean,loadingAccount:{type:Boolean,value:!1},account:{type:Object,value:null},route:Object,_routeData:Object,_routeTail:Object,_loginEmail:String}}static get observers(){return["_checkRoute(route, account)"]}_checkRoute(e,t){e&&"/config/cloud"===e.prefix&&(t||-1!==["/forgot-password","/register"].indexOf(e.path)?t&&-1!==["/login","/register","/forgot-password"].indexOf(e.path)&&this.navigate("/config/cloud/account",!0):this.navigate("/config/cloud/login",!0))}_isRegisterPage(e){return"register"===e}_isForgotPasswordPage(e){return"forgot-password"===e}_isLoginPage(e){return"login"===e}}customElements.define(HaConfigCloud.is,HaConfigCloud);</script><dom-module id="paper-fab" assetpath="../../bower_components/paper-fab/"><template strip-whitespace=""><style include="paper-material-styles">:host{@apply --layout-vertical;@apply --layout-center-center;background:var(--paper-fab-background, var(--accent-color));border-radius:50%;box-sizing:border-box;color:var(--text-primary-color);cursor:pointer;height:56px;min-width:0;outline:none;padding:16px;position:relative;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;user-select:none;width:56px;z-index:0;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent;@apply --paper-fab;}[hidden]{display:none !important;}:host([mini]){width:40px;height:40px;padding:8px;@apply --paper-fab-mini;}:host([disabled]){color:var(--paper-fab-disabled-text, var(--paper-grey-500));background:var(--paper-fab-disabled-background, var(--paper-grey-300));@apply --paper-fab-disabled;}iron-icon{@apply --paper-fab-iron-icon;}span{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:center;@apply --paper-fab-label;}:host(.keyboard-focus){background:var(--paper-fab-keyboard-focus-background, var(--paper-pink-900));}:host([elevation="1"]){@apply --paper-material-elevation-1;}:host([elevation="2"]){@apply --paper-material-elevation-2;}:host([elevation="3"]){@apply --paper-material-elevation-3;}:host([elevation="4"]){@apply --paper-material-elevation-4;}:host([elevation="5"]){@apply --paper-material-elevation-5;}</style><iron-icon id="icon" hidden$="{{!_computeIsIconFab(icon, src)}}" src="[[src]]" icon="[[icon]]"></iron-icon><span hidden$="{{_computeIsIconFab(icon, src)}}">{{label}}</span></template><script>Polymer({is:"paper-fab",behaviors:[Polymer.PaperButtonBehavior],properties:{src:{type:String,value:""},icon:{type:String,value:""},mini:{type:Boolean,value:!1,reflectToAttribute:!0},label:{type:String,observer:"_labelChanged"}},_labelChanged:function(){this.setAttribute("aria-label",this.label)},_computeIsIconFab:function(e,t){return e.length>0||t.length>0}});</script></dom-module><dom-module id="ha-automation-picker" assetpath="automation/"><template><style include="ha-style">:host{display:block;}paper-item{cursor:pointer;}paper-fab{position:fixed;bottom:16px;right:16px;z-index:1;}paper-fab[is-wide]{bottom:24px;right:24px;}a{color:var(--primary-color);}</style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="_backTapped"></paper-icon-button><div main-title="">Automations</div></app-toolbar></app-header><ha-config-section is-wide="[[isWide]]"><div slot="header">Automation Editor</div><div slot="introduction">The automation editor allows you to create and edit automations. Please read <a href="https://home-assistant.io/docs/automation/editor/" target="_blank">the instructions</a> to make sure that you have configured Home Assistant correctly.</div><paper-card heading="Pick automation to edit"><template is="dom-if" if="[[!automations.length]]"><div class="card-content"><p>We couldn't find any editable automations.</p></div></template><template is="dom-repeat" items="[[automations]]" as="automation"><paper-item><paper-item-body two-line="" on-tap="automationTapped"><div>[[computeName(automation)]]</div><div secondary="">[[computeDescription(automation)]]</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></template></paper-card></ha-config-section><paper-fab is-wide$="[[isWide]]" icon="mdi:plus" title="Add Automation" on-tap="addAutomation"></paper-fab></app-header-layout></template></dom-module><script>class HaAutomationPicker extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-automation-picker"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},automations:{type:Array},isWide:{type:Boolean}}}automationTapped(t){history.pushState(null,null,"/config/automation/edit/"+this.automations[t.model.index].attributes.id),this.fire("location-changed")}addAutomation(){history.pushState(null,null,"/config/automation/new"),this.fire("location-changed")}computeName(t){return window.hassUtil.computeStateName(t)}computeDescription(t){return""}_backTapped(){history.back()}}customElements.define(HaAutomationPicker.is,HaAutomationPicker);</script><dom-module id="paper-radio-button" assetpath="../../bower_components/paper-radio-button/"><template strip-whitespace=""><style>:host{display:inline-block;line-height:0;white-space:nowrap;cursor:pointer;@apply --paper-font-common-base;--calculated-paper-radio-button-size:var(--paper-radio-button-size, 16px);--calculated-paper-radio-button-ink-size:var(--paper-radio-button-ink-size, -1px);}:host(:focus){outline:none;}#radioContainer{@apply --layout-inline;@apply --layout-center-center;position:relative;width:var(--calculated-paper-radio-button-size);height:var(--calculated-paper-radio-button-size);vertical-align:middle;@apply --paper-radio-button-radio-container;}#ink{position:absolute;top:50%;left:50%;right:auto;width:var(--calculated-paper-radio-button-ink-size);height:var(--calculated-paper-radio-button-ink-size);color:var(--paper-radio-button-unchecked-ink-color, var(--primary-text-color));opacity:0.6;pointer-events:none;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);}#ink[checked]{color:var(--paper-radio-button-checked-ink-color, var(--primary-color));}#offRadio, #onRadio{position:absolute;box-sizing:border-box;top:0;left:0;width:100%;height:100%;border-radius:50%;}#offRadio{border:2px solid var(--paper-radio-button-unchecked-color, var(--primary-text-color));background-color:var(--paper-radio-button-unchecked-background-color, transparent);transition:border-color 0.28s;}#onRadio{background-color:var(--paper-radio-button-checked-color, var(--primary-color));-webkit-transform:scale(0);transform:scale(0);transition:-webkit-transform ease 0.28s;transition:transform ease 0.28s;will-change:transform;}:host([checked]) #offRadio{border-color:var(--paper-radio-button-checked-color, var(--primary-color));}:host([checked]) #onRadio{-webkit-transform:scale(0.5);transform:scale(0.5);}#radioLabel{line-height:normal;position:relative;display:inline-block;vertical-align:middle;margin-left:var(--paper-radio-button-label-spacing, 10px);white-space:normal;color:var(--paper-radio-button-label-color, var(--primary-text-color));@apply --paper-radio-button-label;}:host([checked]) #radioLabel{@apply --paper-radio-button-label-checked;}:host-context([dir="rtl"]) #radioLabel{margin-left:0;margin-right:var(--paper-radio-button-label-spacing, 10px);}#radioLabel[hidden]{display:none;}:host([disabled]) #offRadio{border-color:var(--paper-radio-button-unchecked-color, var(--primary-text-color));opacity:0.5;}:host([disabled][checked]) #onRadio{background-color:var(--paper-radio-button-unchecked-color, var(--primary-text-color));opacity:0.5;}:host([disabled]) #radioLabel{opacity:0.65;}</style><div id="radioContainer"><div id="offRadio"></div><div id="onRadio"></div></div><div id="radioLabel"><slot></slot></div></template><script>Polymer({is:"paper-radio-button",behaviors:[Polymer.PaperCheckedElementBehavior],hostAttributes:{role:"radio","aria-checked":!1,tabindex:0},properties:{ariaActiveAttribute:{type:String,value:"aria-checked"}},ready:function(){this._rippleContainer=this.$.radioContainer},attached:function(){Polymer.RenderStatus.afterNextRender(this,function(){if("-1px"===this.getComputedStyleValue("--calculated-paper-radio-button-ink-size").trim()){var e=parseFloat(this.getComputedStyleValue("--calculated-paper-radio-button-size").trim()),t=Math.floor(3*e);t%2!=e%2&&t++,this.updateStyles({"--paper-radio-button-ink-size":t+"px"})}})}});</script></dom-module><dom-module id="paper-radio-group" assetpath="../../bower_components/paper-radio-group/"><template><style>:host{display:inline-block;}:host ::slotted(*){padding:var(--paper-radio-group-item-padding, 12px);}</style><slot></slot></template></dom-module><script>Polymer({is:"paper-radio-group",behaviors:[Polymer.IronMenubarBehavior],hostAttributes:{role:"radiogroup",tabindex:0},properties:{attrForSelected:{type:String,value:"name"},selectedAttribute:{type:String,value:"checked"},selectable:{type:String,value:"paper-radio-button"},allowEmptySelection:{type:Boolean,value:!1}},select:function(e){var t=this._valueToItem(e);if(!t||!t.hasAttribute("disabled")){if(this.selected){var i=this._valueToItem(this.selected);if(this.selected==e){if(!this.allowEmptySelection)return void(i&&(i.checked=!0));e=""}i&&(i.checked=!1)}Polymer.IronSelectableBehavior.select.apply(this,[e]),this.fire("paper-radio-group-changed")}},_activateFocusedItem:function(){this._itemActivate(this._valueForItem(this.focusedItem),this.focusedItem)},_onUpKey:function(e){this._focusPrevious(),e.preventDefault(),this._activateFocusedItem()},_onDownKey:function(e){this._focusNext(),e.preventDefault(),this._activateFocusedItem()},_onLeftKey:function(e){Polymer.IronMenubarBehaviorImpl._onLeftKey.apply(this,arguments),this._activateFocusedItem()},_onRightKey:function(e){Polymer.IronMenubarBehaviorImpl._onRightKey.apply(this,arguments),this._activateFocusedItem()}});</script><script>!function(){"use strict";function e(e,t){var n,o,i,a,r=T;for(a=arguments.length;a-- >2;)S.push(arguments[a]);for(t&&null!=t.children&&(S.length||S.push(t.children),delete t.children);S.length;)if((o=S.pop())&&void 0!==o.pop)for(a=o.length;a--;)S.push(o[a]);else"boolean"==typeof o&&(o=null),(i="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(i=!1)),i&&n?r[r.length-1]+=o:r===T?r=[o]:r.push(o),n=i;var s=new function(){};return s.nodeName=e,s.children=r,s.attributes=null==t?void 0:t,s.key=null==t?void 0:t.key,void 0!==k.vnode&&k.vnode(s),s}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(e){!e._dirty&&(e._dirty=!0)&&1==P.push(e)&&(k.debounceRendering||N)(o)}function o(){var e,t=P;for(P=[];e=t.pop();)e._dirty&&m(e)}function i(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&a(e,t.nodeName):n||e._componentConstructor===t.nodeName}function a(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function r(e){var n=t({},e.attributes);n.children=e.children;var o=e.nodeName.defaultProps;if(void 0!==o)for(var i in o)void 0===n[i]&&(n[i]=o[i]);return n}function s(e){var t=e.parentNode;t&&t.removeChild(e)}function l(e,t,n,o,i){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),o&&o(e);else if("class"!==t||i)if("style"===t){if(o&&"string"!=typeof o&&"string"!=typeof n||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var a in n)a in o||(e.style[a]="");for(var a in o)e.style[a]="number"==typeof o[a]&&!1===D.test(a)?o[a]+"px":o[a]}}else if("dangerouslySetInnerHTML"===t)o&&(e.innerHTML=o.__html||"");else if("o"==t[0]&&"n"==t[1]){var r=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),o?n||e.addEventListener(t,p,r):e.removeEventListener(t,p,r),(e._listeners||(e._listeners={}))[t]=o}else if("list"!==t&&"type"!==t&&!i&&t in e)!function(e,t,n){try{e[t]=n}catch(e){}}(e,t,null==o?"":o),null!=o&&!1!==o||e.removeAttribute(t);else{var s=i&&t!==(t=t.replace(/^xlink\:?/,""));null==o||!1===o?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof o&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),o):e.setAttribute(t,o))}else e.className=o||""}function p(e){return this._listeners[e.type](k.event&&k.event(e)||e)}function d(){for(var e;e=A.pop();)k.afterMount&&k.afterMount(e),e.componentDidMount&&e.componentDidMount()}function c(e,t,n,o,i,a){O++||(E=null!=i&&void 0!==i.ownerSVGElement,L=null!=e&&!("__preactattr_"in e));var r=u(e,t,n,o,a);return i&&r.parentNode!==i&&i.appendChild(r),--O||(L=!1,a||d()),r}function u(e,t,n,o,p){var d=e,c=E;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||p)?e.nodeValue!=t&&(e.nodeValue=t):(d=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(d,e),h(e,!0))),d.__preactattr_=!0,d;var g=t.nodeName;if("function"==typeof g)return function(e,t,n,o){for(var i=e&&e._component,a=i,s=e,l=i&&e._componentConstructor===t.nodeName,p=l,d=r(t);i&&!p&&(i=i._parentComponent);)p=i.constructor===t.nodeName;return i&&p&&(!o||i._component)?(C(i,d,3,n,o),e=i.base):(a&&!l&&(b(a),e=s=null),i=f(t.nodeName,d,n),e&&!i.nextBase&&(i.nextBase=e,s=null),C(i,d,1,n,o),e=i.base,s&&e!==s&&(s._component=null,h(s,!1))),e}(e,t,n,o);if(E="svg"===g||"foreignObject"!==g&&E,g=String(g),(!e||!a(e,g))&&(d=function(e,t){var n=E?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}(g),e)){for(;e.firstChild;)d.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(d,e),h(e,!0)}var v=d.firstChild,m=d.__preactattr_,y=t.children;if(null==m){m=d.__preactattr_={};for(var _=d.attributes,x=_.length;x--;)m[_[x].name]=_[x].value}return!L&&y&&1===y.length&&"string"==typeof y[0]&&null!=v&&void 0!==v.splitText&&null==v.nextSibling?v.nodeValue!=y[0]&&(v.nodeValue=y[0]):(y&&y.length||null!=v)&&function(e,t,n,o,a){var r,l,p,d,c,g=e.childNodes,f=[],v={},C=0,m=0,b=g.length,y=0,_=t?t.length:0;if(0!==b)for(S=0;S<b;S++){var x=g[S],w=x.__preactattr_;null!=(k=_&&w?x._component?x._component.__key:w.key:null)?(C++,v[k]=x):(w||(void 0!==x.splitText?!a||x.nodeValue.trim():a))&&(f[y++]=x)}if(0!==_)for(S=0;S<_;S++){c=null;var k=(d=t[S]).key;if(null!=k)C&&void 0!==v[k]&&(c=v[k],v[k]=void 0,C--);else if(!c&&m<y)for(r=m;r<y;r++)if(void 0!==f[r]&&i(l=f[r],d,a)){c=l,f[r]=void 0,r===y-1&&y--,r===m&&m++;break}c=u(c,d,n,o),p=g[S],c&&c!==e&&c!==p&&(null==p?e.appendChild(c):c===p.nextSibling?s(p):e.insertBefore(c,p))}if(C)for(var S in v)void 0!==v[S]&&h(v[S],!1);for(;m<=y;)void 0!==(c=f[y--])&&h(c,!1)}(d,y,n,o,L||null!=m.dangerouslySetInnerHTML),function(e,t,n){var o;for(o in n)t&&null!=t[o]||null==n[o]||l(e,o,n[o],n[o]=void 0,E);for(o in t)"children"===o||"innerHTML"===o||o in n&&t[o]===("value"===o||"checked"===o?e[o]:n[o])||l(e,o,n[o],n[o]=t[o],E)}(d,t.attributes,m),E=c,d}function h(e,t){var n=e._component;n?b(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||s(e),g(e))}function g(e){for(e=e.lastChild;e;){var t=e.previousSibling;h(e,!0),e=t}}function f(e,t,n){var o,i=U[e.name];if(e.prototype&&e.prototype.render?(o=new e(t,n),y.call(o,t,n)):((o=new y(t,n)).constructor=e,o.render=v),i)for(var a=i.length;a--;)if(i[a].constructor===e){o.nextBase=i[a].nextBase,i.splice(a,1);break}return o}function v(e,t,n){return this.constructor(e,n)}function C(e,t,o,i,a){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||a?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,i),i&&i!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=i),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==o&&(1!==o&&!1===k.syncComponentUpdates&&e.base?n(e):m(e,1,a)),e.__ref&&e.__ref(e))}function m(e,n,o,i){if(!e._disable){var a,s,l,p=e.props,u=e.state,g=e.context,v=e.prevProps||p,y=e.prevState||u,_=e.prevContext||g,x=e.base,w=e.nextBase,S=x||w,T=e._component,N=!1;if(x&&(e.props=v,e.state=y,e.context=_,2!==n&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(p,u,g)?N=!0:e.componentWillUpdate&&e.componentWillUpdate(p,u,g),e.props=p,e.state=u,e.context=g),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!N){a=e.render(p,u,g),e.getChildContext&&(g=t(t({},g),e.getChildContext()));var D,P,E=a&&a.nodeName;if("function"==typeof E){var L=r(a);(s=T)&&s.constructor===E&&L.key==s.__key?C(s,L,1,g,!1):(D=s,e._component=s=f(E,L,g),s.nextBase=s.nextBase||w,s._parentComponent=e,C(s,L,0,g,!1),m(s,1,o,!0)),P=s.base}else l=S,(D=T)&&(l=e._component=null),(S||1===n)&&(l&&(l._component=null),P=c(l,a,g,o||!x,S&&S.parentNode,!0));if(S&&P!==S&&s!==T){var U=S.parentNode;U&&P!==U&&(U.replaceChild(P,S),D||(S._component=null,h(S,!1)))}if(D&&b(D),e.base=P,P&&!i){for(var z=e,G=e;G=G._parentComponent;)(z=G).base=P;P._component=z,P._componentConstructor=z.constructor}}if(!x||o?A.unshift(e):N||(e.componentDidUpdate&&e.componentDidUpdate(v,y,_),k.afterUpdate&&k.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);O||i||d()}}function b(e){k.beforeUnmount&&k.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?b(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,s(t),function(e){var t=e.constructor.name;(U[t]||(U[t]=[])).push(e)}(e),g(t)),e.__ref&&e.__ref(null)}function y(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function _(e,t,n){return c(n,e,{},!1,t,!1)}function x(e,t){const n=G({},this.props[e]);t.target.value!==n[t.target.name]&&(t.target.value?n[t.target.name]=t.target.value:delete n[t.target.name],this.props.onChange(this.props.index,n))}function w(e){const t=Object.keys(he);for(let n=0;n<t.length;n++)if(he[t[n]].configKey in e)return t[n];return null}var k={},S=[],T=[],N="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,D=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,P=[],A=[],O=0,E=!1,L=!1,U={};t(y.prototype,{setState:function(e,o){var i=this.state;this.prevState||(this.prevState=t({},i)),t(i,"function"==typeof e?e(i,this.props):e),o&&(this._renderCallbacks=this._renderCallbacks||[]).push(o),n(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),m(this,2)},render:function(){}});class z extends y{constructor(e){super(e),this.state.isValid=!0,this.state.value=JSON.stringify(e.value||{},null,2),this.onChange=this.onChange.bind(this)}onChange(e){const t=e.target.value;let n,o;try{n=JSON.parse(t),o=!0}catch(e){o=!1}this.setState({value:t,isValid:o}),o&&this.props.onChange(n)}componentWillReceiveProps({value:e}){this.setState({value:JSON.stringify(e,null,2),isValid:!0})}render({label:t},{value:n,isValid:o}){const i={minWidth:300,width:"100%"};return o||(i.border="1px solid red"),e("paper-textarea",{label:t,value:n,style:i,"onvalue-changed":this.onChange})}}!function(){function e(e){function t(o,i){try{var a=e[o](i),r=a.value;r instanceof function(e){this.value=e}?Promise.resolve(r.value).then(function(e){t("next",e)},function(e){t("throw",e)}):n(a.done?"return":"normal",a.value)}catch(e){n("throw",e)}}function n(e,n){switch(e){case"return":o.resolve({value:n,done:!0});break;case"throw":o.reject(n);break;default:o.resolve({value:n,done:!1})}(o=o.next)?t(o.key,o.arg):i=null}var o,i;this._invoke=function(e,n){return new Promise(function(a,r){var s={key:e,arg:n,resolve:a,reject:r,next:null};i?i=i.next=s:(o=i=s,t(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(e){return this._invoke("next",e)},e.prototype.throw=function(e){return this._invoke("throw",e)},e.prototype.return=function(e){return this._invoke("return",e)}}();var G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};class B extends y{constructor(){super(),this.onChange=x.bind(this,"trigger"),this.eventDataChanged=this.eventDataChanged.bind(this)}eventDataChanged(e){this.props.onChange(this.props.index,G({},this.props.trigger,{event_data:e}))}render({trigger:t}){const{event_type:n,event_data:o}=t;return e("div",null,e("paper-input",{label:"Event Type",name:"event_type",value:n,onChange:this.onChange}),e(z,{label:"Event Data",value:o,onChange:this.eventDataChanged}))}}B.defaultConfig={event_type:"",event_data:{}};class I extends y{constructor(){super(),this.radioGroupPicked=this.radioGroupPicked.bind(this)}radioGroupPicked(e){this.props.onChange(this.props.index,G({},this.props.trigger,{event:e.target.selected}))}render({trigger:t}){const{event:n}=t;return e("div",null,e("label",{id:"eventlabel"},"Event:"),e("paper-radio-group",{selected:n,"aria-labelledby":"eventlabel","onpaper-radio-group-changed":this.radioGroupPicked},e("paper-radio-button",{name:"start"},"Start"),e("paper-radio-button",{name:"shutdown"},"Shutdown")))}}I.defaultConfig={event:"start"};class V extends y{constructor(){super(),this.onChange=x.bind(this,"trigger")}render({trigger:t}){const{topic:n,payload:o}=t;return e("div",null,e("paper-input",{label:"Topic",name:"topic",value:n,onChange:this.onChange}),e("paper-input",{label:"Payload (Optional)",name:"payload",value:o,onChange:this.onChange}))}}V.defaultConfig={topic:""};class M extends y{constructor(){super(),this.onChange=x.bind(this,"trigger")}render({trigger:t}){const{value_template:n,entity_id:o,below:i,above:a}=t;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:o,onChange:this.onChange}),e("paper-input",{label:"Above",name:"above",value:a,onChange:this.onChange}),e("paper-input",{label:"Below",name:"below",value:i,onChange:this.onChange}),e("paper-textarea",{label:"Value template (optional)",name:"value_template",value:n,"onvalue-changed":this.onChange}))}}M.defaultConfig={entity_id:""};class W extends y{constructor(){super(),this.onChange=x.bind(this,"trigger")}render({trigger:t}){const{entity_id:n,to:o}=t,i=t.from,a=t.for;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:n,onChange:this.onChange}),e("paper-input",{label:"From",name:"from",value:i,onChange:this.onChange}),e("paper-input",{label:"To",name:"to",value:o,onChange:this.onChange}),a&&e("pre",null,"For: ",JSON.stringify(a,null,2)))}}W.defaultConfig={entity_id:""};class j extends y{constructor(){super(),this.onChange=x.bind(this,"trigger"),this.radioGroupPicked=this.radioGroupPicked.bind(this)}radioGroupPicked(e){this.props.onChange(this.props.index,G({},this.props.trigger,{event:e.target.selected}))}render({trigger:t}){const{offset:n,event:o}=t;return e("div",null,e("label",{id:"eventlabel"},"Event:"),e("paper-radio-group",{selected:o,"aria-labelledby":"eventlabel","onpaper-radio-group-changed":this.radioGroupPicked},e("paper-radio-button",{name:"sunrise"},"Sunrise"),e("paper-radio-button",{name:"sunset"},"Sunset")),e("paper-input",{label:"Offset (optional)",name:"offset",value:n,onChange:this.onChange}))}}j.defaultConfig={event:"sunrise"};class H extends y{constructor(){super(),this.onChange=x.bind(this,"trigger")}render({trigger:t}){const{value_template:n}=t;return e("div",null,e("paper-textarea",{label:"Value Template",name:"value_template",value:n,"onvalue-changed":this.onChange}))}}H.defaultConfig={value_template:""};class J extends y{constructor(){super(),this.onChange=x.bind(this,"trigger")}render({trigger:t}){const{at:n}=t;return e("div",null,e("paper-input",{label:"At",name:"at",value:n,onChange:this.onChange}))}}J.defaultConfig={at:""};class K extends y{constructor(){super(),this.onChange=x.bind(this,"trigger"),this.radioGroupPicked=this.radioGroupPicked.bind(this)}radioGroupPicked(e){this.props.onChange(this.props.index,G({},this.props.trigger,{event:e.target.selected}))}render({trigger:t}){const{entity_id:n,zone:o,event:i}=t;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:n,onChange:this.onChange}),e("paper-input",{label:"Zone",name:"zone",value:o,onChange:this.onChange}),e("label",{id:"eventlabel"},"Event:"),e("paper-radio-group",{selected:i,"aria-labelledby":"eventlabel","onpaper-radio-group-changed":this.radioGroupPicked},e("paper-radio-button",{name:"enter"},"Enter"),e("paper-radio-button",{name:"leave"},"Leave")))}}K.defaultConfig={entity_id:"",zone:"",event:"enter"};const F={event:B,state:W,homeassistant:I,mqtt:V,numeric_state:M,sun:j,template:H,time:J,zone:K},R=Object.keys(F).sort();class Z extends y{constructor(){super(),this.typeChanged=this.typeChanged.bind(this)}typeChanged(e){const t=e.target.selectedItem.innerHTML;t!==this.props.trigger.platform&&this.props.onChange(this.props.index,G({platform:t},F[t].defaultConfig))}render({index:t,trigger:n,onChange:o}){const i=F[n.platform],a=R.indexOf(n.platform);return i?e("div",null,e("paper-dropdown-menu-light",{label:"Trigger Type","no-animations":!0},e("paper-listbox",{slot:"dropdown-content",selected:a,"oniron-select":this.typeChanged},R.map(t=>e("paper-item",null,t)))),e(i,{index:t,trigger:n,onChange:o})):e("div",null,"Unsupported platform: ",n.platform,e("pre",null,JSON.stringify(n,null,2)))}}class $ extends y{constructor(){super(),this.onDelete=this.onDelete.bind(this)}onDelete(){confirm("Sure you want to delete?")&&this.props.onChange(this.props.index,null)}render(t){return e("paper-card",null,e("div",{class:"card-menu"},e("paper-menu-button",{"no-animations":!0,"horizontal-align":"right","horizontal-offset":"-5","vertical-offset":"-5"},e("paper-icon-button",{icon:"mdi:dots-vertical",slot:"dropdown-trigger"}),e("paper-listbox",{slot:"dropdown-content"},e("paper-item",{disabled:!0},"Duplicate"),e("paper-item",{onTap:this.onDelete},"Delete")))),e("div",{class:"card-content"},e(Z,t)))}}class q extends y{constructor(){super(),this.addTrigger=this.addTrigger.bind(this),this.triggerChanged=this.triggerChanged.bind(this)}addTrigger(){const e=this.props.trigger.concat(G({platform:"state"},W.defaultConfig));this.props.onChange(e)}triggerChanged(e,t){const n=this.props.trigger.concat();null===t?n.splice(e,1):n[e]=t,this.props.onChange(n)}render({trigger:t}){return e("div",{class:"triggers"},t.map((t,n)=>e($,{index:n,trigger:t,onChange:this.triggerChanged})),e("paper-card",null,e("div",{class:"card-actions add-card"},e("paper-button",{onTap:this.addTrigger},"Add trigger"))))}}class Q extends y{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:t}){const{value_template:n,entity_id:o,below:i,above:a}=t;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:o,onChange:this.onChange}),e("paper-input",{label:"Above",name:"above",value:a,onChange:this.onChange}),e("paper-input",{label:"Below",name:"below",value:i,onChange:this.onChange}),e("paper-textarea",{label:"Value template (optional)",name:"value_template",value:n,"onvalue-changed":this.onChange}))}}Q.defaultConfig={entity_id:""};class X extends y{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:t}){const{entity_id:n,state:o}=t,i=t.for;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:n,onChange:this.onChange}),e("paper-input",{label:"State",name:"state",value:o,onChange:this.onChange}),i&&e("pre",null,"For: ",JSON.stringify(i,null,2)))}}X.defaultConfig={entity_id:"",state:""};class Y extends y{constructor(){super(),this.onChange=x.bind(this,"condition"),this.afterPicked=this.radioGroupPicked.bind(this,"after"),this.beforePicked=this.radioGroupPicked.bind(this,"before")}radioGroupPicked(e,t){const n=G({},this.props.condition);t.target.selected?n[e]=t.target.selected:delete n[e],this.props.onChange(this.props.index,n)}render({condition:t}){const{after:n,after_offset:o,before:i,before_offset:a}=t;return e("div",null,e("label",{id:"beforelabel"},"Before:"),e("paper-radio-group",{"allow-empty-selection":!0,selected:i,"aria-labelledby":"beforelabel","onpaper-radio-group-changed":this.beforePicked},e("paper-radio-button",{name:"sunrise"},"Sunrise"),e("paper-radio-button",{name:"sunset"},"Sunset")),e("paper-input",{label:"Before offset (optional)",name:"before_offset",value:a,onChange:this.onChange,disabled:void 0===i}),e("label",{id:"afterlabel"},"After:"),e("paper-radio-group",{"allow-empty-selection":!0,selected:n,"aria-labelledby":"afterlabel","onpaper-radio-group-changed":this.afterPicked},e("paper-radio-button",{name:"sunrise"},"Sunrise"),e("paper-radio-button",{name:"sunset"},"Sunset")),e("paper-input",{label:"After offset (optional)",name:"after_offset",value:o,onChange:this.onChange,disabled:void 0===n}))}}Y.defaultConfig={};class ee extends y{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:t}){const{value_template:n}=t;return e("div",null,e("paper-textarea",{label:"Value Template",name:"value_template",value:n,"onvalue-changed":this.onChange}))}}ee.defaultConfig={value_template:""};class te extends y{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:t}){const{after:n,before:o}=t;return e("div",null,e("paper-input",{label:"After",name:"after",value:n,onChange:this.onChange}),e("paper-input",{label:"Before",name:"before",value:o,onChange:this.onChange}))}}te.defaultConfig={};class ne extends y{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:t}){const{entity_id:n,zone:o}=t;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:n,onChange:this.onChange}),e("paper-input",{label:"Zone entity id",name:"zone",value:o,onChange:this.onChange}))}}ne.defaultConfig={entity_id:"",zone:""};const oe={state:X,numeric_state:Q,sun:Y,template:ee,time:te,zone:ne},ie=Object.keys(oe).sort();class ae extends y{constructor(){super(),this.typeChanged=this.typeChanged.bind(this)}typeChanged(e){const t=e.target.selectedItem.innerHTML;t!==this.props.condition.condition&&this.props.onChange(this.props.index,G({condition:t},oe[t].defaultConfig))}render({index:t,condition:n,onChange:o}){const i=oe[n.condition],a=ie.indexOf(n.condition);return i?e("div",null,e("paper-dropdown-menu-light",{label:"Condition Type","no-animations":!0},e("paper-listbox",{slot:"dropdown-content",selected:a,"oniron-select":this.typeChanged},ie.map(t=>e("paper-item",null,t)))),e(i,{index:t,condition:n,onChange:o})):e("div",null,"Unsupported condition: ",n.condition,e("pre",null,JSON.stringify(n,null,2)))}}class re extends y{constructor(){super(),this.onDelete=this.onDelete.bind(this)}onDelete(){confirm("Sure you want to delete?")&&this.props.onChange(this.props.index,null)}render(t){return e("paper-card",null,e("div",{class:"card-menu"},e("paper-menu-button",{"no-animations":!0,"horizontal-align":"right","horizontal-offset":"-5","vertical-offset":"-5"},e("paper-icon-button",{icon:"mdi:dots-vertical",slot:"dropdown-trigger"}),e("paper-listbox",{slot:"dropdown-content"},e("paper-item",{disabled:!0},"Duplicate"),e("paper-item",{onTap:this.onDelete},"Delete")))),e("div",{class:"card-content"},e(ae,t)))}}class se extends y{constructor(){super(),this.addCondition=this.addCondition.bind(this),this.conditionChanged=this.conditionChanged.bind(this)}addCondition(){const e=this.props.condition.concat({condition:"state"});this.props.onChange(e)}conditionChanged(e,t){const n=this.props.condition.concat();null===t?n.splice(e,1):n[e]=t,this.props.onChange(n)}render({condition:t}){return e("div",{class:"triggers"},t.map((t,n)=>e(re,{index:n,condition:t,onChange:this.conditionChanged})),e("paper-card",null,e("div",{class:"card-actions add-card"},e("paper-button",{onTap:this.addCondition},"Add condition"))))}}class le extends y{constructor(){super(),this.onChange=x.bind(this,"action"),this.serviceDataChanged=this.serviceDataChanged.bind(this)}serviceDataChanged(e){this.props.onChange(this.props.index,G({},this.props.action,{data:e}))}render({action:t}){const{alias:n,service:o,data:i}=t;return e("div",null,e("paper-input",{label:"Alias",name:"alias",value:n,onChange:this.onChange}),e("paper-input",{label:"Service",name:"service",value:o,onChange:this.onChange}),e(z,{label:"Service Data",value:i,onChange:this.serviceDataChanged}))}}le.configKey="service",le.defaultConfig={alias:"",service:"",data:{}};class pe extends y{render({action:t,index:n,onChange:o}){return e(ae,{condition:t,onChange:o,index:n})}}pe.configKey="condition",pe.defaultConfig=G({condition:"state"},X.defaultConfig);class de extends y{constructor(){super(),this.onChange=x.bind(this,"action")}render({action:t}){const{delay:n}=t;return e("div",null,e("paper-input",{label:"Delay",name:"delay",value:n,onChange:this.onChange}))}}de.configKey="delay",de.defaultConfig={delay:""};class ce extends y{constructor(){super(),this.onChange=x.bind(this,"action"),this.serviceDataChanged=this.serviceDataChanged.bind(this)}serviceDataChanged(e){this.props.onChange(this.props.index,G({},this.props.action,{data:e}))}render({action:t}){const{event:n,event_data:o}=t;return e("div",null,e("paper-input",{label:"Event",name:"event",value:n,onChange:this.onChange}),e(z,{label:"Service Data",value:o,onChange:this.serviceDataChanged}))}}ce.configKey="event",ce.defaultConfig={event:"",event_data:{}};class ue extends y{constructor(){super(),this.onChange=x.bind(this,"action"),this.onTemplateChange=this.onTemplateChange.bind(this)}onTemplateChange(e){this.props.onChange(this.props.index,G({},this.props.trigger,{[e.target.name]:e.target.value}))}render({action:t}){const{wait_template:n,timeout:o}=t;return e("div",null,e("paper-textarea",{label:"Wait Template",name:"wait_template",value:n,"onvalue-changed":this.onTemplateChange}),e("paper-input",{label:"Timeout (Optional)",name:"timeout",value:o,onChange:this.onChange}))}}ue.configKey="wait_template",ue.defaultConfig={wait_template:"",timeout:""};const he={"Call Service":le,Delay:de,Wait:ue,Condition:pe,"Fire Event":ce},ge=Object.keys(he).sort();class fe extends y{constructor(){super(),this.typeChanged=this.typeChanged.bind(this)}typeChanged(e){const t=e.target.selectedItem.innerHTML;w(this.props.action)!==t&&this.props.onChange(this.props.index,he[t].defaultConfig)}render({index:t,action:n,onChange:o}){const i=w(n),a=i&&he[i],r=ge.indexOf(i);return a?e("div",null,e("paper-dropdown-menu-light",{label:"Action Type","no-animations":!0},e("paper-listbox",{slot:"dropdown-content",selected:r,"oniron-select":this.typeChanged},ge.map(t=>e("paper-item",null,t)))),e(a,{index:t,action:n,onChange:o})):e("div",null,"Unsupported action",e("pre",null,JSON.stringify(n,null,2)))}}class ve extends y{constructor(){super(),this.onDelete=this.onDelete.bind(this)}onDelete(){confirm("Sure you want to delete?")&&this.props.onChange(this.props.index,null)}render(t){return e("paper-card",null,e("div",{class:"card-menu"},e("paper-menu-button",{"no-animations":!0,"horizontal-align":"right","horizontal-offset":"-5","vertical-offset":"-5"},e("paper-icon-button",{icon:"mdi:dots-vertical",slot:"dropdown-trigger"}),e("paper-listbox",{slot:"dropdown-content"},e("paper-item",{disabled:!0},"Duplicate"),e("paper-item",{onTap:this.onDelete},"Delete")))),e("div",{class:"card-content"},e(fe,t)))}}class Ce extends y{constructor(){super(),this.addAction=this.addAction.bind(this),this.actionChanged=this.actionChanged.bind(this)}addAction(){const e=this.props.script.concat({service:""});this.props.onChange(e)}actionChanged(e,t){const n=this.props.script.concat();null===t?n.splice(e,1):n[e]=t,this.props.onChange(n)}render({script:t}){return e("div",{class:"script"},t.map((t,n)=>e(ve,{index:n,action:t,onChange:this.actionChanged})),e("paper-card",null,e("div",{class:"card-actions add-card"},e("paper-button",{onTap:this.addAction},"Add action"))))}}class me extends y{constructor(){super(),this.onChange=this.onChange.bind(this),this.triggerChanged=this.triggerChanged.bind(this),this.conditionChanged=this.conditionChanged.bind(this),this.actionChanged=this.actionChanged.bind(this)}onChange(e){this.props.onChange(G({},this.props.automation,{[e.target.name]:e.target.value}))}triggerChanged(e){this.props.onChange(G({},this.props.automation,{trigger:e}))}conditionChanged(e){this.props.onChange(G({},this.props.automation,{condition:e}))}actionChanged(e){this.props.onChange(G({},this.props.automation,{action:e}))}render({automation:t,isWide:n}){const{alias:o,trigger:i,condition:a,action:r}=t;return e("div",null,e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},o),e("span",{slot:"introduction"},"Use automations to bring your home alive."),e("paper-card",null,e("div",{class:"card-content"},e("paper-input",{label:"Name",name:"alias",value:o,onChange:this.onChange})))),e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},"Triggers"),e("span",{slot:"introduction"},"Triggers are what starts the processing of an automation rule. It is possible to specify multiple triggers for the same rule. Once a trigger starts, Home Assistant will validate the conditions, if any, and call the action.",e("p",null,e("a",{href:"https://home-assistant.io/docs/automation/trigger/",target:"_blank"},"Learn more about triggers."))),e(q,{trigger:i,onChange:this.triggerChanged})),e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},"Conditions"),e("span",{slot:"introduction"},"Conditions are an optional part of an automation rule and can be used to prevent an action from happening when triggered. Conditions look very similar to triggers but are very different. A trigger will look at events happening in the system while a condition only looks at how the system looks right now. A trigger can observe that a switch is being turned on. A condition can only see if a switch is currently on or off.",e("p",null,e("a",{href:"https://home-assistant.io/docs/scripts/conditions/",target:"_blank"},"Learn more about conditions."))),e(se,{condition:a||[],onChange:this.conditionChanged})),e("ha-config-section",{"is-wide":n},e("span",{slot:"header"},"Action"),e("span",{slot:"introduction"},"The actions are what Home Assistant will do when the automation is triggered.",e("p",null,e("a",{href:"https://home-assistant.io/docs/scripts/",target:"_blank"},"Learn more about actions."))),e(Ce,{script:r,onChange:this.actionChanged})))}}window.AutomationEditor=function(t,n,o){return _(e(me,n),t,o)},window.unmountPreact=function(e,t){_(()=>null,e,t)}}();</script><dom-module id="ha-automation-editor" assetpath="automation/"><template><style include="ha-style">.errors{padding:20px;font-weight:bold;color:var(--google-red-500);}.content{padding-bottom:20px;}paper-card{display:block;}.triggers,
      .script{margin-top:-16px;}.triggers paper-card,
      .script paper-card{margin-top:16px;}.add-card paper-button{display:block;text-align:center;}.card-menu{position:absolute;top:0;right:0;z-index:1;color:var(--primary-text-color);}.card-menu paper-item{cursor:pointer;}span[slot=introduction] a{color:var(--primary-color);}paper-fab{position:fixed;bottom:16px;right:16px;z-index:1;margin-bottom:-80px;transition:margin-bottom .3s;}paper-fab[is-wide]{bottom:24px;right:24px;}paper-fab[dirty]{margin-bottom:0;}</style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="backTapped"></paper-icon-button><div main-title="">Automation [[name]]</div></app-toolbar></app-header><div class="content"><template is="dom-if" if="[[errors]]"><div class="errors">[[errors]]</div></template><div id="root"></div><paper-fab is-wide$="[[isWide]]" dirty$="[[dirty]]" icon="mdi:content-save" title="Save" on-tap="saveAutomation"></paper-fab></div></app-header-layout></template></dom-module><script>class HaAutomationEditor extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-automation-editor"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},errors:{type:Object,value:null},dirty:{type:Boolean,value:!1},config:{type:Object,value:null},automation:{type:Object,observer:"automationChanged"},creatingNew:{type:Boolean,observer:"creatingNewChanged"},name:{type:String,computed:"computeName(automation)"},isWide:{type:Boolean,observer:"isWideChanged"}}}ready(){super.ready(),this.configChanged=this.configChanged.bind(this),this._rendered=null}disconnectedCallback(){super.disconnectedCallback(),this._rendered&&window.unmountPreact(this._rendered)}configChanged(t){null!==this._rendered&&(this.config=t,this.errors=null,this.dirty=!0,this._updateComponent(t))}automationChanged(t,e){t&&(this.hass?e&&e.attributes.id===t.attributes.id||this.hass.callApi("get","config/automation/config/"+t.attributes.id).then(function(t){["trigger","condition","action"].forEach(function(e){var i=t[e];i&&!Array.isArray(i)&&(t[e]=[i])}),this.dirty=!1,this.config=t,this._updateComponent()}.bind(this)):setTimeout(this.automationChanged.bind(this,t,e),0))}creatingNewChanged(t){t&&(this.dirty=!1,this.config={alias:"New Automation",trigger:[{platform:"state"}],condition:[],action:[{service:""}]},this._updateComponent())}isWideChanged(){null!==this.config&&this._updateComponent()}backTapped(){this.dirty&&!confirm("You have unsaved changes. Are you sure you want to leave?")||history.back()}_updateComponent(){this._rendered=window.AutomationEditor(this.$.root,{automation:this.config,onChange:this.configChanged,isWide:this.isWide},this._rendered)}saveAutomation(){var t=this.creatingNew?""+Date.now():this.automation.attributes.id;this.hass.callApi("post","config/automation/config/"+t,this.config).then(function(){this.dirty=!1,this.creatingNew&&(history.replaceState(null,null,"/config/automation/edit/"+t),this.fire("location-changed"))}.bind(this),function(t){throw this.errors=t.body.message,t}.bind(this))}computeName(t){return t&&window.hassUtil.computeStateName(t)}}customElements.define(HaAutomationEditor.is,HaAutomationEditor);</script><dom-module id="ha-config-automation" assetpath="automation/"><template><style>ha-automation-picker,
      ha-automation-editor{height:100%;}</style><app-route route="[[route]]" pattern="/edit/:automation" data="{{_routeData}}" active="{{_edittingAutomation}}"></app-route><app-route route="[[route]]" pattern="/new" active="{{_creatingNew}}"></app-route><template is="dom-if" if="[[!showEditor]]"><ha-automation-picker narrow="[[narrow]]" show-menu="[[showMenu]]" automations="[[automations]]" is-wide="[[isWide]]"></ha-automation-picker></template><template is="dom-if" if="[[showEditor]]" restamp=""><ha-automation-editor hass="[[hass]]" automation="[[automation]]" is-wide="[[isWide]]" creating-new="[[_creatingNew]]"></ha-automation-editor></template></template></dom-module><script>class HaConfigAutomation extends Polymer.Element{static get is(){return"ha-config-automation"}static get properties(){return{hass:Object,narrow:Boolean,showMenu:Boolean,route:Object,isWide:Boolean,_routeData:Object,_routeMatches:Boolean,_creatingNew:Boolean,_edittingAutomation:Boolean,automations:{type:Array,computed:"computeAutomations(hass)"},automation:{type:Object,computed:"computeAutomation(automations, _edittingAutomation, _routeData)"},showEditor:{type:Boolean,computed:"computeShowEditor(_edittingAutomation, _creatingNew)"}}}computeAutomation(t,o,e){if(!t||!o)return null;for(var a=0;a<t.length;a++)if(t[a].attributes.id===e.automation)return t[a];return null}computeAutomations(t){var o=[];return Object.keys(t.states).forEach(function(e){var a=t.states[e];"automation"===window.hassUtil.computeDomain(a)&&"id"in a.attributes&&o.push(a)}),o.sort(function(t,o){var e=(t.attributes.alias||t.entity_id).toLowerCase(),a=(o.attributes.alias||o.entity_id).toLowerCase();return e<a?-1:e>a?1:0})}computeShowEditor(t,o){return o||t}}customElements.define(HaConfigAutomation.is,HaConfigAutomation);</script><dom-module id="ha-script-picker" assetpath="script/"><template><style include="ha-style">:host{display:block;}paper-item{cursor:pointer;}paper-fab{position:fixed;bottom:16px;right:16px;z-index:1;}paper-fab[is-wide]{bottom:24px;right:24px;}a{color:var(--primary-color);}</style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="_backTapped"></paper-icon-button><div main-title="">Scripts</div></app-toolbar></app-header><ha-config-section is-wide="[[isWide]]"><div slot="header">Script Editor</div><div slot="introduction">The script editor allows you to create and edit scripts. Please read <a href="https://home-assistant.io/docs/scripts/editor/" target="_blank">the instructions</a> to make sure that you have configured Home Assistant correctly.</div><paper-card heading="Pick script to edit"><template is="dom-if" if="[[!scripts.length]]"><div class="card-content"><p>We couldn't find any editable scripts.</p></div></template><template is="dom-repeat" items="[[scripts]]" as="script"><paper-item><paper-item-body two-line="" on-tap="scriptTapped"><div>[[computeName(script)]]</div><div secondary="">[[computeDescription(script)]]</div></paper-item-body><iron-icon icon="mdi:chevron-right"></iron-icon></paper-item></template></paper-card></ha-config-section><paper-fab is-wide$="[[isWide]]" icon="mdi:plus" title="Add Script" on-tap="addScript"></paper-fab></app-header-layout></template></dom-module><script>class HaScriptPicker extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-script-picker"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},scripts:{type:Array},isWide:{type:Boolean}}}scriptTapped(e){history.pushState(null,null,"/config/script/edit/"+this.scripts[e.model.index].entity_id),this.fire("location-changed")}addScript(){history.pushState(null,null,"/config/script/new"),this.fire("location-changed")}computeName(e){return window.hassUtil.computeStateName(e)}computeDescription(e){return""}_backTapped(){history.back()}}customElements.define(HaScriptPicker.is,HaScriptPicker);</script><script>!function(){"use strict";function e(e,n){var t,o,a,i,r=N;for(i=arguments.length;i-- >2;)S.push(arguments[i]);for(n&&null!=n.children&&(S.length||S.push(n.children),delete n.children);S.length;)if((o=S.pop())&&void 0!==o.pop)for(i=o.length;i--;)S.push(o[i]);else"boolean"==typeof o&&(o=null),(a="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(a=!1)),a&&t?r[r.length-1]+=o:r===N?r=[o]:r.push(o),t=a;var s=new function(){};return s.nodeName=e,s.children=r,s.attributes=null==n?void 0:n,s.key=null==n?void 0:n.key,void 0!==k.vnode&&k.vnode(s),s}function n(e,n){for(var t in n)e[t]=n[t];return e}function t(e){!e._dirty&&(e._dirty=!0)&&1==P.push(e)&&(k.debounceRendering||T)(o)}function o(){var e,n=P;for(P=[];e=n.pop();)e._dirty&&C(e)}function a(e,n,t){return"string"==typeof n||"number"==typeof n?void 0!==e.splitText:"string"==typeof n.nodeName?!e._componentConstructor&&i(e,n.nodeName):t||e._componentConstructor===n.nodeName}function i(e,n){return e.normalizedNodeName===n||e.nodeName.toLowerCase()===n.toLowerCase()}function r(e){var t=n({},e.attributes);t.children=e.children;var o=e.nodeName.defaultProps;if(void 0!==o)for(var a in o)void 0===t[a]&&(t[a]=o[a]);return t}function s(e){var n=e.parentNode;n&&n.removeChild(e)}function l(e,n,t,o,a){if("className"===n&&(n="class"),"key"===n);else if("ref"===n)t&&t(null),o&&o(e);else if("class"!==n||a)if("style"===n){if(o&&"string"!=typeof o&&"string"!=typeof t||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof t)for(var i in t)i in o||(e.style[i]="");for(var i in o)e.style[i]="number"==typeof o[i]&&!1===D.test(i)?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===n)o&&(e.innerHTML=o.__html||"");else if("o"==n[0]&&"n"==n[1]){var r=n!==(n=n.replace(/Capture$/,""));n=n.toLowerCase().substring(2),o?t||e.addEventListener(n,p,r):e.removeEventListener(n,p,r),(e._listeners||(e._listeners={}))[n]=o}else if("list"!==n&&"type"!==n&&!a&&n in e)!function(e,n,t){try{e[n]=t}catch(e){}}(e,n,null==o?"":o),null!=o&&!1!==o||e.removeAttribute(n);else{var s=a&&n!==(n=n.replace(/^xlink\:?/,""));null==o||!1===o?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",n.toLowerCase()):e.removeAttribute(n):"function"!=typeof o&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",n.toLowerCase(),o):e.setAttribute(n,o))}else e.className=o||""}function p(e){return this._listeners[e.type](k.event&&k.event(e)||e)}function c(){for(var e;e=U.pop();)k.afterMount&&k.afterMount(e),e.componentDidMount&&e.componentDidMount()}function d(e,n,t,o,a,i){A++||(O=null!=a&&void 0!==a.ownerSVGElement,B=null!=e&&!("__preactattr_"in e));var r=u(e,n,t,o,i);return a&&r.parentNode!==a&&a.appendChild(r),--A||(B=!1,i||c()),r}function u(e,n,t,o,p){var c=e,d=O;if(null!=n&&"boolean"!=typeof n||(n=""),"string"==typeof n||"number"==typeof n)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||p)?e.nodeValue!=n&&(e.nodeValue=n):(c=document.createTextNode(n),e&&(e.parentNode&&e.parentNode.replaceChild(c,e),h(e,!0))),c.__preactattr_=!0,c;var f=n.nodeName;if("function"==typeof f)return function(e,n,t,o){for(var a=e&&e._component,i=a,s=e,l=a&&e._componentConstructor===n.nodeName,p=l,c=r(n);a&&!p&&(a=a._parentComponent);)p=a.constructor===n.nodeName;return a&&p&&(!o||a._component)?(m(a,c,3,t,o),e=a.base):(i&&!l&&(b(i),e=s=null),a=v(n.nodeName,c,t),e&&!a.nextBase&&(a.nextBase=e,s=null),m(a,c,1,t,o),e=a.base,s&&e!==s&&(s._component=null,h(s,!1))),e}(e,n,t,o);if(O="svg"===f||"foreignObject"!==f&&O,f=String(f),(!e||!i(e,f))&&(c=function(e,n){var t=O?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return t.normalizedNodeName=e,t}(f),e)){for(;e.firstChild;)c.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(c,e),h(e,!0)}var g=c.firstChild,C=c.__preactattr_,_=n.children;if(null==C){C=c.__preactattr_={};for(var y=c.attributes,x=y.length;x--;)C[y[x].name]=y[x].value}return!B&&_&&1===_.length&&"string"==typeof _[0]&&null!=g&&void 0!==g.splitText&&null==g.nextSibling?g.nodeValue!=_[0]&&(g.nodeValue=_[0]):(_&&_.length||null!=g)&&function(e,n,t,o,i){var r,l,p,c,d,f=e.childNodes,v=[],g={},m=0,C=0,b=f.length,_=0,y=n?n.length:0;if(0!==b)for(S=0;S<b;S++){var x=f[S],w=x.__preactattr_;null!=(k=y&&w?x._component?x._component.__key:w.key:null)?(m++,g[k]=x):(w||(void 0!==x.splitText?!i||x.nodeValue.trim():i))&&(v[_++]=x)}if(0!==y)for(S=0;S<y;S++){d=null;var k=(c=n[S]).key;if(null!=k)m&&void 0!==g[k]&&(d=g[k],g[k]=void 0,m--);else if(!d&&C<_)for(r=C;r<_;r++)if(void 0!==v[r]&&a(l=v[r],c,i)){d=l,v[r]=void 0,r===_-1&&_--,r===C&&C++;break}d=u(d,c,t,o),p=f[S],d&&d!==e&&d!==p&&(null==p?e.appendChild(d):d===p.nextSibling?s(p):e.insertBefore(d,p))}if(m)for(var S in g)void 0!==g[S]&&h(g[S],!1);for(;C<=_;)void 0!==(d=v[_--])&&h(d,!1)}(c,_,t,o,B||null!=C.dangerouslySetInnerHTML),function(e,n,t){var o;for(o in t)n&&null!=n[o]||null==t[o]||l(e,o,t[o],t[o]=void 0,O);for(o in n)"children"===o||"innerHTML"===o||o in t&&n[o]===("value"===o||"checked"===o?e[o]:t[o])||l(e,o,t[o],t[o]=n[o],O)}(c,n.attributes,C),O=d,c}function h(e,n){var t=e._component;t?b(t):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==n&&null!=e.__preactattr_||s(e),f(e))}function f(e){for(e=e.lastChild;e;){var n=e.previousSibling;h(e,!0),e=n}}function v(e,n,t){var o,a=L[e.name];if(e.prototype&&e.prototype.render?(o=new e(n,t),_.call(o,n,t)):((o=new _(n,t)).constructor=e,o.render=g),a)for(var i=a.length;i--;)if(a[i].constructor===e){o.nextBase=a[i].nextBase,a.splice(i,1);break}return o}function g(e,n,t){return this.constructor(e,t)}function m(e,n,o,a,i){e._disable||(e._disable=!0,(e.__ref=n.ref)&&delete n.ref,(e.__key=n.key)&&delete n.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(n,a),a&&a!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=a),e.prevProps||(e.prevProps=e.props),e.props=n,e._disable=!1,0!==o&&(1!==o&&!1===k.syncComponentUpdates&&e.base?t(e):C(e,1,i)),e.__ref&&e.__ref(e))}function C(e,t,o,a){if(!e._disable){var i,s,l,p=e.props,u=e.state,f=e.context,g=e.prevProps||p,_=e.prevState||u,y=e.prevContext||f,x=e.base,w=e.nextBase,S=x||w,N=e._component,T=!1;if(x&&(e.props=g,e.state=_,e.context=y,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(p,u,f)?T=!0:e.componentWillUpdate&&e.componentWillUpdate(p,u,f),e.props=p,e.state=u,e.context=f),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!T){i=e.render(p,u,f),e.getChildContext&&(f=n(n({},f),e.getChildContext()));var D,P,O=i&&i.nodeName;if("function"==typeof O){var B=r(i);(s=N)&&s.constructor===O&&B.key==s.__key?m(s,B,1,f,!1):(D=s,e._component=s=v(O,B,f),s.nextBase=s.nextBase||w,s._parentComponent=e,m(s,B,0,f,!1),C(s,1,o,!0)),P=s.base}else l=S,(D=N)&&(l=e._component=null),(S||1===t)&&(l&&(l._component=null),P=d(l,i,f,o||!x,S&&S.parentNode,!0));if(S&&P!==S&&s!==N){var L=S.parentNode;L&&P!==L&&(L.replaceChild(P,S),D||(S._component=null,h(S,!1)))}if(D&&b(D),e.base=P,P&&!a){for(var W=e,M=e;M=M._parentComponent;)(W=M).base=P;P._component=W,P._componentConstructor=W.constructor}}if(!x||o?U.unshift(e):T||(e.componentDidUpdate&&e.componentDidUpdate(g,_,y),k.afterUpdate&&k.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);A||a||c()}}function b(e){k.beforeUnmount&&k.beforeUnmount(e);var n=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var t=e._component;t?b(t):n&&(n.__preactattr_&&n.__preactattr_.ref&&n.__preactattr_.ref(null),e.nextBase=n,s(n),function(e){var n=e.constructor.name;(L[n]||(L[n]=[])).push(e)}(e),f(n)),e.__ref&&e.__ref(null)}function _(e,n){this._dirty=!0,this.context=n,this.props=e,this.state=this.state||{}}function y(e,n,t){return d(t,e,{},!1,n,!1)}function x(e,n){const t=M({},this.props[e]);n.target.value!==t[n.target.name]&&(n.target.value?t[n.target.name]=n.target.value:delete t[n.target.name],this.props.onChange(this.props.index,t))}function w(e){const n=Object.keys(Q);for(let t=0;t<n.length;t++)if(Q[n[t]].configKey in e)return n[t];return null}var k={},S=[],N=[],T="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,D=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,P=[],U=[],A=0,O=!1,B=!1,L={};n(_.prototype,{setState:function(e,o){var a=this.state;this.prevState||(this.prevState=n({},a)),n(a,"function"==typeof e?e(a,this.props):e),o&&(this._renderCallbacks=this._renderCallbacks||[]).push(o),t(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),C(this,2)},render:function(){}});class W extends _{constructor(e){super(e),this.state.isValid=!0,this.state.value=JSON.stringify(e.value||{},null,2),this.onChange=this.onChange.bind(this)}onChange(e){const n=e.target.value;let t,o;try{t=JSON.parse(n),o=!0}catch(e){o=!1}this.setState({value:n,isValid:o}),o&&this.props.onChange(t)}componentWillReceiveProps({value:e}){this.setState({value:JSON.stringify(e,null,2),isValid:!0})}render({label:n},{value:t,isValid:o}){const a={minWidth:300,width:"100%"};return o||(a.border="1px solid red"),e("paper-textarea",{label:n,value:t,style:a,"onvalue-changed":this.onChange})}}!function(){function e(e){function n(o,a){try{var i=e[o](a),r=i.value;r instanceof function(e){this.value=e}?Promise.resolve(r.value).then(function(e){n("next",e)},function(e){n("throw",e)}):t(i.done?"return":"normal",i.value)}catch(e){t("throw",e)}}function t(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?n(o.key,o.arg):a=null}var o,a;this._invoke=function(e,t){return new Promise(function(i,r){var s={key:e,arg:t,resolve:i,reject:r,next:null};a?a=a.next=s:(o=a=s,n(e,t))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(e){return this._invoke("next",e)},e.prototype.throw=function(e){return this._invoke("throw",e)},e.prototype.return=function(e){return this._invoke("return",e)}}();var M=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};class V extends _{constructor(){super(),this.onChange=x.bind(this,"action"),this.serviceDataChanged=this.serviceDataChanged.bind(this)}serviceDataChanged(e){this.props.onChange(this.props.index,M({},this.props.action,{data:e}))}render({action:n}){const{alias:t,service:o,data:a}=n;return e("div",null,e("paper-input",{label:"Alias",name:"alias",value:t,onChange:this.onChange}),e("paper-input",{label:"Service",name:"service",value:o,onChange:this.onChange}),e(W,{label:"Service Data",value:a,onChange:this.serviceDataChanged}))}}V.configKey="service",V.defaultConfig={alias:"",service:"",data:{}};class E extends _{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:n}){const{entity_id:t,state:o}=n,a=n.for;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:t,onChange:this.onChange}),e("paper-input",{label:"State",name:"state",value:o,onChange:this.onChange}),a&&e("pre",null,"For: ",JSON.stringify(a,null,2)))}}E.defaultConfig={entity_id:"",state:""};class j extends _{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:n}){const{value_template:t,entity_id:o,below:a,above:i}=n;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:o,onChange:this.onChange}),e("paper-input",{label:"Above",name:"above",value:i,onChange:this.onChange}),e("paper-input",{label:"Below",name:"below",value:a,onChange:this.onChange}),e("paper-textarea",{label:"Value template (optional)",name:"value_template",value:t,"onvalue-changed":this.onChange}))}}j.defaultConfig={entity_id:""};class q extends _{constructor(){super(),this.onChange=x.bind(this,"condition"),this.afterPicked=this.radioGroupPicked.bind(this,"after"),this.beforePicked=this.radioGroupPicked.bind(this,"before")}radioGroupPicked(e,n){const t=M({},this.props.condition);n.target.selected?t[e]=n.target.selected:delete t[e],this.props.onChange(this.props.index,t)}render({condition:n}){const{after:t,after_offset:o,before:a,before_offset:i}=n;return e("div",null,e("label",{id:"beforelabel"},"Before:"),e("paper-radio-group",{"allow-empty-selection":!0,selected:a,"aria-labelledby":"beforelabel","onpaper-radio-group-changed":this.beforePicked},e("paper-radio-button",{name:"sunrise"},"Sunrise"),e("paper-radio-button",{name:"sunset"},"Sunset")),e("paper-input",{label:"Before offset (optional)",name:"before_offset",value:i,onChange:this.onChange,disabled:void 0===a}),e("label",{id:"afterlabel"},"After:"),e("paper-radio-group",{"allow-empty-selection":!0,selected:t,"aria-labelledby":"afterlabel","onpaper-radio-group-changed":this.afterPicked},e("paper-radio-button",{name:"sunrise"},"Sunrise"),e("paper-radio-button",{name:"sunset"},"Sunset")),e("paper-input",{label:"After offset (optional)",name:"after_offset",value:o,onChange:this.onChange,disabled:void 0===t}))}}q.defaultConfig={};class z extends _{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:n}){const{value_template:t}=n;return e("div",null,e("paper-textarea",{label:"Value Template",name:"value_template",value:t,"onvalue-changed":this.onChange}))}}z.defaultConfig={value_template:""};class I extends _{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:n}){const{after:t,before:o}=n;return e("div",null,e("paper-input",{label:"After",name:"after",value:t,onChange:this.onChange}),e("paper-input",{label:"Before",name:"before",value:o,onChange:this.onChange}))}}I.defaultConfig={};class H extends _{constructor(){super(),this.onChange=x.bind(this,"condition")}render({condition:n}){const{entity_id:t,zone:o}=n;return e("div",null,e("paper-input",{label:"Entity Id",name:"entity_id",value:t,onChange:this.onChange}),e("paper-input",{label:"Zone entity id",name:"zone",value:o,onChange:this.onChange}))}}H.defaultConfig={entity_id:"",zone:""};const J={state:E,numeric_state:j,sun:q,template:z,time:I,zone:H},K=Object.keys(J).sort();class G extends _{constructor(){super(),this.typeChanged=this.typeChanged.bind(this)}typeChanged(e){const n=e.target.selectedItem.innerHTML;n!==this.props.condition.condition&&this.props.onChange(this.props.index,M({condition:n},J[n].defaultConfig))}render({index:n,condition:t,onChange:o}){const a=J[t.condition],i=K.indexOf(t.condition);return a?e("div",null,e("paper-dropdown-menu-light",{label:"Condition Type","no-animations":!0},e("paper-listbox",{slot:"dropdown-content",selected:i,"oniron-select":this.typeChanged},K.map(n=>e("paper-item",null,n)))),e(a,{index:n,condition:t,onChange:o})):e("div",null,"Unsupported condition: ",t.condition,e("pre",null,JSON.stringify(t,null,2)))}}class R extends _{render({action:n,index:t,onChange:o}){return e(G,{condition:n,onChange:o,index:t})}}R.configKey="condition",R.defaultConfig=M({condition:"state"},E.defaultConfig);class F extends _{constructor(){super(),this.onChange=x.bind(this,"action")}render({action:n}){const{delay:t}=n;return e("div",null,e("paper-input",{label:"Delay",name:"delay",value:t,onChange:this.onChange}))}}F.configKey="delay",F.defaultConfig={delay:""};class $ extends _{constructor(){super(),this.onChange=x.bind(this,"action"),this.serviceDataChanged=this.serviceDataChanged.bind(this)}serviceDataChanged(e){this.props.onChange(this.props.index,M({},this.props.action,{data:e}))}render({action:n}){const{event:t,event_data:o}=n;return e("div",null,e("paper-input",{label:"Event",name:"event",value:t,onChange:this.onChange}),e(W,{label:"Service Data",value:o,onChange:this.serviceDataChanged}))}}$.configKey="event",$.defaultConfig={event:"",event_data:{}};class Z extends _{constructor(){super(),this.onChange=x.bind(this,"action"),this.onTemplateChange=this.onTemplateChange.bind(this)}onTemplateChange(e){this.props.onChange(this.props.index,M({},this.props.trigger,{[e.target.name]:e.target.value}))}render({action:n}){const{wait_template:t,timeout:o}=n;return e("div",null,e("paper-textarea",{label:"Wait Template",name:"wait_template",value:t,"onvalue-changed":this.onTemplateChange}),e("paper-input",{label:"Timeout (Optional)",name:"timeout",value:o,onChange:this.onChange}))}}Z.configKey="wait_template",Z.defaultConfig={wait_template:"",timeout:""};const Q={"Call Service":V,Delay:F,Wait:Z,Condition:R,"Fire Event":$},X=Object.keys(Q).sort();class Y extends _{constructor(){super(),this.typeChanged=this.typeChanged.bind(this)}typeChanged(e){const n=e.target.selectedItem.innerHTML;w(this.props.action)!==n&&this.props.onChange(this.props.index,Q[n].defaultConfig)}render({index:n,action:t,onChange:o}){const a=w(t),i=a&&Q[a],r=X.indexOf(a);return i?e("div",null,e("paper-dropdown-menu-light",{label:"Action Type","no-animations":!0},e("paper-listbox",{slot:"dropdown-content",selected:r,"oniron-select":this.typeChanged},X.map(n=>e("paper-item",null,n)))),e(i,{index:n,action:t,onChange:o})):e("div",null,"Unsupported action",e("pre",null,JSON.stringify(t,null,2)))}}class ee extends _{constructor(){super(),this.onDelete=this.onDelete.bind(this)}onDelete(){confirm("Sure you want to delete?")&&this.props.onChange(this.props.index,null)}render(n){return e("paper-card",null,e("div",{class:"card-menu"},e("paper-menu-button",{"no-animations":!0,"horizontal-align":"right","horizontal-offset":"-5","vertical-offset":"-5"},e("paper-icon-button",{icon:"mdi:dots-vertical",slot:"dropdown-trigger"}),e("paper-listbox",{slot:"dropdown-content"},e("paper-item",{disabled:!0},"Duplicate"),e("paper-item",{onTap:this.onDelete},"Delete")))),e("div",{class:"card-content"},e(Y,n)))}}class ne extends _{constructor(){super(),this.addAction=this.addAction.bind(this),this.actionChanged=this.actionChanged.bind(this)}addAction(){const e=this.props.script.concat({service:""});this.props.onChange(e)}actionChanged(e,n){const t=this.props.script.concat();null===n?t.splice(e,1):t[e]=n,this.props.onChange(t)}render({script:n}){return e("div",{class:"script"},n.map((n,t)=>e(ee,{index:t,action:n,onChange:this.actionChanged})),e("paper-card",null,e("div",{class:"card-actions add-card"},e("paper-button",{onTap:this.addAction},"Add action"))))}}class te extends _{constructor(){super(),this.onChange=this.onChange.bind(this),this.sequenceChanged=this.sequenceChanged.bind(this)}onChange(e){this.props.onChange(M({},this.props.script,{[e.target.name]:e.target.value}))}sequenceChanged(e){this.props.onChange(M({},this.props.script,{sequence:e}))}render({script:n,isWide:t}){const{alias:o,sequence:a}=n;return e("div",null,e("ha-config-section",{"is-wide":t},e("span",{slot:"header"},o),e("span",{slot:"introduction"},"Use scripts to execute a sequence of actions."),e("paper-card",null,e("div",{class:"card-content"},e("paper-input",{label:"Name",name:"alias",value:o,onChange:this.onChange})))),e("ha-config-section",{"is-wide":t},e("span",{slot:"header"},"Sequence"),e("span",{slot:"introduction"},"The sequence of actions of this script.",e("p",null,e("a",{href:"https://home-assistant.io/docs/scripts/",target:"_blank"},"Learn more about available actions."))),e(ne,{script:a,onChange:this.sequenceChanged})))}}window.ScriptEditor=function(n,t,o){return y(e(te,t),n,o)},window.unmountPreact=function(e,n){y(()=>null,e,n)}}();</script><dom-module id="ha-script-editor" assetpath="script/"><template><style include="ha-style">.errors{padding:20px;font-weight:bold;color:var(--google-red-500);}.content{padding-bottom:20px;}paper-card{display:block;}.triggers,
      .script{margin-top:-16px;}.triggers paper-card,
      .script paper-card{margin-top:16px;}.add-card paper-button{display:block;text-align:center;}.card-menu{position:absolute;top:0;right:0;z-index:1;color:var(--primary-text-color);}.card-menu paper-item{cursor:pointer;}span[slot=introduction] a{color:var(--primary-color);}paper-fab{position:fixed;bottom:16px;right:16px;z-index:1;margin-bottom:-80px;transition:margin-bottom .3s;}paper-fab[is-wide]{bottom:24px;right:24px;}paper-fab[dirty]{margin-bottom:0;}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="backTapped"></paper-icon-button><div main-title="">Script [[name]]</div></app-toolbar></app-header><div class="content"><template is="dom-if" if="[[errors]]"><div class="errors">[[errors]]</div></template><div id="root"></div><paper-fab is-wide$="[[isWide]]" dirty$="[[dirty]]" icon="mdi:content-save" title="Save" on-tap="saveScript"></paper-fab></div></ha-app-layout></template></dom-module><script>class HaScriptEditor extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-script-editor"}static get properties(){return{hass:{type:Object},narrow:{type:Boolean},showMenu:{type:Boolean,value:!1},errors:{type:Object,value:null},dirty:{type:Boolean,value:!1},config:{type:Object,value:null},script:{type:Object,observer:"scriptChanged"},creatingNew:{type:Boolean,observer:"creatingNewChanged"},name:{type:String,computed:"computeName(script)"},isWide:{type:Boolean,observer:"isWideChanged"}}}ready(){super.ready(),this.configChanged=this.configChanged.bind(this),this._rendered=null}disconnectedCallback(){super.disconnectedCallback(),this._rendered&&window.unmountPreact(this._rendered)}configChanged(e){null!==this._rendered&&(this.config=e,this.errors=null,this.dirty=!0,this._updateComponent(e))}scriptChanged(e,t){e&&(this.hass?t&&t.entity_id===e.entity_id||this.hass.callApi("get","config/script/config/"+window.hassUtil.computeObjectId(e)).then(function(e){var t=e.sequence;t&&!Array.isArray(t)&&(e.sequence=[t]),this.dirty=!1,this.config=e,this._updateComponent()}.bind(this)):setTimeout(this.scriptChanged.bind(this,e,t),0))}creatingNewChanged(e){e&&(this.dirty=!1,this.config={alias:"New Script",sequence:[{service:"",data:{}}]},this._updateComponent())}isWideChanged(){null!==this.config&&this._updateComponent()}backTapped(){this.dirty&&!confirm("You have unsaved changes. Are you sure you want to leave?")||history.back()}_updateComponent(){this._rendered=window.ScriptEditor(this.$.root,{script:this.config,onChange:this.configChanged,isWide:this.isWide},this._rendered)}saveScript(){var e=this.creatingNew?""+Date.now():window.hassUtil.computeObjectId(this.script);this.hass.callApi("post","config/script/config/"+e,this.config).then(function(){this.dirty=!1,this.creatingNew&&(history.replaceState(null,null,"/config/script/edit/"+e),this.fire("location-changed"))}.bind(this),function(e){throw this.errors=e.body.message,e}.bind(this))}computeName(e){return e&&window.hassUtil.computeStateName(e)}}customElements.define(HaScriptEditor.is,HaScriptEditor);</script><dom-module id="ha-config-script" assetpath="script/"><template><style>ha-script-picker,
      ha-script-editor{height:100%;}</style><app-route route="[[route]]" pattern="/edit/:script" data="{{_routeData}}" active="{{_edittingScript}}"></app-route><app-route route="[[route]]" pattern="/new" active="{{_creatingNew}}"></app-route><template is="dom-if" if="[[!showEditor]]"><ha-script-picker narrow="[[narrow]]" show-menu="[[showMenu]]" scripts="[[scripts]]" is-wide="[[isWide]]"></ha-script-picker></template><template is="dom-if" if="[[showEditor]]" restamp=""><ha-script-editor hass="[[hass]]" script="[[script]]" is-wide="[[isWide]]" creating-new="[[_creatingNew]]"></ha-script-editor></template></template></dom-module><script>class HaConfigScript extends Polymer.Element{static get is(){return"ha-config-script"}static get properties(){return{hass:Object,narrow:Boolean,showMenu:Boolean,route:Object,isWide:Boolean,_routeData:Object,_routeMatches:Boolean,_creatingNew:Boolean,_edittingScript:Boolean,scripts:{type:Array,computed:"computeScripts(hass)"},script:{type:Object,computed:"computeScript(scripts, _edittingScript, _routeData)"},showEditor:{type:Boolean,computed:"computeShowEditor(_edittingScript, _creatingNew)"}}}computeScript(t,e,r){if(!t||!e)return null;for(var o=0;o<t.length;o++)if(t[o].entity_id===r.script)return t[o];return null}computeScripts(t){var e=[];return Object.keys(t.states).forEach(function(r){var o=t.states[r];"script"===window.hassUtil.computeDomain(o)&&e.push(o)}),e.sort(function(t,e){var r=window.hassUtil.computeStateName(t),o=window.hassUtil.computeStateName(e);return r<o?-1:r>o?1:0})}computeShowEditor(t,e){return e||t}}customElements.define(HaConfigScript.is,HaConfigScript);</script><dom-module id="ha-service-description" assetpath="../../src/components/"><template>[[_getDescription(hass, domain, service)]]</template></dom-module><script>class HaServiceDescription extends Polymer.Element{static get is(){return"ha-service-description"}static get properties(){return{hass:Object,domain:String,service:String}}_getDescription(e,i,r){var t=e.config.services[i];if(!t)return"";var s=t[r];return s?s.description:""}}customElements.define(HaServiceDescription.is,HaServiceDescription);</script><dom-module id="ha-form-style"><template><style>.form-group{@apply (--layout-horizontal);@apply (--layout-center);padding:8px 16px;}.form-group label{@apply (--layout-flex-2);}.form-group .form-control{@apply (--layout-flex);}.form-group.vertical{@apply (--layout-vertical);@apply (--layout-start);}paper-dropdown-menu.form-control{margin:-9px 0;}</style></template></dom-module><dom-module id="ozw-log" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{padding-left:24px;padding-right:24px;padding-bottom:24px;}</style><ha-config-section is-wide="[[isWide]]"><span slot="header">OZW Log</span><paper-card><div class="device-picker"><paper-input label="Number of last log lines." type="number" min="0" max="1000" step="10" value="{{numLogLines}}"></paper-input></div><div class="card-actions"><paper-button raised="" on-tap="refreshLog">Refresh</paper-button></div><div class="help-text"><pre>[[ozwLogs]]</pre></div></paper-card></ha-config-section></template></dom-module><script>class OzwLog extends Polymer.Element{static get is(){return"ozw-log"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean,value:!1},ozwLogs:{type:String,value:"Refresh to pull log"},numLogLines:{type:Number,value:0}}}refreshLog(){this.ozwLogs="Loading ozw log...",this.hass.callApi("GET","zwave/ozwlog?lines="+this.numLogLines).then(e=>{this.ozwLogs=e})}}customElements.define(OzwLog.is,OzwLog);</script><dom-module id="zwave-network" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.card-actions.warning ha-call-service-button{color:var(--google-red-500);}.toggle-help-icon{position:absolute;top:-6px;right:0;color:var(--primary-color);}ha-service-description{display:block;color:grey;}[hidden]{display:none;}</style><ha-config-section is-wide="[[isWide]]"><div style="position: relative" slot="header"><span>Z-Wave Network Management</span><paper-icon-button class="toggle-help-icon" on-tap="helpTap" icon="mdi:help-circle"></paper-icon-button></div><span slot="introduction">Run commands that affect the Z-Wave network. You won't get feedback on whether the command succeeded, but you can look in the OZW Log to try to figure out.</span><paper-card class="content"><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="add_node_secure">Add Node Secure</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="add_node_secure" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="add_node">Add Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="add_node" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="remove_node">Remove Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="remove_node" hidden$="[[!showDescription]]"></ha-service-description></div><div class="card-actions warning"><ha-call-service-button hass="[[hass]]" domain="zwave" service="cancel_command">Cancel Command</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="cancel_command" hidden$="[[!showDescription]]"></ha-service-description></div><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="heal_network">Heal Network</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="zwave" service="start_network">Start Network</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="start_network" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="stop_network">Stop Network</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="stop_network" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="soft_reset">Soft Reset</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="soft_reset" hidden$="[[!showDescription]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="test_network">Test Network</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="test_network" hidden$="[[!showDescription]]"></ha-service-description><ha-call-api-button hass="[[hass]]" path="zwave/saveconfig">Save Config</ha-call-api-button></div></paper-card></ha-config-section></template></dom-module><script>class ZwaveNetwork extends Polymer.Element{static get is(){return"zwave-network"}static get properties(){return{hass:{type:Object},isWide:{type:Boolean,value:!1},showDescription:{type:Boolean,value:!1}}}helpTap(){this.showDescription=!this.showDescription}}customElements.define(ZwaveNetwork.is,ZwaveNetwork);</script><dom-module id="zwave-node-information" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}.node-info{margin-left:16px;}paper-card{display:block;margin:0 auto;max-width:600px;}paper-button[toggles][active]{background:lightgray;}</style><div class="content"><paper-card heading="Node Information"><div class="card-actions"><paper-button toggles="" raised="" noink="" active="{{nodeInfoActive}}">Show</paper-button></div><template is="dom-if" if="{{nodeInfoActive}}"><template is="dom-repeat" items="[[selectedNodeAttrs]]" as="state"><div class="node-info"><span>[[state]]</span></div></template></template></paper-card></div></template></dom-module><script>class ZwaveNodeInformation extends Polymer.Element{static get is(){return"zwave-node-information"}static get properties(){return{nodes:{type:Array,observer:"nodeChanged"},selectedNode:{type:Number,value:-1,observer:"nodeChanged"},selectedNodeAttrs:{type:Array},nodeInfoActive:{type:Boolean}}}nodeChanged(e){if(this.nodes&&-1!==e){var t=this.nodes[this.selectedNode].attributes,o=[];Object.keys(t).forEach(function(e){o.push(e+": "+t[e])}),this.selectedNodeAttrs=o.sort()}}}customElements.define(ZwaveNodeInformation.is,ZwaveNodeInformation);</script><dom-module id="zwave-values" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply (--layout-horizontal);@apply (--layout-center-center);padding-left:24px;padding-right:24px;padding-bottom:24px;}.help-text{padding-left:24px;padding-right:24px;}</style><div class="content"><paper-card heading="Node Values"><div class="device-picker"><paper-dropdown-menu label="Value" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedValue}}"><template is="dom-repeat" items="[[values]]" as="item"><paper-item>[[computeSelectCaption(item)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[!computeIsValueSelected(selectedValue)]]"><div class="card-actions"><paper-input float-label="Value Name" type="text" value="{{newValueNameInput}}" placeholder="[[computeGetValueName(selectedValue)]]"></paper-input><ha-call-service-button hass="[[hass]]" domain="zwave" service="rename_value" service-data="[[computeValueNameServiceData(newValueNameInput)]]">Rename Value</ha-call-service-button></div></template></paper-card></div></template></dom-module><script>class ZwaveValues extends Polymer.Element{static get is(){return"zwave-values"}static get properties(){return{hass:{type:Object},nodes:{type:Array},values:{type:Array},selectedNode:{type:Number},selectedValue:{type:Number,value:-1,observer:"selectedValueChanged"}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){var t=this;e.detail.success&&setTimeout(function(){t.refreshValues(t.selectedNode)},5e3)}computeSelectCaption(e){return e.value.label+" (Instance: "+e.value.instance+", Index: "+e.value.index+")"}computeGetValueName(e){return this.values[e].value.label}computeIsValueSelected(e){return!this.nodes||-1===this.selectedNode||-1===e}refreshValues(e){var t=[];this.hass.callApi("GET","zwave/values/"+this.nodes[e].attributes.node_id).then(function(e){Object.keys(e).forEach(function(s){t.push({key:s,value:e[s]})}),this.values=t,this.selectedValueChanged(this.selectedValue)}.bind(this))}computeValueNameServiceData(e){return-1===!this.selectedNode||-1===this.selectedValue?-1:{node_id:this.nodes[this.selectedNode].attributes.node_id,value_id:this.values[this.selectedValue].key,name:e}}selectedValueChanged(e){if(-1!==!this.selectedNode&&-1!==this.selectedValue){var t=this;this.hass.callApi("GET","config/zwave/device_config/"+this.values[e].value.entity_id).then(function(s){t.entityIgnored=s.ignored||!1,t.entityPollingIntensity=t.values[e].value.poll_intensity})}}}customElements.define(ZwaveValues.is,ZwaveValues);</script><dom-module id="zwave-groups" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply (--layout-horizontal);@apply (--layout-center-center);padding-left:24px;padding-right:24px;padding-bottom:24px;}.help-text{padding-left:24px;padding-right:24px;padding-bottom:12px;}</style><paper-card class="content" heading="Node group associations"><div class="device-picker"><paper-dropdown-menu label="Group" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedGroup}}"><template is="dom-repeat" items="[[groups]]" as="state"><paper-item>[[computeSelectCaptionGroup(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[computeIsGroupSelected(selectedGroup)]]"><div class="device-picker"><paper-dropdown-menu label="Node to control" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedTargetNode}}"><template is="dom-repeat" items="[[nodes]]" as="state"><paper-item>[[computeSelectCaption(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><div class="help-text"><span>Other Nodes in this group:</span><template is="dom-repeat" items="[[otherGroupNodes]]" as="state"><div>[[state]]</div></template></div><div class="help-text"><span>Max Associations:</span> <span>[[maxAssociations]]</span></div></template><template is="dom-if" if="[[computeIsTargetNodeSelected(selectedTargetNode)]]"><div class="card-actions"><template is="dom-if" if="[[!noAssociationsLeft]]"><ha-call-service-button hass="[[hass]]" domain="zwave" service="change_association" service-data="[[computeAssocServiceData(selectedGroup, &quot;add&quot;)]]">Add To Group</ha-call-service-button></template><template is="dom-if" if="[[computeTargetInGroup(selectedGroup, selectedTargetNode)]]"><ha-call-service-button hass="[[hass]]" domain="zwave" service="change_association" service-data="[[computeAssocServiceData(selectedGroup, &quot;remove&quot;)]]">Remove From Group</ha-call-service-button></template></div></template></paper-card></template></dom-module><script>class ZwaveGroups extends Polymer.Element{static get is(){return"zwave-groups"}static get properties(){return{hass:{type:Object},nodes:{type:Array},groups:{type:Array},selectedNode:{type:Number},selectedTargetNode:{type:Number,value:-1},selectedGroup:{type:Number,value:-1,observer:"selectedGroupChanged"},otherGroupNodes:{type:Array,value:-1,computed:"computeOtherGroupNodes(selectedGroup)"},maxAssociations:{type:String,value:"",computed:"computeMaxAssociations(selectedGroup)"},noAssociationsLeft:{type:Boolean,value:!0,computed:"computeAssociationsLeft(selectedGroup)"}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){if(e.detail.success){var t=this;setTimeout(function(){t.refreshGroups(t.selectedNode)},5e3)}}computeAssociationsLeft(e){return-1===e||this.maxAssociations===this.otherGroupNodes.length}computeMaxAssociations(e){if(-1===e)return-1;var t=this.groups[e].value.max_associations;return t||"None"}computeOtherGroupNodes(e){if(-1===e)return-1;var t=Object.values(this.groups[e].value.association_instances);return t.length?t.map(e=>{if(!e.length||2!==e.length)return"Unknown Node: "+e;const t=e[0],s=e[1],o=this.nodes.find(e=>e.attributes.node_id===t);if(!o)return"Unknown Node (id: "+(s?t+"."+s:t)+")";let r=this.computeSelectCaption(o);return s&&(r+="/ Instance: "+s),r}):["None"]}computeTargetInGroup(e,t){if(-1===e||-1===t)return!1;const s=Object.values(this.groups[e].value.associations);return!!s.length&&-1!==s.indexOf(this.nodes[t].attributes.node_id)}computeSelectCaption(e){return window.hassUtil.computeStateName(e)+" (Node:"+e.attributes.node_id+" "+e.attributes.query_stage+")"}computeSelectCaptionGroup(e){return e.key+": "+e.value.label}computeIsTargetNodeSelected(e){return this.nodes&&-1!==e}computeIsGroupSelected(e){return this.nodes&&-1!==this.selectedNode&&-1!==e}computeAssocServiceData(e,t){return-1===!this.groups||-1===e||-1===this.selectedNode?-1:{node_id:this.nodes[this.selectedNode].attributes.node_id,association:t,target_node_id:this.nodes[this.selectedTargetNode].attributes.node_id,group:this.groups[e].key}}refreshGroups(e){var t=[];this.hass.callApi("GET","zwave/groups/"+this.nodes[e].attributes.node_id).then(function(e){Object.keys(e).forEach(function(s){t.push({key:s,value:e[s]})}),this.groups=t,this.selectedGroupChanged(this.selectedGroup)}.bind(this))}selectedGroupChanged(e){-1!==this.selectedGroup&&-1!==e&&(this.maxAssociations=this.groups[e].value.max_associations,this.otherGroupNodes=Object.values(this.groups[e].value.associations))}}customElements.define(ZwaveGroups.is,ZwaveGroups);</script><dom-module id="zwave-node-config" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply (--layout-horizontal);@apply (--layout-center-center);padding-left:24px;padding-right:24px;padding-bottom:24px;}.help-text{padding-left:24px;padding-right:24px;}</style><div class="content"><paper-card heading="Node config options"><template is="dom-if" if="[[wakeupNode]]"><div class="card-actions"><paper-input float-label="Wakeup Interval" type="number" value="{{wakeupInput}}" placeholder="[[computeGetWakeupValue(selectedNode)]]"><div suffix="">seconds</div></paper-input><ha-call-service-button hass="[[hass]]" domain="zwave" service="set_wakeup" service-data="[[computeWakeupServiceData(wakeupInput)]]">Set Wakeup</ha-call-service-button></div></template><div class="device-picker"><paper-dropdown-menu label="Config parameter" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedConfigParameter}}"><template is="dom-repeat" items="[[config]]" as="state"><paper-item>[[computeSelectCaptionConfigParameter(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[isConfigParameterSelected(selectedConfigParameter, 'List')]]"><div class="device-picker"><paper-dropdown-menu label="Config value" dynamic-align="" class="flex" placeholder="{{loadedConfigValue}}"><paper-listbox slot="dropdown-content" selected="{{selectedConfigValue}}"><template is="dom-repeat" items="[[selectedConfigParameterValues]]" as="state"><paper-item>[[state]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></template><template is="dom-if" if="[[isConfigParameterSelected(selectedConfigParameter, 'Byte Short Int')]]"><div class="card-actions"><paper-input label="{{selectedConfigParameterNumValues}}" type="number" value="{{selectedConfigValue}}" max="{{configParameterMax}}" min="{{configParameterMin}}"></paper-input></div></template><template is="dom-if" if="[[isConfigParameterSelected(selectedConfigParameter, 'Bool Button')]]"><div class="device-picker"><paper-dropdown-menu label="Config value" class="flex" dynamic-align="" placeholder="{{loadedConfigValue}}"><paper-listbox slot="dropdown-content" selected="{{selectedConfigValue}}"><template is="dom-repeat" items="[[selectedConfigParameterValues]]" as="state"><paper-item>[[state]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></template><div class="help-text"><span>[[configValueHelpText]]</span></div><template is="dom-if" if="[[isConfigParameterSelected(selectedConfigParameter, 'Bool Button Byte Short Int List')]]"><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="set_config_parameter" service-data="[[computeSetConfigParameterServiceData(selectedConfigValue)]]">Set Config Parameter</ha-call-service-button></div></template></paper-card></div></template></dom-module><script>class ZwaveNodeConfig extends Polymer.Element{static get is(){return"zwave-node-config"}static get properties(){return{hass:{type:Object},nodes:{type:Array,observer:"nodesChanged"},selectedNode:{type:Number,value:-1,observer:"nodesChanged"},config:{type:Array,value:function(){return[]}},selectedConfigParameter:{type:Number,value:-1,observer:"selectedConfigParameterChanged"},configParameterMax:{type:Number,value:-1},configParameterMin:{type:Number,value:-1},configValueHelpText:{type:String,value:"",computed:"computeConfigValueHelp(selectedConfigParameter)"},selectedConfigParameterType:{type:String,value:""},selectedConfigValue:{type:Number,value:-1,observer:"computeSetConfigParameterServiceData"},selectedConfigParameterValues:{type:Array,value:function(){return[]}},selectedConfigParameterNumValues:{type:String,value:""},loadedConfigValue:{type:Number,value:-1},wakeupInput:{type:Number},wakeupNode:{type:Boolean,value:!1}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){if(e.detail.success){var t=this;setTimeout(function(){t.refreshConfig(t.selectedNode)},5e3)}}nodesChanged(){this.nodes&&(this.wakeupNode=0===this.nodes[this.selectedNode].attributes.wake_up_interval||this.nodes[this.selectedNode].attributes.wake_up_interval,this.wakeupNode&&(0===this.nodes[this.selectedNode].attributes.wake_up_interval?this.wakeupInput="":this.wakeupInput=this.nodes[this.selectedNode].attributes.wake_up_interval))}computeGetWakeupValue(e){return-1!==this.selectedNode&&this.nodes[e].attributes.wake_up_interval?this.nodes[e].attributes.wake_up_interval:"unknown"}computeWakeupServiceData(e){return{node_id:this.nodes[this.selectedNode].attributes.node_id,value:e}}computeConfigValueHelp(e){if(-1===e)return"";var t=this.config[e].value.help;return t||["No helptext available"]}computeSetConfigParameterServiceData(e){if(-1===this.selectedNode||-1===this.selectedConfigParameter)return-1;var t=null;return"Short Byte Int".includes(this.selectedConfigParameterType)&&(t=parseInt(e,10)),"Bool Button".includes(this.selectedConfigParameterType)&&(t=this.selectedConfigParameterValues[e]),"List"===this.selectedConfigParameterType&&(t=this.selectedConfigParameterValues[e]),{node_id:this.nodes[this.selectedNode].attributes.node_id,parameter:this.config[this.selectedConfigParameter].key,value:t}}selectedConfigParameterChanged(e){-1!==e&&(this.selectedConfigValue=-1,this.loadedConfigValue=-1,this.selectedConfigParameterValues=[],this.selectedConfigParameterType=this.config[e].value.type,this.configParameterMax=this.config[e].value.max,this.configParameterMin=this.config[e].value.min,this.loadedConfigValue=this.config[e].value.data,this.configValueHelpText=this.config[e].value.help,"Short Byte Int".includes(this.selectedConfigParameterType)&&(this.selectedConfigParameterNumValues=this.config[e].value.data_items,this.selectedConfigValue=this.loadedConfigValue),"Bool Button".includes(this.selectedConfigParameterType)&&(this.selectedConfigParameterValues=["True","False"],this.config[e].value.data?this.loadedConfigValue="True":this.loadedConfigValue="False"),"List".includes(this.selectedConfigParameterType)&&(this.selectedConfigParameterValues=this.config[e].value.data_items))}isConfigParameterSelected(e,t){return-1!==e&&(this.config[e].value.type===t||!!t.includes(this.config[e].value.type))}computeSelectCaptionConfigParameter(e){return e.key+": "+e.value.label}refreshConfig(e){var t=[];this.hass.callApi("GET","zwave/config/"+this.nodes[e].attributes.node_id).then(function(e){Object.keys(e).forEach(function(a){t.push({key:a,value:e[a]})}),this.config=t,this.selectedConfigParameterChanged(this.selectedConfigParameter)}.bind(this))}}customElements.define(ZwaveNodeConfig.is,ZwaveNodeConfig);</script><dom-module id="zwave-usercodes" assetpath="zwave/"><template><style include="iron-flex ha-style">.content{margin-top:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply (--layout-horizontal);@apply (--layout-center-center);padding-left:24px;padding-right:24px;padding-bottom:24px;}</style><div class="content"><paper-card heading="Node user codes"><div class="device-picker"><paper-dropdown-menu label="Code slot" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedUserCode}}"><template is="dom-repeat" items="[[userCodes]]" as="state"><paper-item>[[computeSelectCaptionUserCodes(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[isUserCodeSelected(selectedUserCode)]]"><div class="card-actions"><paper-input label="User code" type="number" value="{{selectedUserCodeValue}}" maxlength="{{userCodeMaxLen}}" min="0"></paper-input></div><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="lock" service="set_usercode" service-data="[[computeUserCodeServiceData(selectedUserCodeValue, &quot;Add&quot;)]]">Set Usercode</ha-call-service-button><ha-call-service-button hass="[[hass]]" domain="lock" service="clear_usercode" service-data="[[computeUserCodeServiceData(selectedUserCode, &quot;Delete&quot;)]]">Delete Usercode</ha-call-service-button></div></template></paper-card></div></template></dom-module><script>class ZwaveUsercodes extends Polymer.Element{static get is(){return"zwave-usercodes"}static get properties(){return{hass:{type:Object},nodes:{type:Array},selectedNode:{type:Number},userCodes:{type:Object},userCodeMaxLen:{type:Number,value:4},selectedUserCode:{type:Number,value:-1,observer:"selectedUserCodeChanged"},selectedUserCodeValue:{type:Number,value:-1}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){if(e.detail.success){var s=this;setTimeout(function(){s.refreshUserCodes(s.selectedNode)},5e3)}}isUserCodeSelected(e){return-1!==e}computeSelectCaptionUserCodes(e){return e.key+": "+e.value.label}selectedUserCodeChanged(e){if(-1!==this.selectedUserCode&&-1!==e){var s=parseInt(this.userCodes[e].value.code.trim());this.userCodeMaxLen=this.userCodes[e].value.length,isNaN(s)?this.selectedUserCodeValue="":this.selectedUserCodeValue=s}}computeUserCodeServiceData(e,s){if(-1===this.selectedNode||!e)return-1;var t=null,d=null;return"Add"===s&&(d=e,t={node_id:this.nodes[this.selectedNode].attributes.node_id,code_slot:this.selectedUserCode,usercode:d}),"Delete"===s&&(t={node_id:this.nodes[this.selectedNode].attributes.node_id,code_slot:this.selectedUserCode}),t}refreshUserCodes(e){this.selectedUserCodeValue="";var s=[];this.hass.callApi("GET","zwave/usercodes/"+this.nodes[e].attributes.node_id).then(function(e){Object.keys(e).forEach(function(t){s.push({key:t,value:e[t]})}),this.userCodes=s,this.selectedUserCodeChanged(this.selectedUserCode)}.bind(this))}}customElements.define(ZwaveUsercodes.is,ZwaveUsercodes);</script><dom-module id="ha-config-zwave" assetpath="zwave/"><template><style include="iron-flex ha-style ha-form-style">.content{margin-top:24px;}.node-info{margin-left:16px;}.help-text{padding-left:24px;padding-right:24px;}paper-card{display:block;margin:0 auto;max-width:600px;}.device-picker{@apply (--layout-horizontal);@apply (--layout-center-center);padding-left:24px;padding-right:24px;padding-bottom:24px;}ha-service-description{display:block;color:grey;}[hidden]{display:none;}.toggle-help-icon{position:absolute;top:6px;right:0;color:var(--primary-color);}</style><ha-app-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="_backTapped"></paper-icon-button><div main-title="">Z-Wave Manager</div></app-toolbar></app-header><zwave-network id="zwave-network" is-wide="[[isWide]]" hass="[[hass]]"></zwave-network><ha-config-section is-wide="[[isWide]]"><div style="position: relative" slot="header"><span>Z-Wave Node Management</span><paper-icon-button class="toggle-help-icon" on-tap="toggleHelp" icon="mdi:help-circle"></paper-icon-button></div><span slot="introduction">Run Z-Wave commands that affect a single node. Pick a node to see a list of available commands.</span><paper-card class="content"><div class="device-picker"><paper-dropdown-menu dynamic-align="" label="Nodes" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedNode}}"><template is="dom-repeat" items="[[nodes]]" as="state"><paper-item>[[computeSelectCaption(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[!computeIsNodeSelected(selectedNode)]]"><template is="dom-if" if="[[showHelp]]"><div style="color: grey; padding: 12px">Select node to view per-node options</div></template></template><template is="dom-if" if="[[computeIsNodeSelected(selectedNode)]]"><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="refresh_node" service-data="[[computeNodeServiceData(selectedNode)]]">Refresh Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="refresh_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="remove_failed_node" service-data="[[computeNodeServiceData(selectedNode)]]">Remove Failed Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="remove_failed_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="replace_failed_node" service-data="[[computeNodeServiceData(selectedNode)]]">Replace Failed Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="replace_failed_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="print_node" service-data="[[computeNodeServiceData(selectedNode)]]">Print Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="print_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="heal_node" service-data="[[computeHealNodeServiceData(selectedNode)]]">Heal Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="heal_node" hidden$="[[!showHelp]]"></ha-service-description><ha-call-service-button hass="[[hass]]" domain="zwave" service="test_node" service-data="[[computeNodeServiceData(selectedNode)]]">Test Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="test_node" hidden$="[[!showHelp]]"></ha-service-description></div><div class="card-actions"><paper-input float-label="New node name" type="text" value="{{newNodeNameInput}}" placeholder="[[computeGetNodeName(selectedNode)]]"></paper-input><ha-call-service-button hass="[[hass]]" domain="zwave" service="rename_node" service-data="[[computeNodeNameServiceData(newNodeNameInput)]]">Rename Node</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="rename_node" hidden$="[[!showHelp]]"></ha-service-description></div><div class="device-picker"><paper-dropdown-menu label="Entities of this node" dynamic-align="" class="flex"><paper-listbox slot="dropdown-content" selected="{{selectedEntity}}"><template is="dom-repeat" items="[[entities]]" as="state"><paper-item>[[computeSelectCaptionEnt(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><template is="dom-if" if="[[!computeIsEntitySelected(selectedEntity)]]"><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="refresh_entity" service-data="[[computeRefreshEntityServiceData(selectedEntity)]]">Refresh Entity</ha-call-service-button><ha-service-description hass="[[hass]]" domain="zwave" service="refresh_entity" hidden$="[[!showHelp]]"></ha-service-description></div><div class="form-group"><paper-checkbox checked="{{entityIgnored}}" class="form-control">Exclude this entity from Home Assistant</paper-checkbox><paper-input disabled="{{entityIgnored}}" label="Polling intensity" type="number" min="0" value="{{entityPollingIntensity}}"></paper-input></div><div class="card-actions"><ha-call-service-button hass="[[hass]]" domain="zwave" service="set_poll_intensity" service-data="[[computePollIntensityServiceData(entityPollingIntensity)]]">Save</ha-call-service-button></div><div class="content"><div class="card-actions"><paper-button toggles="" raised="" noink="" active="{{entityInfoActive}}">Entity Attributes</paper-button></div><template is="dom-if" if="{{entityInfoActive}}"><template is="dom-repeat" items="[[selectedEntityAttrs]]" as="state"><div class="node-info"><span>[[state]]</span></div></template></template></div></template></template></paper-card><template is="dom-if" if="[[computeIsNodeSelected(selectedNode)]]"><zwave-node-information id="zwave-node-information" nodes="[[nodes]]" selected-node="[[selectedNode]]"></zwave-node-information><zwave-values hass="[[hass]]" nodes="[[nodes]]" selected-node="[[selectedNode]]" values="[[values]]"></zwave-values><zwave-groups hass="[[hass]]" nodes="[[nodes]]" selected-node="[[selectedNode]]" groups="[[groups]]"></zwave-groups><zwave-node-config hass="[[hass]]" nodes="[[nodes]]" selected-node="[[selectedNode]]" config="[[config]]"></zwave-node-config></template></ha-config-section><template is="dom-if" if="{{hasNodeUserCodes}}"><zwave-usercodes id="zwave-usercodes" hass="[[hass]]" nodes="[[nodes]]" user-codes="[[userCodes]]" selected-node="[[selectedNode]]"></zwave-usercodes></template><ozw-log is-wide="[[isWide]]" hass="[[hass]]"></ozw-log></ha-app-layout></template></dom-module><script>class HaConfigZwave extends Polymer.Element{static get is(){return"ha-config-zwave"}static get properties(){return{hass:Object,isWide:Boolean,nodes:{type:Array,computed:"computeNodes(hass)"},selectedNode:{type:Number,value:-1,observer:"selectedNodeChanged"},config:{type:Array,value:function(){return[]}},entities:{type:Array,computed:"computeEntities(selectedNode)"},entityInfoActive:{type:Boolean},selectedEntity:{type:Number,value:-1,observer:"selectedEntityChanged"},selectedEntityAttrs:{type:Array,computed:"computeSelectedEntityAttrs(selectedEntity)"},values:{type:Array},groups:{type:Array},newNodeNameInput:{type:String},userCodes:{type:Array,value:function(){return[]}},hasNodeUserCodes:{type:Boolean,value:!1},showHelp:{type:Boolean,value:!1},entityIgnored:{type:Boolean},entityPollingIntensity:{type:Number}}}ready(){super.ready(),this.addEventListener("hass-service-called",e=>this.serviceCalled(e))}serviceCalled(e){var t=this;e.detail.success&&"set_poll_intensity"===e.detail.service&&t.saveEntity()}computeNodes(e){return Object.keys(e.states).map(function(t){return e.states[t]}).filter(function(e){return!e.attributes.hidden&&e.entity_id.match("zwave[.]")}).sort(window.hassUtil.sortByName)}computeEntities(e){if(!this.nodes||-1===e)return-1;var t=this.hass,s=this.nodes[this.selectedNode].attributes.node_id;return Object.keys(t.states).map(function(e){return t.states[e]}).filter(function(e){return void 0!==e.attributes.node_id&&(!e.attributes.hidden&&"node_id"in e.attributes&&e.attributes.node_id===s&&!e.entity_id.match("zwave[.]"))}).sort(window.hassUtil.sortByName)}selectedNodeChanged(e){this.newNodeNameInput="",-1!==e&&(this.selectedConfigParameter=-1,this.selectedConfigParameterValue=-1,this.selectedGroup=-1,this.hass.callApi("GET","zwave/config/"+this.nodes[e].attributes.node_id).then(e=>{this.config=this._objToArray(e)}),this.hass.callApi("GET","zwave/values/"+this.nodes[e].attributes.node_id).then(e=>{this.values=this._objToArray(e)}),this.hass.callApi("GET","zwave/groups/"+this.nodes[e].attributes.node_id).then(e=>{this.groups=this._objToArray(e)}),this.hasNodeUserCodes=!1,this.notifyPath("hasNodeUserCodes"),this.hass.callApi("GET","zwave/usercodes/"+this.nodes[e].attributes.node_id).then(e=>{this.userCodes=this._objToArray(e),this.hasNodeUserCodes=this.userCodes.length>0,this.notifyPath("hasNodeUserCodes")}))}selectedEntityChanged(e){if(-1!==e){var t=this;t.hass.callApi("GET","zwave/values/"+t.nodes[t.selectedNode].attributes.node_id).then(e=>{t.values=t._objToArray(e)});var s=t.entities[e].attributes.value_id,i=t.values.find(function(e){return e.key===s}),n=t.values.indexOf(i);t.hass.callApi("GET","config/zwave/device_config/"+s).then(function(e){t.entityIgnored=e.ignored||!1,t.entityPollingIntensity=t.values[n].value.poll_intensity})}}computeSelectedEntityAttrs(e){if(-1===e)return"No entity selected";var t=this.entities[e].attributes,s=[];return Object.keys(t).forEach(function(e){s.push(e+": "+t[e])}),s.sort()}computeSelectCaption(e){return window.hassUtil.computeStateName(e)+" (Node:"+e.attributes.node_id+" "+e.attributes.query_stage+")"}computeSelectCaptionEnt(e){return window.hassUtil.computeDomain(e)+"."+window.hassUtil.computeStateName(e)}computeIsNodeSelected(){return this.nodes&&-1!==this.selectedNode}computeIsEntitySelected(e){return-1===e}computeNodeServiceData(e){return{node_id:this.nodes[e].attributes.node_id}}computeHealNodeServiceData(e){return{node_id:this.nodes[e].attributes.node_id,return_routes:!0}}computeGetNodeName(e){return-1!==this.selectedNode&&this.nodes[e].entity_id?this.nodes[e].attributes.node_name:-1}computeNodeNameServiceData(e){return{node_id:this.nodes[this.selectedNode].attributes.node_id,name:e}}computeRefreshEntityServiceData(e){return-1===e?-1:{entity_id:this.entities[e].entity_id}}computePollIntensityServiceData(e){return-1===!this.selectedNode||-1===this.selectedEntity?-1:{node_id:this.nodes[this.selectedNode].attributes.node_id,value_id:this.entities[this.selectedEntity].attributes.value_id,poll_intensity:parseInt(e)}}saveEntity(){var e={ignored:this.entityIgnored,polling_intensity:parseInt(this.entityPollingIntensity)};return this.hass.callApi("POST","config/zwave/device_config/"+this.entities[this.selectedEntity].entity_id,e)}toggleHelp(){this.showHelp=!this.showHelp}_objToArray(e){var t=[];return Object.keys(e).forEach(function(s){t.push({key:s,value:e[s]})}),t}_backTapped(){history.back()}}customElements.define(HaConfigZwave.is,HaConfigZwave);</script><dom-module id="ha-customize-array" assetpath="customize/types/"><template><style>paper-dropdown-menu{margin:-9px 0;}</style><paper-dropdown-menu label="[[item.description]]" disabled="[[item.secondary]]" selected-item-label="{{item.value}}" dynamic-align=""><paper-listbox slot="dropdown-content" selected="[[computeSelected(item)]]"><template is="dom-repeat" items="[[getOptions(item)]]" as="option"><paper-item>[[option]]</paper-item></template></paper-listbox></paper-dropdown-menu></template></dom-module><script>class HaCustomizeArray extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-customize-array"}static get properties(){return{item:{type:Object,notifies:!0}}}getOptions(t){const e=t.domain||"*",i=t.options[e]||t.options["*"];return i?i.sort():(this.item.type="string",this.fire("item-changed"),[])}computeSelected(t){return this.getOptions(t).indexOf(t.value)}}customElements.define(HaCustomizeArray.is,HaCustomizeArray);</script><dom-module id="ha-customize-boolean" assetpath="customize/types/"><template><paper-checkbox disabled="[[item.secondary]]" checked="{{item.value}}">[[item.description]]</paper-checkbox></template></dom-module><script>class HaCustomizeBoolean extends Polymer.Element{static get is(){return"ha-customize-boolean"}static get properties(){return{item:{type:Object,notifies:!0}}}}customElements.define(HaCustomizeBoolean.is,HaCustomizeBoolean);</script><dom-module id="ha-customize-icon" assetpath="customize/types/"><template><style>:host{@apply (--layout-horizontal);}.icon-image{border:1px solid grey;padding:8px;margin-right:20px;margin-top:10px;}</style><iron-icon class="icon-image" icon="[[item.value]]"></iron-icon><paper-input auto-validate="" pattern="(mdi:.*)?" error-message="Must start with 'mdi:'" disabled="[[item.secondary]]" label="icon" value="{{item.value}}"></paper-input></template></dom-module><script>class HaCustomizeIcon extends Polymer.Element{static get is(){return"ha-customize-icon"}static get properties(){return{item:{type:Object,notifies:!0}}}}customElements.define(HaCustomizeIcon.is,HaCustomizeIcon);</script><dom-module id="ha-customize-key-value" assetpath="customize/types/"><template><style>:host{@apply (--layout-horizontal);}paper-input{@apply (--layout-flex);}.key{padding-right:20px;}</style><paper-input disabled="[[item.secondary]]" class="key" label="Attribute name" value="{{item.attribute}}"></paper-input><paper-input disabled="[[item.secondary]]" label="Attribute value" value="{{item.value}}"></paper-input></template></dom-module><script>class HaCustomizeKeyValue extends Polymer.Element{static get is(){return"ha-customize-key-value"}static get properties(){return{item:{type:Object,notifies:!0}}}}customElements.define(HaCustomizeKeyValue.is,HaCustomizeKeyValue);</script><dom-module id="ha-customize-string" assetpath="customize/types/"><template><paper-input disabled="[[item.secondary]]" label="[[getLabel(item)]]" value="{{item.value}}"></paper-input></template></dom-module><script>class HaCustomizeString extends Polymer.Element{static get is(){return"ha-customize-string"}static get properties(){return{item:{type:Object,notifies:!0}}}getLabel(t){return t.description+("json"===t.type?" (JSON formatted)":"")}}customElements.define(HaCustomizeString.is,HaCustomizeString);</script><dom-module id="ha-customize-attribute" assetpath="customize/"><template><style include="ha-form-style">:host{display:block;position:relative;padding-right:40px;}.button{position:absolute;margin-top:-20px;top:50%;right:0;}</style><div id="wrapper" class="form-group"></div><paper-icon-button class="button" icon="[[getIcon(item.secondary)]]" on-tap="tapButton"></paper-icon-button></template></dom-module><script>class HaCustomizeAttribute extends Polymer.Element{static get is(){return"ha-customize-attribute"}static get properties(){return{item:{type:Object,notify:!0,observer:"itemObserver"}}}tapButton(){this.item.secondary?this.item=Object.assign({},this.item,{secondary:!1}):this.item=Object.assign({},this.item,{closed:!0})}getIcon(t){return t?"mdi:pencil":"mdi:close"}itemObserver(t){const e=this.$.wrapper,i=window.hassAttributeUtil.TYPE_TO_TAG[t.type].toUpperCase();let s;e.lastChild&&e.lastChild.tagName===i?s=e.lastChild:(e.lastChild&&e.removeChild(e.lastChild),this.$.child=s=document.createElement(i.toLowerCase()),s.className="form-control",s.addEventListener("item-changed",()=>{this.item=Object.assign({},s.item)})),s.setProperties({item:this.item}),null===s.parentNode&&e.appendChild(s)}}customElements.define(HaCustomizeAttribute.is,HaCustomizeAttribute);</script><dom-module id="ha-form-customize-attributes" assetpath="customize/"><template><style>[hidden]{display:none;}</style><template is="dom-repeat" items="{{attributes}}" mutable-data=""><ha-customize-attribute item="{{item}}" hidden$="[[item.closed]]"></ha-customize-attribute></template></template></dom-module><script>class HaFormCustomizeAttributes extends(Polymer.MutableData(Polymer.Element)){static get is(){return"ha-form-customize-attributes"}static get properties(){return{attributes:{type:Array,notify:!0}}}}customElements.define(HaFormCustomizeAttributes.is,HaFormCustomizeAttributes);</script><dom-module id="ha-form-customize" assetpath="customize/"><template><style include="iron-flex ha-style ha-form-style">.warning{color:red;}.attributes-text{padding-left:20px;}</style><template is="dom-if" if="[[computeShowWarning(localConfig, globalConfig)]]"><div class="warning">It seems that your configuration.yaml doesn't properly include customize.yaml<br>Changes made here won't affect your configuration.</div></template><template is="dom-if" if="[[hasLocalAttributes]]"><h4 class="attributes-text">The following attributes are already set in customize.yaml<br></h4><ha-form-customize-attributes attributes="{{localAttributes}}"></ha-form-customize-attributes></template><template is="dom-if" if="[[hasGlobalAttributes]]"><h4 class="attributes-text">The following attributes are customized from outside of customize.yaml<br>Possibly via a domain, a glob or a different include.</h4><ha-form-customize-attributes attributes="{{globalAttributes}}"></ha-form-customize-attributes></template><template is="dom-if" if="[[hasExistingAttributes]]"><h4 class="attributes-text">The following attributes of the entity are set programatically.<br>You can override them if you like.</h4><ha-form-customize-attributes attributes="{{existingAttributes}}"></ha-form-customize-attributes></template><template is="dom-if" if="[[hasNewAttributes]]"><h4 class="attributes-text">The following attributes weren't set. Set them if you like.</h4><ha-form-customize-attributes attributes="{{newAttributes}}"></ha-form-customize-attributes></template><div class="form-group"><paper-dropdown-menu label="Pick an attribute to override" class="flex" dynamic-align=""><paper-listbox slot="dropdown-content" selected="{{selectedNewAttribute}}"><template is="dom-repeat" items="[[newAttributesOptions]]" as="option"><paper-item>[[option]]</paper-item></template></paper-listbox></paper-dropdown-menu></div></template></dom-module><script>class HaFormCustomize extends Polymer.Element{static get is(){return"ha-form-customize"}static get properties(){return{hass:{type:Object},entity:Object,localAttributes:{type:Array,computed:"computeLocalAttributes(localConfig)"},hasLocalAttributes:Boolean,globalAttributes:{type:Array,computed:"computeGlobalAttributes(localConfig, globalConfig)"},hasGlobalAttributes:Boolean,existingAttributes:{type:Array,computed:"computeExistingAttributes(localConfig, globalConfig, entity)"},hasExistingAttributes:Boolean,newAttributes:{type:Array,value:[]},hasNewAttributes:Boolean,newAttributesOptions:Array,selectedNewAttribute:{type:Number,value:-1,observer:"selectedNewAttributeObserver"},localConfig:Object,globalConfig:Object}}static get observers(){return["attributesObserver(localAttributes.*, globalAttributes.*, existingAttributes.*, newAttributes.*)"]}_initOpenObject(t,e,i,s){return Object.assign({attribute:t,value:e,closed:!1,domain:window.hassUtil.computeDomain(this.entity),secondary:i,description:t},s)}loadEntity(t){return this.entity=t,this.hass.callApi("GET","config/customize/config/"+t.entity_id).then(t=>{this.localConfig=t.local,this.globalConfig=t.global,this.newAttributes=[]})}saveEntity(){const t={};this.localAttributes.concat(this.globalAttributes,this.existingAttributes,this.newAttributes).forEach(e=>{if(e.closed||e.secondary||!e.attribute||!e.value)return;const i="json"===e.type?JSON.parse(e.value):e.value;i&&(t[e.attribute]=i)});const e=this.entity.entity_id;return this.hass.callApi("POST","config/customize/config/"+e,t)}_computeSingleAttribute(t,e,i){const s=window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES[t]||{type:window.hassAttributeUtil.UNKNOWN_TYPE};return this._initOpenObject(t,"json"===s.type?JSON.stringify(e):e,i,s)}_computeAttributes(t,e,i){return e.map(e=>this._computeSingleAttribute(e,t[e],i))}computeLocalAttributes(t){if(!t)return[];const e=Object.keys(t);return this._computeAttributes(t,e,!1)}computeGlobalAttributes(t,e){if(!t||!e)return[];const i=Object.keys(t),s=Object.keys(e).filter(t=>!i.includes(t));return this._computeAttributes(e,s,!0)}computeExistingAttributes(t,e,i){if(!t||!e||!i)return[];const s=Object.keys(t),r=Object.keys(e),u=Object.keys(i.attributes).filter(t=>!s.includes(t)&&!r.includes(t));return this._computeAttributes(i.attributes,u,!0)}computeShowWarning(t,e){return!(!t||!e)&&Object.keys(t).some(i=>JSON.stringify(e[i])!==JSON.stringify(t[i]))}filterFromAttributes(t){return e=>!t||t.every(t=>t.attribute!==e||t.closed)}getNewAttributesOptions(t,e,i,s){return Object.keys(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES).filter(t=>{const e=window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES[t];return e&&(!e.domains||!this.entity||e.domains.includes(window.hassUtil.computeDomain(this.entity)))}).filter(this.filterFromAttributes(t)).filter(this.filterFromAttributes(e)).filter(this.filterFromAttributes(i)).filter(this.filterFromAttributes(s)).sort().concat("Other")}selectedNewAttributeObserver(t){if(t<0)return;const e=this.newAttributesOptions[t];if(t===this.newAttributesOptions.length-1){const t=this._initOpenObject("","",!1,{type:window.hassAttributeUtil.ADD_TYPE});return this.push("newAttributes",t),void(this.selectedNewAttribute=-1)}let i=this.localAttributes.findIndex(t=>t.attribute===e);if(i>=0)return this.set("localAttributes."+i+".closed",!1),void(this.selectedNewAttribute=-1);if((i=this.globalAttributes.findIndex(t=>t.attribute===e))>=0)return this.set("globalAttributes."+i+".closed",!1),void(this.selectedNewAttribute=-1);if((i=this.existingAttributes.findIndex(t=>t.attribute===e))>=0)return this.set("existingAttributes."+i+".closed",!1),void(this.selectedNewAttribute=-1);if((i=this.newAttributes.findIndex(t=>t.attribute===e))>=0)return this.set("newAttributes."+i+".closed",!1),void(this.selectedNewAttribute=-1);const s=this._computeSingleAttribute(e,"",!1);this.push("newAttributes",s),this.selectedNewAttribute=-1}attributesObserver(){this.hasLocalAttributes=this.localAttributes&&this.localAttributes.some(t=>!t.closed),this.hasGlobalAttributes=this.globalAttributes&&this.globalAttributes.some(t=>!t.closed),this.hasExistingAttributes=this.existingAttributes&&this.existingAttributes.some(t=>!t.closed),this.hasNewAttributes=this.newAttributes&&this.newAttributes.some(t=>!t.closed),this.newAttributesOptions=this.getNewAttributesOptions(this.localAttributes,this.globalAttributes,this.existingAttributes,this.newAttributes)}}customElements.define(HaFormCustomize.is,HaFormCustomize);</script><dom-module id="ha-entity-config"><template><style include="iron-flex ha-style">paper-card{display:block;}.device-picker{@apply (--layout-horizontal);padding-bottom:24px;}.form-placeholder{@apply (--layout-vertical);@apply (--layout-center-center);height:96px;}[hidden]:{display:none;};.card-actions{@apply (--layout-horizontal);@apply (--layout-justified);}</style><paper-card><div class="card-content"><div class="device-picker"><paper-dropdown-menu label="[[label]]" class="flex" disabled="[[!entities.length]]"><paper-listbox slot="dropdown-content" selected="{{selectedEntity}}"><template is="dom-repeat" items="[[entities]]" as="state"><paper-item>[[computeSelectCaption(state)]]</paper-item></template></paper-listbox></paper-dropdown-menu></div><div class="form-container"><template is="dom-if" if="[[computeShowPlaceholder(formState)]]"><div class="form-placeholder"><template is="dom-if" if="[[computeShowNoDevices(formState)]]">No entities found! :-(</template><template is="dom-if" if="[[computeShowSpinner(formState)]]"><paper-spinner active="" alt="[[formState]]"></paper-spinner>[[formState]]</template></div></template><div hidden$="[[!computeShowForm(formState)]]" id="form"></div></div></div><div class="card-actions"><paper-button on-tap="saveEntity" disabled="[[computeShowPlaceholder(formState)]]">SAVE</paper-button><template is="dom-if" if="[[allowDelete]]"><paper-button class="warning" on-tap="deleteEntity" disabled="[[computeShowPlaceholder(formState)]]">DELETE</paper-button></template></div></paper-card></template></dom-module><script>class HaEntityConfig extends Polymer.Element{static get is(){return"ha-entity-config"}static get properties(){return{hass:{type:Object,observer:"hassChanged"},label:{type:String,value:"Device"},entities:{type:Array,observer:"entitiesChanged"},allowDelete:{type:Boolean,value:!1},selectedEntity:{type:Number,value:-1,observer:"entityChanged"},formState:{type:String,value:"no-devices"},config:{type:Object}}}connectedCallback(){super.connectedCallback(),this.formEl=document.createElement(this.config.component),this.formEl.hass=this.hass,this.$.form.appendChild(this.formEl),this.entityChanged(this.selectedEntity)}computeSelectCaption(t){return this.config.computeSelectCaption?this.config.computeSelectCaption(t):window.hassUtil.computeStateName(t)}computeShowNoDevices(t){return"no-devices"===t}computeShowSpinner(t){return"loading"===t||"saving"===t}computeShowPlaceholder(t){return"editing"!==t}computeShowForm(t){return"editing"===t}hassChanged(t){this.formEl&&(this.formEl.hass=t)}entitiesChanged(t,e){if(0!==t.length)if(e){var i=e[this.selectedEntity].entity_id,n=t.findIndex(function(t){return t.entity_id===i});-1===n?this.selectedEntity=0:n!==this.selectedEntity&&(this.selectedEntity=n)}else this.selectedEntity=0;else this.formState="no-devices"}entityChanged(t){if(this.entities&&this.formEl){var e=this.entities[t];if(e){this.formState="loading";var i=this;this.formEl.loadEntity(e).then(function(){i.formState="editing"})}}}saveEntity(){this.formState="saving";var t=this;this.formEl.saveEntity().then(function(){t.formState="editing"})}}customElements.define(HaEntityConfig.is,HaEntityConfig);</script><dom-module id="ha-config-customize" assetpath="customize/"><template><style include="ha-style"></style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="_backTapped"></paper-icon-button><div main-title="">Customization</div></app-toolbar></app-header><div class$="[[computeClasses(isWide)]]"><ha-config-section is-wide="[[isWide]]"><span slot="header">Customization</span> <span slot="introduction">Tweak per-entity attributes.<br>Added/edited customizations will take effect immediately. Removed customizations will take effect when the entity is updated.</span><ha-entity-config hass="[[hass]]" label="Entity" entities="[[entities]]" config="[[entityConfig]]"></ha-entity-config></ha-config-section></div></app-header-layout></template></dom-module><script>class HaConfigCustomize extends Polymer.Element{static get is(){return"ha-config-customize"}static get properties(){return{hass:Object,isWide:Boolean,entities:{type:Array,computed:"computeEntities(hass)"},entityConfig:{type:Object,value:{component:"ha-form-customize",computeSelectCaption:t=>window.hassUtil.computeStateName(t)+" ("+window.hassUtil.computeDomain(t)+")"}}}}computeClasses(t){return t?"content":"content narrow"}_backTapped(){history.back()}computeEntities(t){return Object.keys(t.states).map(e=>t.states[e]).sort(window.hassUtil.sortByName)}}customElements.define(HaConfigCustomize.is,HaConfigCustomize);</script></div><dom-module id="ha-panel-config"><template><style>iron-pages{height:100%;}</style><app-route route="[[route]]" pattern="/:page" data="{{_routeData}}" tail="{{_routeTail}}"></app-route><iron-media-query query="(min-width: 1040px)" query-matches="{{wide}}"></iron-media-query><iron-media-query query="(min-width: 1296px)" query-matches="{{wideSidebar}}"></iron-media-query><iron-pages selected="[[_routeData.page]]" attr-for-selected="page-name" fallback-selection="not-found" selected-attribute="visible"><ha-config-core page-name="core" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-core><ha-config-cloud page-name="cloud" route="[[_routeTail]]" hass="[[hass]]" is-wide="[[isWide]]" account="[[account]]"></ha-config-cloud><ha-config-dashboard page-name="dashboard" hass="[[hass]]" is-wide="[[isWide]]" account="[[account]]" narrow="[[narrow]]" show-menu="[[showMenu]]"></ha-config-dashboard><ha-config-automation page-name="automation" route="[[_routeTail]]" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-automation><ha-config-script page-name="script" route="[[_routeTail]]" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-script><ha-config-zwave page-name="zwave" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-zwave><ha-config-customize page-name="customize" hass="[[hass]]" is-wide="[[isWide]]"></ha-config-customize><hass-error-screen page-name="not-found" error="Page not found." title="Configuration"></hass-error-screen></iron-pages></template></dom-module><script>class HaPanelConfig extends(window.hassMixins.EventsMixin(Polymer.Element)){static get is(){return"ha-panel-config"}static get properties(){return{hass:Object,narrow:Boolean,showMenu:Boolean,account:{type:Object,value:null},route:{type:Object,observer:"_routeChanged"},_routeData:Object,_routeTail:Object,wide:Boolean,wideSidebar:Boolean,isWide:{type:Boolean,computed:"computeIsWide(showMenu, wideSidebar, wide)"}}}ready(){super.ready(),window.hassUtil.isComponentLoaded(this.hass,"cloud")&&this.hass.callApi("get","cloud/account").then(e=>{this.account=e}),this.addEventListener("ha-account-refreshed",e=>{this.account=e.detail.account})}computeIsWide(e,t,a){return e?t:a}_routeChanged(e){""===e.path&&"/config"===e.prefix&&(history.replaceState(null,null,"/config/dashboard"),this.fire("location-changed"))}}customElements.define(HaPanelConfig.is,HaPanelConfig);</script></body></html>